<!DOCTYPE html>

<html dir="rtl" lang="ur">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="Ø¯ÙØªØ± Ù…Ù†Ø¸Ù… - Ø¢Ù¾ Ú©Ø§ Ù…Ú©Ù…Ù„ Ø¯ÙØªØ±ÛŒ Ù…Ø¹Ø§ÙˆÙ†" name="title" />
    <meta
        content="Ø¯ÙØªØ± Ù…Ù†Ø¸Ù… Ø§ÛŒÚ© Ø¬Ø§Ù…Ø¹ ÙˆÛŒØ¨ Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† ÛÛ’ Ø¬Ùˆ Ø±ÙˆØ²Ù…Ø±Û Ú©Û’ Ø¯ÙØªØ±ÛŒ Ø§Ù…ÙˆØ± Ø¬ÛŒØ³Û’ Ú©Ø§Ù…ØŒ ÛŒØ§Ø¯Ø¯ÛØ§Ù†ÛŒØŒ Ù…Ù„Ø§Ù‚Ø§ØªÛŒÚºØŒ Ù¾ÛŒØºØ§Ù…Ø§ØªØŒ Ø§ÙˆØ± Ø±Ø§Ø¨Ø·ÙˆÚº Ú©Ø§ Ø§Ù†ØªØ¸Ø§Ù… Ú©Ø±ØªÛŒ ÛÛ’Û” Ù¾Ø§Ú©Ø³ØªØ§Ù† Ù…ÛŒÚº Ø¯ÙØªØ±ÛŒ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Û’ Ù„ÛŒÛ’ ÚˆÛŒØ²Ø§Ø¦Ù† Ú©ÛŒØ§ Ú¯ÛŒØ§ ÛÛ’Û”"
        name="description" />
    <meta
        content="Ø¯ÙØªØ± Ù…Ù†Ø¸Ù…, Ø¯ÙØªØ±ÛŒ Ø§Ù†ØªØ¸Ø§Ù…, Ù¹Ø§Ø³Ú© Ù…ÛŒÙ†ÛŒØ¬Ø±, Ø±ÛŒÙ…Ø§Ø¦Ù†ÚˆØ± Ø§ÛŒÙ¾, Ù…Ù„Ø§Ù‚Ø§ØªÛŒÚº, Ø§Ø·Ù„Ø§Ø¹Ø§Øª, Ø±Ø§Ø¨Ø·Û’, Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ, Ø´ÛŒÚˆÙˆÙ„, Ù¾ÛŒØºØ§Ù…Ø§Øª, Ø®Ø·ÙˆØ·, Ù…Ø·Ø§Ù„Ø¨Ø§Øª, Ù¾Ø§Ú©Ø³ØªØ§Ù†, ÛŒØ³ÛŒÙ† Ø§Ù„Ù„Û"
        name="keywords" />
    <meta content="Yasin Ullah, Pakistan" name="author" />
    <title>Ø¯ÙØªØ± Ù…Ù†Ø¸Ù…</title>
    <link
        href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;ğŸ¢&lt;/text&gt;&lt;/svg&gt;"
        rel="icon" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400..700&display=swap');

        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --accent-color: #28a745;
            --delete-color: #dc3545;
            --edit-color: #ffc107;
            --card-bg: #ffffff;
            --border-color: #e9ecef;
            --input-bg: #ffffff;
            --table-even-bg: #f8f9fa;
            --table-header-bg: var(--primary-color);
            --table-header-text: white;
            --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            --notification-success-bg: #28a745;
            --notification-info-bg: #17a2b8;
            --notification-error-bg: #dc3545;
            --notification-text: white;
            --button-hover-darken: 10%;
            --border-radius: 0.375rem;
            --font-size-base: 0.9rem;
            --font-size-lg: 1.1rem;
            --font-size-sm: 0.75rem;
        }

        body.dark-theme {
            --bg-color: #212529;
            --text-color: #f8f9fa;
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --accent-color: #198754;
            --delete-color: #dc3545;
            --edit-color: #ffc107;
            --card-bg: #343a40;
            --border-color: #495057;
            --input-bg: #495057;
            --table-even-bg: #343a40;
            --table-header-bg: var(--primary-color);
            --table-header-text: white;
            --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.2);
            --notification-success-bg: #198754;
            --notification-info-bg: #0dcaf0;
            --notification-error-bg: #dc3545;
        }

        body {
            font-family: Calibri, 'Noto Nastaliq Urdu', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.5;
            direction: rtl;
            text-align: right;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            font-size: var(--font-size-base);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        .container {
            display: flex;
            flex: 1;
            padding: 0.8rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            gap: 0.8rem;
        }

        .sidebar {
            width: 200px;
            background-color: var(--card-bg);
            padding: 0.8rem;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            flex-shrink: 0;
            position: sticky;
            top: 0.8rem;
            height: calc(100vh - 1.6rem);
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar::-webkit-scrollbar {
            width: 5px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar h2 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            line-height: 1.2;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.6rem;
            font-weight: 600;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 0.4rem;
        }

        .sidebar ul li button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 0.5rem 0.7rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            text-align: right;
            font-family: inherit;
            gap: 0.4rem;
        }

        .sidebar ul li button:hover {
            background-color: color-mix(in srgb, var(--primary-color) var(--button-hover-darken), black);
            transform: translateY(-1px);
            box-shadow: 0 0.15rem 0.3rem rgba(0, 0, 0, 0.1);
        }

        .sidebar ul li button.active {
            background-color: var(--accent-color);
            font-weight: bold;
            box-shadow: 0 0.075rem 0.15rem rgba(0, 0, 0, 0.15);
        }

        .main-content {
            flex-grow: 1;
            background-color: var(--card-bg);
            padding: 1.2rem;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            overflow-x: hidden;
        }

        .module-section {
            display: none;
        }

        .module-section.active {
            display: block;
        }

        h1,
        h2,
        h3 {
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.6rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        h2 {
            font-size: 1.5rem;
        }

        h3 {
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 0.8rem;
        }

        label {
            display: block;
            margin-bottom: 0.2rem;
            font-weight: 500;
            font-size: var(--font-size-base);
        }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="email"],
        input[type="tel"],
        textarea,
        select {
            width: calc(100% - 1.2rem);
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--text-color);
            font-family: inherit;
            font-size: var(--font-size-base);
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.15rem rgba(0, 123, 255, 0.25);
            outline: none;
        }

        textarea {
            resize: vertical;
            min-height: 50px;
        }

        button {
            padding: 0.5rem 0.8rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: var(--font-size-base);
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            font-family: inherit;
            margin-left: 0.4rem;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        button i {
            font-size: 0.8em;
        }

        button:hover {
            filter: brightness(90%);
            transform: translateY(-1px);
            box-shadow: 0 0.1rem 0.2rem rgba(0, 0, 0, 0.1);
        }

        button:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .delete-btn {
            background-color: var(--delete-color);
        }

        .edit-btn {
            background-color: var(--edit-color);
            color: var(--text-color);
        }

        .whatsapp-btn {
            background-color: #25D366;
        }

        .whatsapp-btn:hover {
            background-color: #1DA851;
        }

        .sms-btn {
            background-color: #4CAF50;
        }

        .sms-btn:hover {
            background-color: #45a049;
        }

        .action-buttons {
            margin-top: 1.2rem;
            text-align: left;
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            justify-content: flex-end;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.2rem;
            font-size: var(--font-size-base);
            table-layout: auto;
        }

        table th,
        table td {
            border: 1px solid var(--border-color);
            padding: 0.5rem;
            text-align: right;
            vertical-align: top;
        }

        table th {
            background-color: var(--table-header-bg);
            color: var(--table-header-text);
            white-space: nowrap;
            font-weight: 600;
        }

        table tbody tr:nth-child(even) {
            background-color: var(--table-even-bg);
        }

        table tbody tr:hover {
            background-color: color-mix(in srgb, var(--table-even-bg) 10%, var(--border-color));
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .controls input[type="text"],
        .controls input[type="date"],
        .controls select {
            width: auto;
            min-width: 100px;
            flex-grow: 1;
            margin-left: 0;
            padding: 0.4rem;
            font-size: var(--font-size-sm);
        }

        .controls button {
            padding: 0.4rem 0.7rem;
            font-size: var(--font-size-sm);
        }

        .export-options {
            margin-bottom: 0.8rem;
            text-align: left;
            display: flex;
            gap: 0.4rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .export-options button {
            margin-left: 0;
            padding: 0.4rem 0.7rem;
            font-size: var(--font-size-sm);
        }

        .theme-switcher {
            position: fixed;
            top: 0.8rem;
            left: 0.8rem;
            z-index: 1000;
            display: flex;
            gap: 0.4rem;
        }

        .theme-switcher button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.4rem 0.7rem;
            border-radius: var(--border-radius);
            font-size: var(--font-size-sm);
            margin-left: 0;
        }

        .theme-switcher button:hover {
            background-color: color-mix(in srgb, var(--secondary-color) 10%, black);
        }

        .file-upload-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-top: 0.4rem;
            align-items: center;
        }

        .file-upload-preview div {
            border: 1px solid var(--border-color);
            padding: 0.2rem;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 0.2rem;
            background-color: var(--input-bg);
            font-size: var(--font-size-sm);
        }

        .file-upload-preview img {
            max-width: 25px;
            max-height: 25px;
            object-fit: contain;
            border-radius: 3px;
        }

        .file-upload-preview button {
            background-color: var(--delete-color);
            color: white;
            border: none;
            padding: 0.1rem 0.3rem;
            font-size: 0.6em;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 0;
            min-width: unset;
        }

        .hidden {
            display: none;
        }

        .notification {
            position: fixed;
            top: 0.8rem;
            right: 0.8rem;
            background-color: var(--notification-info-bg);
            color: var(--notification-text);
            padding: 0.7rem 0.9rem;
            border-radius: var(--border-radius);
            box-shadow: 0 0.15rem 0.4rem rgba(0, 0, 0, 0.2);
            z-index: 1001;
            display: none;
            font-size: var(--font-size-base);
            font-family: inherit;
            animation: fadeIn 0.5s;
            max-width: 250px;
            text-align: center;
        }

        .notification.show {
            display: block;
        }

        .notification.hide {
            animation: fadeOut 0.5s forwards;
        }

        .notification.success {
            background-color: var(--notification-success-bg);
        }

        .notification.error {
            background-color: var(--notification-error-bg);
        }

        .notification.info {
            background-color: var(--notification-info-bg);
        }

        .notification.urgent {
            background-color: var(--delete-color);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-8px);
            }
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.8rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            text-align: center;
            white-space: nowrap;
        }

        .status-badge.complete,
        .status-badge.Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û {
            background-color: #28a745;
        }

        .status-badge.pending,
        .status-badge.Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§ {
            background-color: #ffc107;
            color: #333;
        }

        .status-badge.urgent {
            background-color: #dc3545;
        }

        .status-badge.info {
            background-color: #17a2b8;
        }

        .status-badge.rejected,
        .status-badge.Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û {
            background-color: #dc3545;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                padding: 0.4rem;
                gap: 0.4rem;
            }

            .sidebar {
                width: 100%;
                margin-left: 0;
                margin-bottom: 0.8rem;
                padding: 0.6rem;
                position: static;
                height: auto;
                border-radius: 0;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }

            .sidebar h2 {
                display: none;
            }

            .sidebar ul {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                gap: 0.3rem;
            }

            .sidebar ul li {
                margin-bottom: 0;
            }

            .sidebar ul li button {
                padding: 0.5rem 0.4rem;
                font-size: 0.8rem;
                text-align: center;
                flex-direction: column;
                gap: 0.15rem;
            }

            .sidebar ul li button i {
                font-size: 0.9rem;
            }

            .main-content {
                padding: 0.8rem;
                border-radius: var(--border-radius);
            }

            h1,
            h2,
            h3 {
                font-size: 1.2rem;
                margin-bottom: 0.8rem;
            }

            input[type="text"],
            input[type="date"],
            input[type="time"],
            input[type="email"],
            input[type="tel"],
            textarea,
            select {
                width: 100%;
                padding: 0.5rem;
                font-size: 0.85rem;
            }

            .action-buttons,
            .controls,
            .export-options {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }

            .action-buttons button,
            .controls button,
            .export-options button {
                width: 100%;
                margin-left: 0;
                padding: 0.6rem 0.8rem;
                font-size: var(--font-size-base);
            }

            .controls input,
            .controls select {
                min-width: unset;
                width: 100%;
            }

            table,
            table tbody,
            table tr,
            table td,
            table th {
                display: block;
                width: 100%;
            }

            table thead {
                display: none;
            }

            table tr {
                margin-bottom: 0.6rem;
                border: 1px solid var(--border-color);
                border-radius: var(--border-radius);
                overflow: hidden;
            }

            table td {
                border: none;
                border-bottom: 1px solid var(--border-color);
                position: relative;
                padding-left: 40%;
                text-align: right;
                word-break: break-word;
                font-size: 0.85rem;
                display: ruby-text;
            }

            table td:last-child {
                border-bottom: 0;
            }

            table td::before {
                content: attr(data-label);
                position: absolute;
                right: 0.5rem;
                width: 35%;
                padding-left: 0.4rem;
                font-weight: 600;
                text-align: right;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                color: var(--primary-color);
            }

            #tasksTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #tasksTable td:nth-of-type(2)::before {
                content: "Ú©Ø§Ù… Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:";
            }

            #tasksTable td:nth-of-type(3)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #tasksTable td:nth-of-type(4)::before {
                content: "Ø§ÛÙ…ÛŒØª:";
            }

            #tasksTable td:nth-of-type(5)::before {
                content: "Ø­Ø§Ù„Øª:";
            }

            #tasksTable td:nth-of-type(6)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #tasksTable td:nth-of-type(7)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #remindersTable td:nth-of-type(1)::before {
                content: "Ø¹Ù†ÙˆØ§Ù†:";
            }

            #remindersTable td:nth-of-type(2)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #remindersTable td:nth-of-type(3)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #remindersTable td:nth-of-type(4)::before {
                content: "ÙˆÙ‚Øª:";
            }

            #remindersTable td:nth-of-type(5)::before {
                content: "Ù†ÙˆØ¹ÛŒØª:";
            }

            #remindersTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #urgentTasksTable td:nth-of-type(1)::before {
                content: "Ø¹Ù†ÙˆØ§Ù†:";
            }

            #urgentTasksTable td:nth-of-type(2)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #urgentTasksTable td:nth-of-type(3)::before {
                content: "Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®:";
            }

            #urgentTasksTable td:nth-of-type(4)::before {
                content: "Ø¢Ø®Ø±ÛŒ ÙˆÙ‚Øª:";
            }

            #urgentTasksTable td:nth-of-type(5)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #meetingsTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #meetingsTable td:nth-of-type(2)::before {
                content: "ÙˆÙ‚Øª:";
            }

            #meetingsTable td:nth-of-type(3)::before {
                content: "Ø´Ø®ØµÛŒØ§Øª:";
            }

            #meetingsTable td:nth-of-type(4)::before {
                content: "Ø¬Ú¯Û:";
            }

            #meetingsTable td:nth-of-type(5)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #meetingsTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #notificationsTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #notificationsTable td:nth-of-type(2)::before {
                content: "Ø¹Ù†ÙˆØ§Ù†:";
            }

            #notificationsTable td:nth-of-type(3)::before {
                content: "Ù†ÙˆØ¹ÛŒØª:";
            }

            #notificationsTable td:nth-of-type(4)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #notificationsTable td:nth-of-type(5)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #notificationsTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #contactsTable td:nth-of-type(1)::before {
                content: "Ù†Ø§Ù…/ØªÙ†Ø¸ÛŒÙ…:";
            }

            #contactsTable td:nth-of-type(2)::before {
                content: "ÙÙˆÙ†:";
            }

            #contactsTable td:nth-of-type(3)::before {
                content: "Ø§ÛŒ Ù…ÛŒÙ„:";
            }

            #contactsTable td:nth-of-type(4)::before {
                content: "Ø±Ø´ØªÛ/Ù…Ø¹Ù…ÙˆÙ„:";
            }

            #contactsTable td:nth-of-type(5)::before {
                content: "Ù¾ØªÛ:";
            }

            #contactsTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #performanceTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #performanceTable td:nth-of-type(2)::before {
                content: "Ø¹Ù†ÙˆØ§Ù†:";
            }

            #performanceTable td:nth-of-type(3)::before {
                content: "Ù…Ø¯Øª:";
            }

            #performanceTable td:nth-of-type(4)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #performanceTable td:nth-of-type(5)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #performanceTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #schedulesTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #schedulesTable td:nth-of-type(2)::before {
                content: "ÙˆÙ‚Øª:";
            }

            #schedulesTable td:nth-of-type(3)::before {
                content: "Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ú©Ø§ Ù†Ø§Ù…:";
            }

            #schedulesTable td:nth-of-type(4)::before {
                content: "Ù†ÙˆØ¹ÛŒØª:";
            }

            #schedulesTable td:nth-of-type(5)::before {
                content: "Ø¬Ú¯Û:";
            }

            #schedulesTable td:nth-of-type(6)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #schedulesTable td:nth-of-type(7)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #messagesTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #messagesTable td:nth-of-type(2)::before {
                content: "Ù†ÙˆØ¹ÛŒØª:";
            }

            #messagesTable td:nth-of-type(3)::before {
                content: "Ø¨Ú¾ÛŒØ¬Ù†Û’ ÙˆØ§Ù„Ø§/ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û:";
            }

            #messagesTable td:nth-of-type(4)::before {
                content: "Ù…Ø¶Ù…ÙˆÙ†:";
            }

            #messagesTable td:nth-of-type(5)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #messagesTable td:nth-of-type(6)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #messagesTable td:nth-of-type(7)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #lettersTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§:";
            }

            #lettersTable td:nth-of-type(2)::before {
                content: "ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û:";
            }

            #lettersTable td:nth-of-type(3)::before {
                content: "Ù…Ø¶Ù…ÙˆÙ†:";
            }

            #lettersTable td:nth-of-type(4)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #lettersTable td:nth-of-type(5)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #lettersTable td:nth-of-type(6)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            #demandsTable td:nth-of-type(1)::before {
                content: "ØªØ§Ø±ÛŒØ®:";
            }

            #demandsTable td:nth-of-type(2)::before {
                content: "Ø¹Ù†ÙˆØ§Ù†:";
            }

            #demandsTable td:nth-of-type(3)::before {
                content: "Ù…Ø·Ø§Ù„Ø¨Û Ú©Ø±Ù†Û’ ÙˆØ§Ù„Ø§:";
            }

            #demandsTable td:nth-of-type(4)::before {
                content: "ØªÙØµÛŒÙ„:";
            }

            #demandsTable td:nth-of-type(5)::before {
                content: "Ø­Ø§Ù„Øª:";
            }

            #demandsTable td:nth-of-type(6)::before {
                content: "ÙØ§Ø¦Ù„ÛŒÚº:";
            }

            #demandsTable td:nth-of-type(7)::before {
                content: "Ø¢Ù¾Ø´Ù†Ø²:";
            }

            .theme-switcher {
                position: static;
                text-align: left;
                margin-bottom: 0.5rem;
                padding: 0 0.4rem;
                justify-content: flex-start;
                flex-wrap: wrap;
            }
        }

        @media print {
            body {
                background-color: white;
                font-family: Calibri, 'Noto Nastaliq Urdu', Arial, sans-serif;
                color: black;
                font-size: 9pt;
                line-height: 1.3;
            }

            .container {
                display: block;
                padding: 0;
                max-width: 100%;
                margin: 0;
            }

            .sidebar,
            .controls,
            .action-buttons,
            .theme-switcher,
            .export-options button:not(.print-btn),
            input[type="file"],
            .notification {
                display: none !important;
            }

            .main-content {
                box-shadow: none;
                padding: 0;
                margin: 0;
                width: 100%;
            }

            table {
                border: 1px solid black;
                page-break-inside: auto;
            }

            table tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }

            table th,
            table td {
                border: 1px solid black;
                padding: 5px;
                font-size: 8pt;
                color: black;
            }

            table th {
                background-color: #e0e0e0 !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }

            h1,
            h2,
            h3 {
                color: black;
                border-bottom: 1px solid #ccc;
                text-align: center;
                font-size: 14pt;
                margin-bottom: 8px;
            }

            input,
            textarea,
            select {
                border: none !important;
                padding: 0 !important;
                background-color: transparent !important;
                box-shadow: none !important;
                width: auto !important;
                display: inline-block;
                min-width: 70px;
                color: black !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }

            .form-group label {
                display: inline-block;
                margin-left: 6px;
                font-weight: bold;
            }

            .form-group {
                margin-bottom: 2px;
            }

            .file-upload-preview {
                display: none !important;
            }

            td a {
                text-decoration: none;
                color: black;
            }
        }
    </style>
    <link href="manifest.json" rel="manifest" />
</head>

<body>
    <div class="theme-switcher">
        <button id="themeToggle"><i class="fas fa-adjust"></i> ØªÚ¾ÛŒÙ… Ø¨Ø¯Ù„ÛŒÚº</button>
        <button id="requestNotificationPermission"><i class="fas fa-bell"></i> Ù†ÙˆÙ¹ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©ÛŒ Ø§Ø¬Ø§Ø²Øª Ø¯ÛŒÚº</button>
    </div>
    <div class="notification" id="notification"></div>
    <div class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><button data-module="tasks"><i class="fas fa-tasks"></i> Ú©Ø§Ù…</button></li>
                    <li><button data-module="reminders"><i class="fas fa-bell"></i> Ù…Ø®ØªÙ„Ù Ø§Ù…ÙˆØ± Ú©ÛŒ ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒØ§Úº</button>
                    </li>
                    <li><button data-module="urgentTasks"><i class="fas fa-exclamation-triangle"></i> ÙÙˆØ±ÛŒ Ú©Ø±Ù†Û’ Ú©Û’
                            Ú©Ø§Ù…</button></li>
                    <li><button data-module="meetings"><i class="fas fa-handshake"></i> Ù…Ù„Ø§Ù‚Ø§ØªÛŒÚº</button></li>
                    <li><button data-module="notifications"><i class="fas fa-info-circle"></i> Ø§Ø·Ù„Ø§Ø¹Ø§Øª</button></li>
                    <li><button data-module="contacts"><i class="fas fa-address-book"></i> Ø±Ø§Ø¨Ø·Û’</button></li>
                    <li><button data-module="performance"><i class="fas fa-chart-line"></i> Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒØ§Úº</button></li>
                    <li><button data-module="schedules"><i class="fas fa-calendar-alt"></i> Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù…ÙˆÚº Ú©Ø§ Ø´ÛŒÚˆÙˆÙ„</button>
                    </li>
                    <li><button data-module="messages"><i class="fas fa-envelope"></i> Ù¾ÛŒØºØ§Ù…Ø§Øª</button></li>
                    <li><button data-module="letters"><i class="fas fa-file-alt"></i> Ø®Ø·ÙˆØ·</button></li>
                    <li><button data-module="demands"><i class="fas fa-money-bill-wave"></i> Ù…Ø·Ø§Ù„Ø¨Ø§Øª</button></li>
                    <li><button data-module="backupRestore"><i class="fas fa-cloud-download-alt"></i> Ø¨ÛŒÚ© Ø§Ù¾ / Ø±ÛŒ
                            Ø³Ù¹ÙˆØ±</button></li>
                </ul>
            </nav>
        </aside>
        <main class="main-content">
            <section class="module-section active" id="tasks">
                <h2><i class="fas fa-tasks"></i> Ú©Ø§Ù… â€“ Ø±ÙˆØ²Ù…Ø±Û ÛŒØ§ Ø®Ø§Øµ Ù†ÙˆØ¹ÛŒØª Ú©Û’ Ú©Ø§Ù…</h2>
                <form id="taskForm">
                    <input id="taskId" type="hidden" />
                    <div class="form-group">
                        <label for="taskName">Ú©Ø§Ù… Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="taskName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">ØªÙØµÛŒÙ„:</label>
                        <textarea id="taskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="taskDueDate">Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®:</label>
                        <input id="taskDueDate" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">Ø§ÛÙ…ÛŒØª:</label>
                        <select id="taskPriority">
                            <option value="Ù…Ø¹Ù…ÙˆÙ„ÛŒ">Ù…Ø¹Ù…ÙˆÙ„ÛŒ</option>
                            <option value="Ø§ÙˆØ³Ø·">Ø§ÙˆØ³Ø·</option>
                            <option value="Ø§ÛÙ…">Ø§ÛÙ…</option>
                            <option value="Ø§Ù†ØªÛØ§Ø¦ÛŒ Ø§ÛÙ…">Ø§Ù†ØªÛØ§Ø¦ÛŒ Ø§ÛÙ…</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskStatus">Ø­Ø§Ù„Øª:</label>
                        <select id="taskStatus">
                            <option value="Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§">Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§</option>
                            <option value="Ù…Ú©Ù…Ù„">Ù…Ú©Ù…Ù„</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="taskFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="taskFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearTaskForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-list"></i> Ú©Ø§Ù…ÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="taskSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="taskFilterDate" type="date" />
                    <select id="taskSortBy">
                        <option value="dueDate">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dueDateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="priority">Ø§ÛÙ…ÛŒØª</option>
                        <option value="status">Ø­Ø§Ù„Øª</option>
                    </select>
                    <button onclick="filterAndSort('tasks')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('tasksTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('tasksTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('tasksTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="tasksTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ú©Ø§Ù… Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>Ø§ÛÙ…ÛŒØª</th>
                                <th>Ø­Ø§Ù„Øª</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="reminders">
                <h2><i class="fas fa-bell"></i> Ù…Ø®ØªÙ„Ù Ø§Ù…ÙˆØ± Ú©ÛŒ ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒØ§Úº â€“ Ù†ÙˆÙ¹Ø³ØŒ Ø§Ù„Ø§Ø±Ù…ØŒ ÛŒØ§ ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± ÛŒØ§Ø¯Ø¯ÛØ§Ù†ÛŒ</h2>
                <form id="reminderForm">
                    <input id="reminderId" type="hidden" />
                    <div class="form-group">
                        <label for="reminderTitle">ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒ Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="reminderTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="reminderDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="reminderDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reminderDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="reminderDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="reminderTime">ÙˆÙ‚Øª:</label>
                        <input id="reminderTime" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="reminderType">Ù†ÙˆØ¹ÛŒØª:</label>
                        <select id="reminderType">
                            <option value="Ù†ÙˆÙ¹Ø³">Ù†ÙˆÙ¹Ø³</option>
                            <option value="Ø§Ù„Ø§Ø±Ù…">Ø§Ù„Ø§Ø±Ù…</option>
                            <option value="ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±</option>
                        </select>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearReminderForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-alt"></i> ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="reminderSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="reminderFilterDate" type="date" />
                    <select id="reminderSortBy">
                        <option value="dateTime">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateTimeDesc">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="type">Ù†ÙˆØ¹ÛŒØª</option>
                    </select>
                    <button onclick="filterAndSort('reminders')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('remindersTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('remindersTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('remindersTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="remindersTable">
                        <thead>
                            <tr>
                                <th>Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>ÙˆÙ‚Øª</th>
                                <th>Ù†ÙˆØ¹ÛŒØª</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="urgentTasks">
                <h2><i class="fas fa-exclamation-triangle"></i> ÙÙˆØ±ÛŒ Ú©Ø±Ù†Û’ Ú©Û’ Ú©Ø§Ù… â€“ Ø§ÛÙ…ØŒ ÙÙˆØ±ÛŒ Ù†ÙˆØ¹ÛŒØª Ú©Û’ Ø§Ù…ÙˆØ±</h2>
                <form id="urgentTaskForm">
                    <input id="urgentTaskId" type="hidden" />
                    <div class="form-group">
                        <label for="urgentTaskName">ÙÙˆØ±ÛŒ Ú©Ø§Ù… Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="urgentTaskName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDescription">ØªÙØµÛŒÙ„:</label>
                        <textarea id="urgentTaskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDueDate">Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®:</label>
                        <input id="urgentTaskDueDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDueTime">Ø¢Ø®Ø±ÛŒ ÙˆÙ‚Øª:</label>
                        <input id="urgentTaskDueTime" type="time" />
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearUrgentTaskForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-clipboard-list"></i> ÙÙˆØ±ÛŒ Ú©Ø§Ù…ÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="urgentTaskSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="urgentTaskFilterDate" type="date" />
                    <select id="urgentTaskSortBy">
                        <option value="dueDate">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dueDateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                    </select>
                    <button onclick="filterAndSort('urgentTasks')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨
                        Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('urgentTasksTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('urgentTasksTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('urgentTasksTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ±
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="urgentTasksTable">
                        <thead>
                            <tr>
                                <th>Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®</th>
                                <th>Ø¢Ø®Ø±ÛŒ ÙˆÙ‚Øª</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="meetings">
                <h2><i class="fas fa-handshake"></i> Ù…Ù„Ø§Ù‚Ø§ØªÛŒÚº â€“ Ø´Ø®ØµÛŒØ§ØªØŒ ÙˆÙ‚ØªØŒ Ø¬Ú¯ÛØŒ ØªÙØµÛŒÙ„</h2>
                <form id="meetingForm">
                    <input id="meetingId" type="hidden" />
                    <div class="form-group">
                        <label for="meetingPerson">Ø´Ø®ØµÛŒØ§Øª:</label>
                        <input id="meetingPerson" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="meetingDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="meetingDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="meetingTime">ÙˆÙ‚Øª:</label>
                        <input id="meetingTime" required="" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="meetingLocation">Ø¬Ú¯Û:</label>
                        <input id="meetingLocation" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="meetingDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="meetingDetails" rows="3"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearMeetingForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-calendar-check"></i> Ù…Ù„Ø§Ù‚Ø§ØªÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="meetingSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="meetingFilterDate" type="date" />
                    <select id="meetingSortBy">
                        <option value="dateTime">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateTimeDesc">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                    </select>
                    <button onclick="filterAndSort('meetings')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('meetingsTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('meetingsTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('meetingsTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="meetingsTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>ÙˆÙ‚Øª</th>
                                <th>Ø´Ø®ØµÛŒØ§Øª</th>
                                <th>Ø¬Ú¯Û</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="notifications">
                <h2><i class="fas fa-info-circle"></i> Ø§Ø·Ù„Ø§Ø¹Ø§Øª â€“ Ø¯Ø§Ø®Ù„ÛŒ Ùˆ Ø®Ø§Ø±Ø¬ÛŒ Ø§Ø·Ù„Ø§Ø¹ Ù†Ø§Ù…Û’</h2>
                <form id="notificationForm">
                    <input id="notificationId" type="hidden" />
                    <div class="form-group">
                        <label for="notificationTitle">Ø§Ø·Ù„Ø§Ø¹ Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="notificationTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="notificationType">Ù†ÙˆØ¹ÛŒØª:</label>
                        <select id="notificationType">
                            <option value="Ø¯Ø§Ø®Ù„ÛŒ">Ø¯Ø§Ø®Ù„ÛŒ</option>
                            <option value="Ø®Ø§Ø±Ø¬ÛŒ">Ø®Ø§Ø±Ø¬ÛŒ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notificationDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="notificationDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="notificationDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="notificationDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="notificationFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="notificationFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="notificationFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearNotificationForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-bullhorn"></i> Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="notificationSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="notificationFilterDate" type="date" />
                    <select id="notificationSortBy">
                        <option value="date">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="type">Ù†ÙˆØ¹ÛŒØª</option>
                    </select>
                    <button onclick="filterAndSort('notifications')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨
                        Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('notificationsTable')"><i class="fas fa-print"></i>
                        Ù¾Ø±Ù†Ù¹ Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('notificationsTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('notificationsTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ±
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="notificationsTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>Ù†ÙˆØ¹ÛŒØª</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="contacts">
                <h2><i class="fas fa-address-book"></i> Ø±Ø§Ø¨Ø·Û’ â€“ Ø§ÙØ±Ø§Ø¯ØŒ ØªÙ†Ø¸ÛŒÙ…ÛŒÚºØŒ ÙÙˆÙ†ØŒ Ø§ÛŒ Ù…ÛŒÙ„ØŒ Ø±Ø´ØªÛ</h2>
                <form id="contactForm">
                    <input id="contactId" type="hidden" />
                    <div class="form-group">
                        <label for="contactName">Ù†Ø§Ù…/ØªÙ†Ø¸ÛŒÙ…:</label>
                        <input id="contactName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="contactPhone">ÙÙˆÙ†:</label>
                        <input id="contactPhone" type="tel" />
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">Ø§ÛŒ Ù…ÛŒÙ„:</label>
                        <input id="contactEmail" type="email" />
                    </div>
                    <div class="form-group">
                        <label for="contactRelationship">Ø±Ø´ØªÛ/Ù…Ø¹Ù…ÙˆÙ„:</label>
                        <input id="contactRelationship" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="contactAddress">Ù¾ØªÛ:</label>
                        <textarea id="contactAddress" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="contactMessage">Ù¾ÛŒØºØ§Ù…:</label>
                        <textarea id="contactMessage" rows="2"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearContactForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-users"></i> Ø±Ø§Ø¨Ø·ÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="contactSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <select id="contactSortBy">
                        <option value="name">Ù†Ø§Ù… (Ø§Ù„Ù ØªØ§ ÛŒ)</option>
                        <option value="nameDesc">Ù†Ø§Ù… (ÛŒ ØªØ§ Ø§Ù„Ù)</option>
                    </select>
                    <button onclick="filterAndSort('contacts')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('contactsTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('contactsTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('contactsTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="contactsTable">
                        <thead>
                            <tr>
                                <th>Ù†Ø§Ù…/ØªÙ†Ø¸ÛŒÙ…</th>
                                <th>ÙÙˆÙ†</th>
                                <th>Ø§ÛŒ Ù…ÛŒÙ„</th>
                                <th>Ø±Ø´ØªÛ/Ù…Ø¹Ù…ÙˆÙ„</th>
                                <th>Ù¾ÛŒØºØ§Ù…</th>
                                <th>Ù¾ØªÛ</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="performance">
                <h2><i class="fas fa-chart-line"></i> Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒØ§Úº â€“ Ù…Ø§ÛØ§Ù†ÛØŒ Ø³Û Ù…Ø§ÛÛŒØŒ Ø³Ø§Ù„Ø§Ù†Û Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ</h2>
                <form id="performanceForm">
                    <input id="performanceId" type="hidden" />
                    <div class="form-group">
                        <label for="performanceTitle">Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="performanceTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="performancePeriod">Ù…Ø¯Øª:</label>
                        <select id="performancePeriod">
                            <option value="Ù…Ø§ÛØ§Ù†Û">Ù…Ø§ÛØ§Ù†Û</option>
                            <option value="Ø³Û Ù…Ø§ÛÛŒ">Ø³Û Ù…Ø§ÛÛŒ</option>
                            <option value="Ø³Ø§Ù„Ø§Ù†Û">Ø³Ø§Ù„Ø§Ù†Û</option>
                            <option value="Ø¯ÛŒÚ¯Ø±">Ø¯ÛŒÚ¯Ø±</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="performanceDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="performanceDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="performanceDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="performanceDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="performanceFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="performanceFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="performanceFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearPerformanceForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-file-invoice"></i> Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒÙˆÚº Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="performanceSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="performanceFilterDate" type="date" />
                    <select id="performanceSortBy">
                        <option value="date">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="period">Ù…Ø¯Øª</option>
                    </select>
                    <button onclick="filterAndSort('performance')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨
                        Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('performanceTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('performanceTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('performanceTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ±
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="performanceTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>Ù…Ø¯Øª</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="schedules">
                <h2><i class="fas fa-calendar-alt"></i> Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù…ÙˆÚº Ú©Ø§ Ø´ÛŒÚˆÙˆÙ„ â€“ Ø§Ø¬ØªÙ…Ø§Ø¹Ø§ØªØŒ Ù…Ø¬Ù„Ø³ØŒ Ø®ØªÙ… Ø¨Ø®Ø§Ø±ÛŒØŒ Ø¯ÛŒÚ¯Ø±</h2>
                <form id="scheduleForm">
                    <input id="scheduleId" type="hidden" />
                    <div class="form-group">
                        <label for="scheduleName">Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ú©Ø§ Ù†Ø§Ù…:</label>
                        <input id="scheduleName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleType">Ù†ÙˆØ¹ÛŒØª:</label>
                        <input id="scheduleType" placeholder="Ø§Ø¬ØªÙ…Ø§Ø¹Ø§ØªØŒ Ù…Ø¬Ù„Ø³ØŒ Ø®ØªÙ… Ø¨Ø®Ø§Ø±ÛŒØŒ Ø¯ÛŒÚ¯Ø±" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="scheduleDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleTime">ÙˆÙ‚Øª:</label>
                        <input id="scheduleTime" required="" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleLocation">Ø¬Ú¯Û:</label>
                        <input id="scheduleLocation" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="scheduleDetails" rows="3"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearScheduleForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-ul"></i> Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù…ÙˆÚº Ú©Û’ Ø´ÛŒÚˆÙˆÙ„ Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="scheduleSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="scheduleFilterDate" type="date" />
                    <select id="scheduleSortBy">
                        <option value="dateTime">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateTimeDesc">ØªØ§Ø±ÛŒØ® Ùˆ ÙˆÙ‚Øª (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="type">Ù†ÙˆØ¹ÛŒØª</option>
                    </select>
                    <button onclick="filterAndSort('schedules')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('schedulesTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('schedulesTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('schedulesTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="schedulesTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>ÙˆÙ‚Øª</th>
                                <th>Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ú©Ø§ Ù†Ø§Ù…</th>
                                <th>Ù†ÙˆØ¹ÛŒØª</th>
                                <th>Ø¬Ú¯Û</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="messages">
                <h2><i class="fas fa-envelope"></i> Ù¾ÛŒØºØ§Ù…Ø§Øª â€“ Ø¯ÙØªØ± Ú©Ùˆ Ù…ÙˆØµÙˆÙ„ ÛŒØ§ Ø¯ÙØªØ± Ú©ÛŒ Ø¬Ø§Ù†Ø¨ Ø³Û’ Ø§Ø±Ø³Ø§Ù„</h2>
                <form id="messageForm">
                    <input id="messageId" type="hidden" />
                    <div class="form-group">
                        <label for="messageType">Ù†ÙˆØ¹ÛŒØª:</label>
                        <select id="messageType">
                            <option value="Ù…ÙˆØµÙˆÙ„ Ø´Ø¯Û">Ù…ÙˆØµÙˆÙ„ Ø´Ø¯Û</option>
                            <option value="Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Û">Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Û</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="messageSenderReceiver">Ø¨Ú¾ÛŒØ¬Ù†Û’ ÙˆØ§Ù„Ø§/ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û:</label>
                        <input id="messageSenderReceiver" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="messageSubject">Ù…Ø¶Ù…ÙˆÙ†:</label>
                        <input id="messageSubject" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="messageDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="messageDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="messageDate">ØªØ§Ø±ÛŒØ®:</label>
                        <input id="messageDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="messageFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="messageFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="messageFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearMessageForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-inbox"></i> Ù¾ÛŒØºØ§Ù…Ø§Øª Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="messageSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="messageFilterDate" type="date" />
                    <select id="messageSortBy">
                        <option value="date">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="type">Ù†ÙˆØ¹ÛŒØª</option>
                    </select>
                    <button onclick="filterAndSort('messages')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('messagesTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('messagesTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('messagesTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="messagesTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ù†ÙˆØ¹ÛŒØª</th>
                                <th>Ø¨Ú¾ÛŒØ¬Ù†Û’ ÙˆØ§Ù„Ø§/ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û</th>
                                <th>Ù…Ø¶Ù…ÙˆÙ†</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="letters">
                <h2><i class="fas fa-file-alt"></i> Ø®Ø·ÙˆØ· â€“ Ù…Ø®ØªÙ„Ù Ø§ÙØ±Ø§Ø¯/Ø´Ø¹Ø¨Û Ø¬Ø§Øª Ú©Ùˆ Ø¬Ø§Ø±ÛŒ Ú©Ø±Ø¯Û Ø®Ø·ÙˆØ·</h2>
                <form id="letterForm">
                    <input id="letterId" type="hidden" />
                    <div class="form-group">
                        <label for="letterRecipient">ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û (ÙØ±Ø¯/Ø´Ø¹Ø¨Û):</label>
                        <input id="letterRecipient" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="letterSubject">Ù…Ø¶Ù…ÙˆÙ†:</label>
                        <input id="letterSubject" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="letterDate">ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§:</label>
                        <input id="letterDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="letterDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="letterDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="letterFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="letterFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="letterFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearLetterForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-folder-open"></i> Ø®Ø·ÙˆØ· Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="letterSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="letterFilterDate" type="date" />
                    <select id="letterSortBy">
                        <option value="date">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                    </select>
                    <button onclick="filterAndSort('letters')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('lettersTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('lettersTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('lettersTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="lettersTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§</th>
                                <th>ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û</th>
                                <th>Ù…Ø¶Ù…ÙˆÙ†</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="demands">
                <h2><i class="fas fa-money-bill-wave"></i> Ù…Ø·Ø§Ù„Ø¨Ø§Øª â€“ ÙˆØ³Ø§Ø¦Ù„ ÛŒØ§ Ø¯ÛŒÚ¯Ø± Ø§Ù…ÙˆØ± Ú©Û’ Ù…Ø·Ø§Ù„Ø¨Ø§Øª</h2>
                <form id="demandForm">
                    <input id="demandId" type="hidden" />
                    <div class="form-group">
                        <label for="demandSubject">Ù…Ø·Ø§Ù„Ø¨Û’ Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input id="demandSubject" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="demandRequester">Ù…Ø·Ø§Ù„Ø¨Û Ú©Ø±Ù†Û’ ÙˆØ§Ù„Ø§:</label>
                        <input id="demandRequester" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="demandDate">ØªØ§Ø±ÛŒØ® Ù…Ø·Ø§Ù„Ø¨Û:</label>
                        <input id="demandDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="demandDetails">ØªÙØµÛŒÙ„:</label>
                        <textarea id="demandDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="demandStatus">Ø­Ø§Ù„Øª:</label>
                        <select id="demandStatus">
                            <option value="Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§">Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§</option>
                            <option value="Ù…Ú©Ù…Ù„">Ù…Ú©Ù…Ù„</option>
                            <option value="Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û">Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û</option>
                            <option value="Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û">Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="demandFiles">ÙØ§Ø¦Ù„ÛŒÚº (Ù¾ÛŒ ÚˆÛŒ Ø§ÛŒÙØŒ ØªØµØ§ÙˆÛŒØ±):</label>
                        <input accept=".pdf,image/*" id="demandFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="demandFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                        <button id="clearDemandForm" type="button"><i class="fas fa-eraser"></i> ØµØ§Ù Ú©Ø±ÛŒÚº</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-alt"></i> Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="controls">
                    <input id="demandSearch" placeholder="ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº..." type="text" />
                    <input id="demandFilterDate" type="date" />
                    <select id="demandSortBy">
                        <option value="date">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ù‚Ø¯ÛŒÙ… ØªØ±ÛŒÙ†)</option>
                        <option value="dateDesc">ØªØ§Ø±ÛŒØ® ÙˆØ§Ø± (Ø¬Ø¯ÛŒØ¯ ØªØ±ÛŒÙ†)</option>
                        <option value="status">Ø­Ø§Ù„Øª</option>
                    </select>
                    <button onclick="filterAndSort('demands')"><i class="fas fa-filter"></i> ÙÙ„Ù¹Ø± / ØªØ±ØªÛŒØ¨ Ø¯ÛŒÚº</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('demandsTable')"><i class="fas fa-print"></i> Ù¾Ø±Ù†Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('demandsTable', 'excel')"><i class="fas fa-file-excel"></i> Ø§ÛŒÚ©Ø³Ù„
                        Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                    <button onclick="exportTable('demandsTable', 'image')"><i class="fas fa-image"></i> ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
                        Ú©Ø±ÛŒÚº</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="demandsTable">
                        <thead>
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>Ù…Ø·Ø§Ù„Ø¨Û Ú©Ø±Ù†Û’ ÙˆØ§Ù„Ø§</th>
                                <th>ØªÙØµÛŒÙ„</th>
                                <th>Ø­Ø§Ù„Øª</th>
                                <th>ÙØ§Ø¦Ù„ÛŒÚº</th>
                                <th>Ø¢Ù¾Ø´Ù†Ø²</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="backupRestore">
                <h2><i class="fas fa-cloud-download-alt"></i> ÚˆÛŒÙ¹Ø§ Ø¨ÛŒÚ© Ø§Ù¾ Ùˆ Ø±ÛŒ Ø³Ù¹ÙˆØ± (JSON)</h2>
                <h3><i class="fas fa-download"></i> ÚˆÛŒÙ¹Ø§ Ø¨ÛŒÚ© Ø§Ù¾</h3>
                <p>Ø§Ù¾Ù†ÛŒ ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ú©Ùˆ JSON ÙØ§Ø¦Ù„ Ù…ÛŒÚº ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚºÛ”</p>
                <div class="action-buttons">
                    <button onclick="backupData()"><i class="fas fa-download"></i> Ø¨ÛŒÚ© Ø§Ù¾ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>
                </div>
                <h3><i class="fas fa-upload"></i> ÚˆÛŒÙ¹Ø§ Ø±ÛŒ Ø³Ù¹ÙˆØ±</h3>
                <p>JSON ÙØ§Ø¦Ù„ Ø³Û’ ÚˆÛŒÙ¹Ø§ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø± Ú©Û’ Ø§Ù¾Ù†Û’ ÚˆÛŒÙ¹Ø§ Ú©Ùˆ Ø¨Ø­Ø§Ù„ Ú©Ø±ÛŒÚºÛ”</p>
                <div class="form-group">
                    <label for="restoreFile">JSON ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº:</label>
                    <input accept=".json" id="restoreFile" type="file" />
                </div>
                <div class="action-buttons">
                    <button onclick="restoreData()"><i class="fas fa-upload"></i> ÚˆÛŒÙ¹Ø§ Ø¨Ø­Ø§Ù„ Ú©Ø±ÛŒÚº</button>
                </div>
                <p style="color: var(--delete-color); font-size: var(--font-size-sm);"><strong>ÙˆØ§Ø±Ù†Ù†Ú¯:</strong> ÚˆÛŒÙ¹Ø§
                    Ø¨Ø­Ø§Ù„ Ú©Ø±Ù†Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯Û ÚˆÛŒÙ¹Ø§ ØªØ¨Ø¯ÛŒÙ„ ÛÙˆ Ø³Ú©ØªØ§ ÛÛ’Û”</p>
            </section>
        </main>
    </div>
    <script>
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type}`;
            setTimeout(() => {
                notification.classList.remove('show');
                notification.classList.add('hide');
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.classList.remove('hide');
                }, 500);
            }, 3000);
        }
        document.getElementById('themeToggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        });
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
        }
        const DB_NAME = 'OfficeManagerDB';
        const DB_VERSION = 1;
        let db;
        const openDB = () => {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                request.onupgradeneeded = (event) => {
                    db = event.target.result;
                    const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
                    storeNames.forEach(storeName => {
                        if (!db.objectStoreNames.contains(storeName)) {
                            db.createObjectStore(storeName, { keyPath: 'id', autoIncrement: true });
                        }
                    });
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø¨ÛŒØ³ Ø§Ù¾ Ú¯Ø±ÛŒÚˆ ÛÙˆ Ú¯Ø¦ÛŒ ÛŒØ§ Ø¨Ù† Ú¯Ø¦ÛŒ!', 'info');
                };
                request.onsuccess = (event) => {
                    db = event.target.result;
                    resolve(db);
                };
                request.onerror = (event) => {
                    console.error('IndexedDB error:', event.target.error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø¨ÛŒØ³ Ù„ÙˆÚˆ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    reject(event.target.error);
                };
            });
        };
        const addData = async (storeName, data) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.add(data);
                request.onsuccess = () => {
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø´Ø§Ù…Ù„ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§!', 'success');
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error adding data to ${storeName}:`, event.target.error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø´Ø§Ù…Ù„ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    reject(event.target.error);
                };
            });
        };
        const getAllData = async (storeName) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readonly');
                const store = transaction.objectStore(storeName);
                const request = store.getAll();
                request.onsuccess = () => {
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error getting all data from ${storeName}:`, event.target.error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø­Ø§ØµÙ„ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    reject(event.target.error);
                };
            });
        };
        const updateData = async (storeName, data) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.put(data);
                request.onsuccess = () => {
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§!', 'success');
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error updating data in ${storeName}:`, event.target.error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    reject(event.target.error);
                };
            });
        };
        const deleteData = async (storeName, id) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.delete(id);
                request.onsuccess = () => {
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø­Ø°Ù Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§!', 'success');
                    resolve();
                };
                request.onerror = (event) => {
                    console.error(`Error deleting data from ${storeName}:`, event.target.error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø­Ø°Ù Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    reject(event.target.error);
                };
            });
        };
        async function filesToBase64(files) {
            const filePromises = Array.from(files).map(file => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve({
                        name: file.name,
                        type: file.type,
                        data: reader.result
                    });
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            });
            return Promise.all(filePromises);
        }
        function displayFilePreviews(fileArray, previewElementId) {
            const previewDiv = document.getElementById(previewElementId);
            previewDiv.innerHTML = '';
            if (!fileArray || fileArray.length === 0) return;
            fileArray.forEach((file, index) => {
                const fileDiv = document.createElement('div');
                fileDiv.innerHTML = `
                ${file.type.startsWith('image/') ? `<img src="${file.data}" alt="${file.name}"/>` : '<i class="fas fa-file"></i>'}
                <span>${file.name}</span>
                <button type="button" data-index="${index}"><i class="fas fa-times"></i></button>
            `;
                fileDiv.querySelector('button').onclick = () => {
                    removeFileFromFormPreview(index, previewElementId);
                };
                previewDiv.appendChild(fileDiv);
            });
        }
        function removeFileFromFormPreview(indexToRemove, previewElementId) {
            const moduleName = document.querySelector('.module-section.active').id;
            const formId = `${moduleName}Form`;
            let currentFiles = window.currentEditFiles[formId];
            if (currentFiles && currentFiles.length > indexToRemove) {
                currentFiles.splice(indexToRemove, 1);
                displayFilePreviews(currentFiles, previewElementId);
            }
        }
        function downloadJSON(data, filename) {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        async function backupData() {
            showNotification('Ø¨ÛŒÚ© Ø§Ù¾ ØªÛŒØ§Ø± Ú©ÛŒØ§ Ø¬Ø§ Ø±ÛØ§ ÛÛ’...', 'info');
            const allData = {};
            const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
            try {
                for (const storeName of storeNames) {
                    allData[storeName] = await getAllData(storeName);
                }
                const timestamp = new Date().toISOString().replace(/[:.-]/g, '');
                downloadJSON(allData, `Ø¯ÙØªØ±_Ù…Ù†Ø¸Ù…_Ø¨ÛŒÚ©_Ø§Ù¾_${timestamp}.json`);
                showNotification('Ø¨ÛŒÚ© Ø§Ù¾ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§!', 'success');
            } catch (error) {
                console.error('Backup failed:', error);
                showNotification('Ø¨ÛŒÚ© Ø§Ù¾ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
            }
        }
        async function restoreData() {
            const fileInput = document.getElementById('restoreFile');
            const file = fileInput.files[0];
            if (!file) {
                showNotification('Ø¨Ø±Ø§Û Ú©Ø±Ù… JSON ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº!', 'error');
                return;
            }
            showNotification('ÚˆÛŒÙ¹Ø§ Ø¨Ø­Ø§Ù„ Ú©ÛŒØ§ Ø¬Ø§ Ø±ÛØ§ ÛÛ’...', 'info');
            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    const importedData = JSON.parse(event.target.result);
                    const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
                    await openDB();
                    for (const storeName of storeNames) {
                        const transaction = db.transaction([storeName], 'readwrite');
                        const store = transaction.objectStore(storeName);
                        await new Promise((resolve, reject) => {
                            const clearRequest = store.clear();
                            clearRequest.onsuccess = resolve;
                            clearRequest.onerror = reject;
                        });
                    }
                    for (const storeName of storeNames) {
                        if (importedData[storeName]) {
                            for (const item of importedData[storeName]) {
                                const newItem = { ...item };
                                delete newItem.id;
                                const transaction = db.transaction([storeName], 'readwrite');
                                const store = transaction.objectStore(storeName);
                                await new Promise((resolve, reject) => {
                                    const addRequest = store.add(newItem);
                                    addRequest.onsuccess = resolve;
                                    addRequest.onerror = reject;
                                });
                            }
                        }
                    }
                    showNotification('ÚˆÛŒÙ¹Ø§ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ø¨Ø­Ø§Ù„ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§!', 'success');
                    loadAllTables();
                } catch (error) {
                    console.error('Restore failed:', error);
                    showNotification('ÚˆÛŒÙ¹Ø§ Ø¨Ø­Ø§Ù„ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message, 'error');
                }
            };
            reader.onerror = (error) => {
                console.error('File reading error:', error);
                showNotification('ÙØ§Ø¦Ù„ Ù¾Ú‘Ú¾Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
            };
            reader.readAsText(file);
        }
        const moduleButtons = document.querySelectorAll('.sidebar ul li button');
        const moduleSections = document.querySelectorAll('.module-section');
        let activeModule = 'tasks';
        const activateModule = (moduleName) => {
            moduleSections.forEach(section => section.classList.remove('active'));
            document.getElementById(moduleName).classList.add('active');
            moduleButtons.forEach(button => button.classList.remove('active'));
            document.querySelector(`.sidebar ul li button[data-module="${moduleName}"]`).classList.add('active');
            activeModule = moduleName;
            loadModuleData(moduleName);
            clearForms();
        };
        moduleButtons.forEach(button => {
            button.addEventListener('click', () => {
                activateModule(button.dataset.module);
            });
        });
        document.addEventListener('DOMContentLoaded', () => {
            activateModule(activeModule);
        });
        const clearForms = () => {
            const forms = ['taskForm', 'reminderForm', 'urgentTaskForm', 'meetingForm', 'notificationForm', 'contactForm', 'performanceForm', 'scheduleForm', 'messageForm', 'letterForm', 'demandForm'];
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) {
                    form.reset();
                    const idInput = form.querySelector('input[type="hidden"]');
                    if (idInput) idInput.value = '';
                    const filePreview = form.querySelector('.file-upload-preview');
                    if (filePreview) filePreview.innerHTML = '';
                    window.currentEditFiles[formId] = [];
                }
            });
            document.querySelectorAll('.controls input[type="text"]').forEach(input => input.value = '');
            document.querySelectorAll('.controls input[type="date"]').forEach(input => input.value = '');
            document.querySelectorAll('.controls select').forEach(select => select.selectedIndex = 0);
        };
        window.currentEditFiles = {
            taskForm: [],
            notificationForm: [],
            performanceForm: [],
            messageForm: [],
            letterForm: [],
            demandForm: []
        };
        const handleFormSubmit = async (event, storeName, formId, clearFunc, fileInputId, filePreviewId) => {
            event.preventDefault();
            const form = document.getElementById(formId);
            const idInput = document.getElementById(`${storeName.slice(0, -1)}Id`);
            let data = {};
            Array.from(form.elements).forEach(element => {
                if (element.id && element.id !== idInput.id && element.type !== 'file' && element.tagName !== 'BUTTON') {
                    data[element.id] = element.value.trim();
                }
            });
            if (fileInputId) {
                const fileInput = document.getElementById(fileInputId);
                let combinedFiles = window.currentEditFiles[formId] || [];
                if (fileInput.files.length > 0) {
                    const newFilesBase64 = await filesToBase64(fileInput.files);
                    combinedFiles = [...combinedFiles, ...newFilesBase64];
                }
                data.files = combinedFiles;
            }
            if (idInput.value) {
                data.id = parseInt(idInput.value);
                await updateData(storeName, data);
            } else {
                await addData(storeName, data);
            }
            clearFunc();
            loadModuleData(storeName);
        };
        const editEntry = async (storeName, id, formId, fileInputId, filePreviewId) => {
            showNotification('ÚˆÛŒÙ¹Ø§ Ù„ÙˆÚˆ Ú©ÛŒØ§ Ø¬Ø§ Ø±ÛØ§ ÛÛ’...', 'info');
            await openDB();
            const transaction = db.transaction([storeName], 'readonly');
            const store = transaction.objectStore(storeName);
            const request = store.get(id);
            request.onsuccess = (event) => {
                const item = event.target.result;
                if (item) {
                    const form = document.getElementById(formId);
                    const idInput = document.getElementById(`${storeName.slice(0, -1)}Id`);
                    idInput.value = item.id;
                    Array.from(form.elements).forEach(element => {
                        if (element.id && element.id !== idInput.id && element.type !== 'file' && element.tagName !== 'BUTTON') {
                            element.value = item[element.id] || '';
                        }
                    });
                    if (fileInputId && filePreviewId) {
                        window.currentEditFiles[formId] = item.files || [];
                        displayFilePreviews(item.files || [], filePreviewId);
                    }
                    showNotification('ÚˆÛŒÙ¹Ø§ ÙØ§Ø±Ù… Ù…ÛŒÚº Ù„ÙˆÚˆ ÛÙˆ Ú¯ÛŒØ§!', 'info');
                    form.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else {
                    showNotification('Ø±ÛŒÚ©Ø§Ø±Úˆ Ù†ÛÛŒÚº Ù…Ù„Ø§!', 'error');
                }
            };
            request.onerror = (event) => {
                console.error(`Error fetching ${storeName} for edit:`, event.target.error);
                showNotification('ÚˆÛŒÙ¹Ø§ Ù„ÙˆÚˆ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
            };
        };
        const deleteEntry = async (storeName, id) => {
            if (confirm('Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø³ Ø±ÛŒÚ©Ø§Ø±Úˆ Ú©Ùˆ Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ')) {
                await deleteData(storeName, id);
                loadModuleData(storeName);
            }
        };
        const loadDataIntoTable = async (storeName, tableId, renderRowFunc, filterFunc, sortFunc) => {
            const data = await getAllData(storeName);
            let filteredData = data;
            if (filterFunc) {
                filteredData = filterFunc(data);
            }
            if (sortFunc) {
                filteredData.sort(sortFunc);
            }
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';
            if (filteredData.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="${document.querySelector(`#${tableId} thead tr`).children.length}">Ú©ÙˆØ¦ÛŒ Ø±ÛŒÚ©Ø§Ø±Úˆ Ù†ÛÛŒÚº Ù…Ù„Ø§Û”</td></tr>`;
                return;
            }
            filteredData.forEach(item => {
                tableBody.appendChild(renderRowFunc(item, storeName));
            });
        };
        const filterAndSort = (moduleName) => {
            loadModuleData(moduleName);
        };
        const addSampleData = async () => {
            showNotification('Ù†Ù…ÙˆÙ†Û ÚˆÛŒÙ¹Ø§ Ø´Ø§Ù…Ù„ Ú©ÛŒØ§ Ø¬Ø§ Ø±ÛØ§ ÛÛ’...', 'info');
            await Promise.all([
                addData('tasks', { taskId: 1, taskName: 'Ù…ÛŒÙ¹Ù†Ú¯ Ú©ÛŒ ØªÛŒØ§Ø±ÛŒ', taskDescription: 'Ø¢Ø¦Ù†Ø¯Û ÛÙØªÛ’ Ú©ÛŒ Ù…ÛŒÙ¹Ù†Ú¯ Ú©Û’ Ø§ÛŒØ¬Ù†ÚˆÛ’ Ø§ÙˆØ± Ø±Ù¾ÙˆØ±Ù¹Ø³ ØªÛŒØ§Ø± Ú©Ø±ÛŒÚºÛ”', taskDueDate: '2023-11-25', taskPriority: 'Ø§Ù†ØªÛØ§Ø¦ÛŒ Ø§ÛÙ…', taskStatus: 'Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§', files: [] }),
                addData('tasks', { taskId: 2, taskName: 'Ù…Ø§ÛØ§Ù†Û Ø±Ù¾ÙˆØ±Ù¹ Ø¬Ù…Ø¹ Ú©Ø±Ø§Ù†Ø§', taskDescription: 'Ø§Ú©ØªÙˆØ¨Ø± Ú©ÛŒ Ù…Ø§ÛØ§Ù†Û Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ Ø±Ù¾ÙˆØ±Ù¹ Ø¬Ù…Ø¹ Ú©Ø±Ø§Ø¦ÛŒÚºÛ”', taskDueDate: '2023-11-15', taskPriority: 'Ø§ÛÙ…', taskStatus: 'Ù…Ú©Ù…Ù„', files: [] }),
                addData('reminders', { reminderId: 1, reminderTitle: 'Ú©Ø±Ø§ÛŒÛ Ú©ÛŒ Ø§Ø¯Ø§Ø¦ÛŒÚ¯ÛŒ', reminderDetails: 'Ø¯ÙØªØ± Ú©Û’ Ú©Ø±Ø§ÛŒÛ Ú©ÛŒ Ø§Ø¯Ø§Ø¦ÛŒÚ¯ÛŒ Ú©ÛŒ Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®Û”', reminderDate: '2023-12-01', reminderTime: '10:00', reminderType: 'Ø§Ù„Ø§Ø±Ù…' }),
                addData('reminders', { reminderId: 2, reminderTitle: 'Ø¨Ù„ Ø¬Ù…Ø¹ Ú©Ø±Ø§Ù†Ø§', reminderDetails: 'Ø¨Ø¬Ù„ÛŒ Ú©Ø§ Ø¨Ù„ Ø¬Ù…Ø¹ Ú©Ø±Ø§Ù†Û’ Ú©ÛŒ ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒÛ”', reminderDate: '2023-11-20', reminderTime: '', reminderType: 'ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±' }),
                addData('urgentTasks', { urgentTaskId: 1, urgentTaskName: 'ÙÙˆØ±ÛŒ ÚˆØ§Ú© Ú©ÛŒ ØªØ±Ø³ÛŒÙ„', urgentTaskDescription: 'Ø§ÛÙ… Ø¯Ø³ØªØ§ÙˆÛŒØ²Ø§Øª Ø¢Ø¬ ÛÛŒ Ø¨Ú¾ÛŒØ¬Ù†Ø§ ÛÛŒÚºÛ”', urgentTaskDueDate: '2023-11-14', urgentTaskDueTime: '17:00' }),
                addData('urgentTasks', { urgentTaskId: 2, urgentTaskName: 'ÛÙ†Ú¯Ø§Ù…ÛŒ Ù…Ø±Ù…Øª', urgentTaskDescription: 'Ø³Ø±ÙˆØ± Ø±ÙˆÙ… Ù…ÛŒÚº ÙÙˆØ±ÛŒ Ù…Ø±Ù…Øª Ø¯Ø±Ú©Ø§Ø± ÛÛ’Û”', urgentTaskDueDate: '2023-11-16', urgentTaskDueTime: '09:00' }),
                addData('meetings', { meetingId: 1, meetingPerson: 'Ø³ÛŒ Ø§ÛŒ Ø§Ùˆ Ø§ÙˆØ± Ù…Ù†ÛŒØ¬Ø±Ø²', meetingDate: '2023-11-20', meetingTime: '11:00', meetingLocation: 'Ú©Ø§Ù†ÙØ±Ù†Ø³ Ø±ÙˆÙ…', meetingDetails: 'Ø³Û Ù…Ø§ÛÛŒ Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ Ø¬Ø§Ø¦Ø²Û Ù…ÛŒÙ¹Ù†Ú¯Û”' }),
                addData('meetings', { meetingId: 2, meetingPerson: 'Ú©Ø³Ù¹Ù…Ø± Ø³Ù¾ÙˆØ±Ù¹ Ù¹ÛŒÙ…', meetingDate: '2023-11-22', meetingTime: '14:00', meetingLocation: 'Ø¢Ù† Ù„Ø§Ø¦Ù†', meetingDetails: 'Ù†Ø¦ÛŒ Ù¾Ø§Ù„ÛŒØ³ÛŒ Ù¾Ø± Ø¨Ø±ÛŒÙÙ†Ú¯Û”' }),
                addData('notifications', { notificationId: 1, notificationTitle: 'Ø¨Ø¬Ù„ÛŒ Ø¨Ù†Ø¯Ø´ Ú©ÛŒ Ø§Ø·Ù„Ø§Ø¹', notificationType: 'Ø¯Ø§Ø®Ù„ÛŒ', notificationDetails: 'Ú©Ù„ Ø¯ÙˆÙ¾ÛØ± 2 Ø³Û’ 4 Ø¨Ø¬Û’ ØªÚ© Ø¨Ø¬Ù„ÛŒ Ø¨Ù†Ø¯ Ø±ÛÛ’ Ú¯ÛŒÛ”', notificationDate: '2023-11-14', files: [] }),
                addData('notifications', { notificationId: 2, notificationTitle: 'Ø¹ÙˆØ§Ù…ÛŒ Ú†Ú¾Ù¹ÛŒ', notificationType: 'Ø®Ø§Ø±Ø¬ÛŒ', notificationDetails: '18 Ù†ÙˆÙ…Ø¨Ø± Ú©Ùˆ Ø¹Ø§Ù… ØªØ¹Ø·ÛŒÙ„ ÛÙˆÚ¯ÛŒÛ”', notificationDate: '2023-11-10', files: [] }),
                addData('contacts', { contactId: 1, contactName: 'Ø§Ø­Ù…Ø¯ Ø®Ø§Ù† (Ø³Ù¾Ù„Ø§Ø¦Ø±)', contactPhone: '03001234567', contactEmail: 'ahmed@supplier.com', contactRelationship: 'Ø³Ù¾Ù„Ø§Ø¦Ø±', contactAddress: 'Ú©Ø±Ø§Ú†ÛŒ' }),
                addData('contacts', { contactId: 2, contactName: 'ÙØ§Ø·Ù…Û Ø¨ÛŒÚ¯Ù… (Ú©Ù„Ø§Ø¦Ù†Ù¹)', contactPhone: '03339876543', contactEmail: 'fatima@client.org', contactRelationship: 'Ø§ÛÙ… Ú©Ù„Ø§Ø¦Ù†Ù¹', contactAddress: 'Ù„Ø§ÛÙˆØ±' }),
                addData('performance', { performanceId: 1, performanceTitle: 'Ø§Ú©ØªÙˆØ¨Ø± Ù…Ø§Û Ú©ÛŒ Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ', performancePeriod: 'Ù…Ø§ÛØ§Ù†Û', performanceDate: '2023-11-05', performanceDetails: 'Ø§Ú©ØªÙˆØ¨Ø± Ù…ÛŒÚº Ø³ÛŒÙ„Ø² Ù…ÛŒÚº 15% Ø§Ø¶Ø§ÙÛ ÛÙˆØ§Û”', files: [] }),
                addData('performance', { performanceId: 2, performanceTitle: 'Ø³Ø§Ù„Ø§Ù†Û Ø¢ÚˆÙ¹ Ø±Ù¾ÙˆØ±Ù¹', performancePeriod: 'Ø³Ø§Ù„Ø§Ù†Û', performanceDate: '2023-10-30', performanceDetails: 'Ø³Ø§Ù„ 2022-23 Ú©Û’ Ù„ÛŒÛ’ Ø¢ÚˆÙ¹ Ù…Ú©Ù…Ù„Û”', files: [] }),
                addData('schedules', { scheduleId: 1, scheduleName: 'Ù…ÛŒÙ„Ø§Ø¯ Ø§Ù„Ù†Ø¨ÛŒ ï·º ØªÙ‚Ø±ÛŒØ¨', scheduleType: 'Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª', scheduleDate: '2023-09-28', scheduleTime: '19:00', scheduleLocation: 'Ù…Ù‚Ø§Ù…ÛŒ Ù…Ø³Ø¬Ø¯', scheduleDetails: 'Ø´Ø§Ù… 7 Ø¨Ø¬Û’ Ø´Ø±ÙˆØ¹ ÛÙˆ Ú¯ÛŒÛ”' }),
                addData('schedules', { scheduleId: 2, scheduleName: 'ÛŒÙˆÙ†ÛŒÙˆØ±Ø³Ù¹ÛŒ ÙÛŒØ³Ù¹ÙˆÙ„', scheduleType: 'Ø¯ÛŒÚ¯Ø±', scheduleDate: '2023-12-05', scheduleTime: '10:00', scheduleLocation: 'ÛŒÙˆÙ†ÛŒÙˆØ±Ø³Ù¹ÛŒ Ø¢ÚˆÛŒÙ¹ÙˆØ±ÛŒÙ…', scheduleDetails: 'Ø³Û Ø±ÙˆØ²Û ØªÙ‚Ø±ÛŒØ¨Û”' }),
                addData('messages', { messageId: 1, messageType: 'Ù…ÙˆØµÙˆÙ„ Ø´Ø¯Û', messageSenderReceiver: 'Ù…Ø­Ù…Ø¯ Ø¹Ù„ÛŒ', messageSubject: 'Ù¾Ø±ÙˆØ¬ÛŒÚ©Ù¹ Ú©ÛŒ ØªØ§Ø²Û Ú©Ø§Ø±ÛŒ', messageDetails: 'Ù¾Ø±ÙˆØ¬ÛŒÚ©Ù¹ Ú©ÛŒ Ù¾ÛŒØ´ Ø±ÙØª Ø³Û’ Ù…ØªØ¹Ù„Ù‚ Ø§ÛŒ Ù…ÛŒÙ„ Ù…ÙˆØµÙˆÙ„ ÛÙˆØ¦ÛŒÛ”', messageDate: '2023-11-12', files: [] }),
                addData('messages', { messageId: 2, messageType: 'Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Û', messageSenderReceiver: 'Ø³Ø§Ø±Û Ø§Ø­Ù…Ø¯', messageSubject: 'Ù¹ÛŒÙ… Ù…ÛŒÙ¹Ù†Ú¯', messageDetails: 'Ø¢Ø¬ Ú©ÛŒ Ù¹ÛŒÙ… Ù…ÛŒÙ¹Ù†Ú¯ Ú©Ø§ Ø§ÛŒØ¬Ù†ÚˆØ§Û”', messageDate: '2023-11-13', files: [] }),
                addData('letters', { letterId: 1, letterRecipient: 'Ø³ÛŒÚ©Ø±Ù¹Ø±ÛŒ ÙˆØ²Ø§Ø±Øª ØªØ¹Ù„ÛŒÙ…', letterSubject: 'ØªØ¹Ù„ÛŒÙ…ÛŒ Ø³ÛŒÙ…ÛŒÙ†Ø§Ø± Ú©ÛŒ Ø¯Ø¹ÙˆØª', letterDate: '2023-11-08', letterDetails: 'Ø¢Ø¦Ù†Ø¯Û ØªØ¹Ù„ÛŒÙ…ÛŒ Ø³ÛŒÙ…ÛŒÙ†Ø§Ø± Ù…ÛŒÚº Ø´Ø±Ú©Øª Ú©ÛŒ Ø¯Ø¹ÙˆØª Ú©Ø§ Ø®Ø·Û”', files: [] }),
                addData('letters', { letterId: 2, letterRecipient: 'Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø±Ø§Ù† (Ø§ÛŒÚ† Ø¢Ø±)', letterSubject: 'Ú†Ú¾Ù¹ÛŒ Ú©ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª', letterDate: '2023-11-09', letterDetails: 'Ø§ÛŒÚ© Ø¯Ù† Ú©ÛŒ Ú†Ú¾Ù¹ÛŒ Ú©Û’ Ù„ÛŒÛ’ Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛ”', files: [] }),
                addData('demands', { demandId: 1, demandSubject: 'Ù†Ø¦Û’ Ø³Ù¹ÛŒØ´Ù†Ø±ÛŒ Ú©Ø§ Ù…Ø·Ø§Ù„Ø¨Û', demandRequester: 'Ø§Ú©Ø§Ø¤Ù†Ù¹Ø³ ÚˆÛŒÙ¾Ø§Ø±Ù¹Ù…Ù†Ù¹', demandDate: '2023-11-10', demandDetails: 'Ø¢ÙØ³ Ú©Û’ Ù„ÛŒÛ’ Ø¶Ø±ÙˆØ±ÛŒ Ø³Ù¹ÛŒØ´Ù†Ø±ÛŒ Ú©Ø§ Ù…Ø·Ø§Ù„Ø¨ÛÛ”', demandStatus: 'Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§', files: [] }),
                addData('demands', { demandId: 2, demandSubject: 'Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ù„Ø§Ø¦Ø³Ù†Ø³', demandRequester: 'Ø¢Ø¦ÛŒ Ù¹ÛŒ ÚˆÛŒÙ¾Ø§Ø±Ù¹Ù…Ù†Ù¹', demandDate: '2023-11-07', demandDetails: 'Ù†Ø¦Û’ Ú¯Ø±Ø§ÙÚ© ÚˆÛŒØ²Ø§Ø¦Ù†Ù†Ú¯ Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ù„Ø§Ø¦Ø³Ù†Ø³ Ú©ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛ”', demandStatus: 'Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û', files: [] }),
            ]).then(() => {
                showNotification('Ù†Ù…ÙˆÙ†Û Ø§Ù†Ø¯Ø±Ø§Ø¬Ø§Øª Ø´Ø§Ù…Ù„ Ú©Ø± Ø¯ÛŒÛ’ Ú¯Ø¦Û’!', 'success');
                loadAllTables();
            }).catch(error => {
                console.error('Error adding sample data:', error);
                showNotification('Ù†Ù…ÙˆÙ†Û ÚˆÛŒÙ¹Ø§ Ø´Ø§Ù…Ù„ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
            });
        };
        const loadAllTables = () => {
            loadModuleData('tasks');
            loadModuleData('reminders');
            loadModuleData('urgentTasks');
            loadModuleData('meetings');
            loadModuleData('notifications');
            loadModuleData('contacts');
            loadModuleData('performance');
            loadModuleData('schedules');
            loadModuleData('messages');
            loadModuleData('letters');
            loadModuleData('demands');
        };
        const modules = {
            tasks: {
                tableId: 'tasksTable',
                formId: 'taskForm',
                fileInputId: 'taskFiles',
                filePreviewId: 'taskFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.taskDueDate || 'N/A'}</td>
                        <td data-label="Ú©Ø§Ù… Ú©Ø§ Ø¹Ù†ÙˆØ§Ù†:">${item.taskName}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.taskDescription || ''}</td>
                        <td data-label="Ø§ÛÙ…ÛŒØª:"><span class="status-badge ${item.taskPriority === 'Ø§Ù†ØªÛØ§Ø¦ÛŒ Ø§ÛÙ…' ? 'urgent' : item.taskPriority === 'Ø§ÛÙ…' ? 'info' : ''}">${item.taskPriority}</span></td>
                        <td data-label="Ø­Ø§Ù„Øª:"><span class="status-badge ${item.taskStatus === 'Ù…Ú©Ù…Ù„' ? 'complete' : 'pending'}">${item.taskStatus}</span></td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('tasks', ${item.id}, 'taskForm', 'taskFiles', 'taskFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('tasks', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('taskSearch').value.toLowerCase();
                    const filterDate = document.getElementById('taskFilterDate').value;
                    return data.filter(item =>
                        ((item.taskName || '').toLowerCase().includes(search) || (item.taskDescription || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.taskDueDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('taskSortBy').value;
                    if (sortBy === 'dueDate') return new Date(a.taskDueDate) - new Date(b.taskDueDate);
                    if (sortBy === 'dueDateDesc') return new Date(b.taskDueDate) - new Date(a.taskDueDate);
                    if (sortBy === 'priority') {
                        const priorityOrder = { 'Ø§Ù†ØªÛØ§Ø¦ÛŒ Ø§ÛÙ…': 4, 'Ø§ÛÙ…': 3, 'Ø§ÙˆØ³Ø·': 2, 'Ù…Ø¹Ù…ÙˆÙ„ÛŒ': 1 };
                        return priorityOrder[b.taskPriority] - priorityOrder[a.taskPriority];
                    }
                    if (sortBy === 'status') return a.taskStatus.localeCompare(b.taskStatus);
                    return 0;
                }
            },
            reminders: {
                tableId: 'remindersTable',
                formId: 'reminderForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="Ø¹Ù†ÙˆØ§Ù†:">${item.reminderTitle}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.reminderDetails || ''}</td>
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.reminderDate}</td>
                        <td data-label="ÙˆÙ‚Øª:">${item.reminderTime || 'N/A'}</td>
                        <td data-label="Ù†ÙˆØ¹ÛŒØª:"><span class="status-badge ${item.reminderType === 'Ø§Ù„Ø§Ø±Ù…' ? 'urgent' : item.reminderType === 'ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±' ? 'info' : ''}">${item.reminderType}</span></td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('reminders', ${item.id}, 'reminderForm')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('reminders', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('reminderSearch').value.toLowerCase();
                    const filterDate = document.getElementById('reminderFilterDate').value;
                    return data.filter(item =>
                        ((item.reminderTitle || '').toLowerCase().includes(search) || (item.reminderDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.reminderDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('reminderSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.reminderDate}T${a.reminderTime || '00:00'}`) - new Date(`${b.reminderDate}T${b.reminderTime || '00:00'}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.reminderDate}T${b.reminderTime || '00:00'}`) - new Date(`${a.reminderDate}T${a.reminderTime || '00:00'}`);
                    if (sortBy === 'type') return a.reminderType.localeCompare(b.reminderType);
                    return 0;
                }
            },
            urgentTasks: {
                tableId: 'urgentTasksTable',
                formId: 'urgentTaskForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="Ø¹Ù†ÙˆØ§Ù†:">${item.urgentTaskName}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.urgentTaskDescription || ''}</td>
                        <td data-label="Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ®:">${item.urgentTaskDueDate}</td>
                        <td data-label="Ø¢Ø®Ø±ÛŒ ÙˆÙ‚Øª:">${item.urgentTaskDueTime || 'N/A'}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('urgentTasks', ${item.id}, 'urgentTaskForm')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('urgentTasks', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('urgentTaskSearch').value.toLowerCase();
                    const filterDate = document.getElementById('urgentTaskFilterDate').value;
                    return data.filter(item =>
                        (item.urgentTaskName.toLowerCase().includes(search) || (item.urgentTaskDescription || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.urgentTaskDueDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('urgentTaskSortBy').value;
                    if (sortBy === 'dueDate') return new Date(a.urgentTaskDueDate) - new Date(b.urgentTaskDueDate);
                    if (sortBy === 'dueDateDesc') return new Date(b.urgentTaskDueDate) - new Date(a.urgentTaskDueDate);
                    return 0;
                }
            },
            meetings: {
                tableId: 'meetingsTable',
                formId: 'meetingForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.meetingDate}</td>
                        <td data-label="ÙˆÙ‚Øª:">${item.meetingTime}</td>
                        <td data-label="Ø´Ø®ØµÛŒØ§Øª:">${item.meetingPerson}</td>
                        <td data-label="Ø¬Ú¯Û:">${item.meetingLocation || ''}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.meetingDetails || ''}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('meetings', ${item.id}, 'meetingForm')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('meetings', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('meetingSearch').value.toLowerCase();
                    const filterDate = document.getElementById('meetingFilterDate').value;
                    return data.filter(item =>
                        (item.meetingPerson.toLowerCase().includes(search) || (item.meetingLocation || '').toLowerCase().includes(search) || (item.meetingDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.meetingDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('meetingSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.meetingDate}T${a.meetingTime}`) - new Date(`${b.meetingDate}T${b.meetingTime}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.meetingDate}T${b.meetingTime}`) - new Date(`${a.meetingDate}T${a.meetingTime}`);
                    return 0;
                }
            },
            notifications: {
                tableId: 'notificationsTable',
                formId: 'notificationForm',
                fileInputId: 'notificationFiles',
                filePreviewId: 'notificationFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.notificationDate}</td>
                        <td data-label="Ø¹Ù†ÙˆØ§Ù†:">${item.notificationTitle}</td>
                        <td data-label="Ù†ÙˆØ¹ÛŒØª:"><span class="status-badge ${item.notificationType === 'Ø¯Ø§Ø®Ù„ÛŒ' ? 'info' : 'secondary'}">${item.notificationType}</span></td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.notificationDetails || ''}</td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('notifications', ${item.id}, 'notificationForm', 'notificationFiles', 'notificationFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('notifications', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('notificationSearch').value.toLowerCase();
                    const filterDate = document.getElementById('notificationFilterDate').value;
                    return data.filter(item =>
                        (item.notificationTitle.toLowerCase().includes(search) || (item.notificationDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.notificationDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('notificationSortBy').value;
                    if (sortBy === 'date') return new Date(a.notificationDate) - new Date(b.notificationDate);
                    if (sortBy === 'dateDesc') return new Date(b.notificationDate) - new Date(a.notificationDate);
                    if (sortBy === 'type') return a.notificationType.localeCompare(b.notificationType);
                    return 0;
                }
            },
            contacts: {
                tableId: 'contactsTable',
                formId: 'contactForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const encodedMessage = encodeURIComponent(item.contactMessage || '');

                    tr.innerHTML = `
        <td data-label="Ù†Ø§Ù…/ØªÙ†Ø¸ÛŒÙ…:">${(item.contactName || '')}</td>
        <td data-label="ÙÙˆÙ†:">${item.contactPhone || 'N/A'} 
            ${item.contactPhone ? `<button class="whatsapp-btn" onclick="window.open('https://wa.me/${item.contactPhone.replace(/\D/g, '')}?text=${encodedMessage}', '_blank')"><i class="fab fa-whatsapp"></i> WhatsApp</button>` : ''}
            ${item.contactPhone ? `<button class="sms-btn" onclick="window.open('sms:${item.contactPhone.replace(/\D/g, '')}?body=${encodedMessage}', '_blank')"><i class="fas fa-sms"></i> SMS</button>` : ''}
        </td>
        <td data-label="Ø§ÛŒ Ù…ÛŒÙ„:">${item.contactEmail || 'N/A'} ${item.contactEmail ? `<a href="mailto:${item.contactEmail}"><i class="fas fa-envelope"></i> Ø§ÛŒ Ù…ÛŒÙ„ Ú©Ø±ÛŒÚº</a>` : ''}</td>
        <td data-label="Ø±Ø´ØªÛ/Ù…Ø¹Ù…ÙˆÙ„:">${item.contactRelationship || ''}</td>
        <td data-label="Ù¾ÛŒØºØ§Ù…:">${item.contactMessage || ''}</td>
        <td data-label="Ù¾ØªÛ:">${item.contactAddress || ''}</td>
        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
            <button class="edit-btn" onclick="editEntry('contacts', ${item.id}, 'contactForm')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
            <button class="delete-btn" onclick="deleteEntry('contacts', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
        </td>
    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('contactSearch').value.toLowerCase();
                    return data.filter(item =>
                        (item.contactName.toLowerCase().includes(search) || (item.contactPhone || '').toLowerCase().includes(search) || (item.contactEmail || '').toLowerCase().includes(search) || (item.contactRelationship || '').toLowerCase().includes(search) || (item.contactAddress || '').toLowerCase().includes(search))
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('contactSortBy').value;
                    if (sortBy === 'name') return a.contactName.localeCompare(b.contactName);
                    if (sortBy === 'nameDesc') return b.contactName.localeCompare(a.contactName);
                    return 0;
                }
            },
            performance: {
                tableId: 'performanceTable',
                formId: 'performanceForm',
                fileInputId: 'performanceFiles',
                filePreviewId: 'performanceFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.performanceDate}</td>
                        <td data-label="Ø¹Ù†ÙˆØ§Ù†:">${item.performanceTitle}</td>
                        <td data-label="Ù…Ø¯Øª:">${item.performancePeriod}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.performanceDetails || ''}</td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('performance', ${item.id}, 'performanceForm', 'performanceFiles', 'performanceFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('performance', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('performanceSearch').value.toLowerCase();
                    const filterDate = document.getElementById('performanceFilterDate').value;
                    return data.filter(item =>
                        (item.performanceTitle.toLowerCase().includes(search) || (item.performanceDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.performanceDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('performanceSortBy').value;
                    if (sortBy === 'date') return new Date(a.performanceDate) - new Date(b.performanceDate);
                    if (sortBy === 'dateDesc') return new Date(b.performanceDate) - new Date(a.performanceDate);
                    if (sortBy === 'period') {
                        const periodOrder = { 'Ù…Ø§ÛØ§Ù†Û': 1, 'Ø³Û Ù…Ø§ÛÛŒ': 2, 'Ø³Ø§Ù„Ø§Ù†Û': 3, 'Ø¯ÛŒÚ¯Ø±': 4 };
                        return periodOrder[a.performancePeriod] - periodOrder[b.performancePeriod];
                    }
                    return 0;
                }
            },
            schedules: {
                tableId: 'schedulesTable',
                formId: 'scheduleForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.scheduleDate}</td>
                        <td data-label="ÙˆÙ‚Øª:">${item.scheduleTime}</td>
                        <td data-label="Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ú©Ø§ Ù†Ø§Ù…:">${item.scheduleName}</td>
                        <td data-label="Ù†ÙˆØ¹ÛŒØª:">${item.scheduleType || ''}</td>
                        <td data-label="Ø¬Ú¯Û:">${item.scheduleLocation || ''}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.scheduleDetails || ''}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('schedules', ${item.id}, 'scheduleForm')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('schedules', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('scheduleSearch').value.toLowerCase();
                    const filterDate = document.getElementById('scheduleFilterDate').value;
                    return data.filter(item =>
                        (item.scheduleName.toLowerCase().includes(search) || (item.scheduleType || '').toLowerCase().includes(search) || (item.scheduleLocation || '').toLowerCase().includes(search) || (item.scheduleDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.scheduleDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('scheduleSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.scheduleDate}T${a.scheduleTime}`) - new Date(`${b.scheduleDate}T${b.scheduleTime}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.scheduleDate}T${b.scheduleTime}`) - new Date(`${a.scheduleDate}T${a.scheduleTime}`);
                    if (sortBy === 'type') return a.scheduleType.localeCompare(b.scheduleType);
                    return 0;
                }
            },
            messages: {
                tableId: 'messagesTable',
                formId: 'messageForm',
                fileInputId: 'messageFiles',
                filePreviewId: 'messageFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.messageDate}</td>
                        <td data-label="Ù†ÙˆØ¹ÛŒØª:">${item.messageType}</td>
                        <td data-label="Ø¨Ú¾ÛŒØ¬Ù†Û’ ÙˆØ§Ù„Ø§/ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û:">${item.messageSenderReceiver}</td>
                        <td data-label="Ù…Ø¶Ù…ÙˆÙ†:">${item.messageSubject || ''}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.messageDetails || ''}</td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('messages', ${item.id}, 'messageForm', 'messageFiles', 'messageFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('messages', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('messageSearch').value.toLowerCase();
                    const filterDate = document.getElementById('messageFilterDate').value;
                    return data.filter(item =>
                        (item.messageSenderReceiver.toLowerCase().includes(search) || (item.messageSubject || '').toLowerCase().includes(search) || (item.messageDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.messageDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('messageSortBy').value;
                    if (sortBy === 'date') return new Date(a.messageDate) - new Date(b.messageDate);
                    if (sortBy === 'dateDesc') return new Date(b.messageDate) - new Date(a.messageDate);
                    if (sortBy === 'type') return a.messageType.localeCompare(b.messageType);
                    return 0;
                }
            },
            letters: {
                tableId: 'lettersTable',
                formId: 'letterForm',
                fileInputId: 'letterFiles',
                filePreviewId: 'letterFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ® Ø§Ø¬Ø±Ø§:">${item.letterDate}</td>
                        <td data-label="ÙˆØµÙˆÙ„ Ú©Ù†Ù†Ø¯Û:">${item.letterRecipient}</td>
                        <td data-label="Ù…Ø¶Ù…ÙˆÙ†:">${item.letterSubject || ''}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.letterDetails || ''}</td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('letters', ${item.id}, 'letterForm', 'letterFiles', 'letterFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('letters', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('letterSearch').value.toLowerCase();
                    const filterDate = document.getElementById('letterFilterDate').value;
                    return data.filter(item =>
                        (item.letterRecipient.toLowerCase().includes(search) || (item.letterSubject || '').toLowerCase().includes(search) || (item.letterDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.letterDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('letterSortBy').value;
                    if (sortBy === 'date') return new Date(a.letterDate) - new Date(b.letterDate);
                    if (sortBy === 'dateDesc') return new Date(b.letterDate) - new Date(a.letterDate);
                    return 0;
                }
            },
            demands: {
                tableId: 'demandsTable',
                formId: 'demandForm',
                fileInputId: 'demandFiles',
                filePreviewId: 'demandFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ØªØ§Ø±ÛŒØ®:">${item.demandDate}</td>
                        <td data-label="Ø¹Ù†ÙˆØ§Ù†:">${item.demandSubject}</td>
                        <td data-label="Ù…Ø·Ø§Ù„Ø¨Û Ú©Ø±Ù†Û’ ÙˆØ§Ù„Ø§:">${item.demandRequester}</td>
                        <td data-label="ØªÙØµÛŒÙ„:">${item.demandDetails || ''}</td>
                        <td data-label="Ø­Ø§Ù„Øª:"><span class="status-badge ${item.demandStatus === 'Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û' ? 'complete' : item.demandStatus === 'Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û' ? 'rejected' : 'pending'}">${item.demandStatus}</span></td>
                        <td data-label="ÙØ§Ø¦Ù„ÛŒÚº:">${filesHtml}</td>
                        <td data-label="Ø¢Ù¾Ø´Ù†Ø²:">
                            <button class="edit-btn" onclick="editEntry('demands', ${item.id}, 'demandForm', 'demandFiles', 'demandFilesPreview')"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ú©Ø±ÛŒÚº</button>
                            <button class="delete-btn" onclick="deleteEntry('demands', ${item.id})"><i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('demandSearch').value.toLowerCase();
                    const filterDate = document.getElementById('demandFilterDate').value;
                    const statusFilter = document.getElementById('demandSortBy').value === 'status' ? document.getElementById('demandStatus').value : null;
                    return data.filter(item =>
                        (item.demandSubject.toLowerCase().includes(search) || item.demandRequester.toLowerCase().includes(search) || (item.demandDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.demandDate === filterDate) &&
                        (!statusFilter || item.demandStatus === statusFilter)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('demandSortBy').value;
                    if (sortBy === 'date') return new Date(a.demandDate) - new Date(b.demandDate);
                    if (sortBy === 'dateDesc') return new Date(b.demandDate) - new Date(a.demandDate);
                    if (sortBy === 'status') {
                        const statusOrder = { 'Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§': 1, 'Ù…Ú©Ù…Ù„': 2, 'Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û': 3, 'Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û': 4 };
                        return statusOrder[a.demandStatus] - statusOrder[b.demandStatus];
                    }
                    return 0;
                }
            }
        };
        const loadModuleData = async (moduleName) => {
            const module = modules[moduleName];
            if (module) {
                await loadDataIntoTable(moduleName, module.tableId, module.render, module.filter, module.sort);
            }
        };
        document.getElementById('taskForm').addEventListener('submit', (e) => handleFormSubmit(e, 'tasks', 'taskForm', clearForms, 'taskFiles', 'taskFilesPreview'));
        document.getElementById('clearTaskForm').addEventListener('click', clearForms);
        document.getElementById('taskFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.taskForm = base64Files;
                    displayFilePreviews(base64Files, 'taskFilesPreview');
                });
            } else {
                document.getElementById('taskFilesPreview').innerHTML = '';
                window.currentEditFiles.taskForm = [];
            }
        });
        document.getElementById('reminderForm').addEventListener('submit', (e) => handleFormSubmit(e, 'reminders', 'reminderForm', clearForms));
        document.getElementById('clearReminderForm').addEventListener('click', clearForms);
        document.getElementById('urgentTaskForm').addEventListener('submit', (e) => handleFormSubmit(e, 'urgentTasks', 'urgentTaskForm', clearForms));
        document.getElementById('clearUrgentTaskForm').addEventListener('click', clearForms);
        document.getElementById('meetingForm').addEventListener('submit', (e) => handleFormSubmit(e, 'meetings', 'meetingForm', clearForms));
        document.getElementById('clearMeetingForm').addEventListener('click', clearForms);
        document.getElementById('notificationForm').addEventListener('submit', (e) => handleFormSubmit(e, 'notifications', 'notificationForm', clearForms, 'notificationFiles', 'notificationFilesPreview'));
        document.getElementById('clearNotificationForm').addEventListener('click', clearForms);
        document.getElementById('notificationFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.notificationForm = base64Files;
                    displayFilePreviews(base64Files, 'notificationFilesPreview');
                });
            } else {
                document.getElementById('notificationFilesPreview').innerHTML = '';
                window.currentEditFiles.notificationForm = [];
            }
        });
        document.getElementById('contactForm').addEventListener('submit', (e) => handleFormSubmit(e, 'contacts', 'contactForm', clearForms));
        document.getElementById('clearContactForm').addEventListener('click', clearForms);
        document.getElementById('performanceForm').addEventListener('submit', (e) => handleFormSubmit(e, 'performance', 'performanceForm', clearForms, 'performanceFiles', 'performanceFilesPreview'));
        document.getElementById('clearPerformanceForm').addEventListener('click', clearForms);
        document.getElementById('performanceFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.performanceForm = base64Files;
                    displayFilePreviews(base64Files, 'performanceFilesPreview');
                });
            } else {
                document.getElementById('performanceFilesPreview').innerHTML = '';
                window.currentEditFiles.performanceForm = [];
            }
        });
        document.getElementById('scheduleForm').addEventListener('submit', (e) => handleFormSubmit(e, 'schedules', 'scheduleForm', clearForms));
        document.getElementById('clearScheduleForm').addEventListener('click', clearForms);
        document.getElementById('messageForm').addEventListener('submit', (e) => handleFormSubmit(e, 'messages', 'messageForm', clearForms, 'messageFiles', 'messageFilesPreview'));
        document.getElementById('clearMessageForm').addEventListener('click', clearForms);
        document.getElementById('messageFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.messageForm = base64Files;
                    displayFilePreviews(base64Files, 'messageFilesPreview');
                });
            } else {
                document.getElementById('messageFilesPreview').innerHTML = '';
                window.currentEditFiles.messageForm = [];
            }
        });
        document.getElementById('letterForm').addEventListener('submit', (e) => handleFormSubmit(e, 'letters', 'letterForm', clearForms, 'letterFiles', 'letterFilesPreview'));
        document.getElementById('clearLetterForm').addEventListener('click', clearForms);
        document.getElementById('letterFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.letterForm = base64Files;
                    displayFilePreviews(base64Files, 'letterFilesPreview');
                });
            } else {
                document.getElementById('letterFilesPreview').innerHTML = '';
                window.currentEditFiles.letterForm = [];
            }
        });
        document.getElementById('demandForm').addEventListener('submit', (e) => handleFormSubmit(e, 'demands', 'demandForm', clearForms, 'demandFiles', 'demandFilesPreview'));
        document.getElementById('clearDemandForm').addEventListener('click', clearForms);
        document.getElementById('demandFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.demandForm = base64Files;
                    displayFilePreviews(base64Files, 'demandFilesPreview');
                });
            } else {
                document.getElementById('demandFilesPreview').innerHTML = '';
                window.currentEditFiles.demandForm = [];
            }
        });
        window.exportTable = async (tableId, format) => {
            const table = document.getElementById(tableId);
            if (!table) {
                showNotification('Ù¹ÛŒØ¨Ù„ Ù†ÛÛŒÚº Ù…Ù„Ø§!', 'error');
                return;
            }
            const headers = Array.from(table.querySelectorAll('thead th:not(:last-child)')).map(th => th.textContent.trim());
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const data = rows.map(row => {
                const cells = Array.from(row.querySelectorAll('td:not(:last-child)'));
                return cells.map(cell => {
                    const links = cell.querySelectorAll('a');
                    if (links.length > 0) {
                        return Array.from(links).map(link => link.textContent.trim()).join(', ');
                    }
                    const badge = cell.querySelector('.status-badge');
                    if (badge) {
                        return badge.textContent.trim();
                    }
                    return cell.textContent.trim();
                });
            }).filter(row => row.length > 0);
            if (data.length === 0) {
                showNotification('Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ú©ÙˆØ¦ÛŒ ÚˆÛŒÙ¹Ø§ Ù†ÛÛŒÚº!', 'info');
                return;
            }
            if (format === 'excel') {
                const ws_data = [headers, ...data];
                const ws = XLSX.utils.aoa_to_sheet(ws_data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                XLSX.writeFile(wb, `${tableId}.xlsx`);
                showNotification('Ø§ÛŒÚ©Ø³Ù„ ÙØ§Ø¦Ù„ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø± Ø¯ÛŒ Ú¯Ø¦ÛŒ!', 'success');
            } else if (format === 'image') {
                showNotification('ØªØµÙˆÛŒØ± ØªÛŒØ§Ø± Ú©ÛŒ Ø¬Ø§ Ø±ÛÛŒ ÛÛ’...', 'info');
                const moduleSection = table.closest('.module-section');
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = moduleSection.offsetWidth + 'px';
                tempDiv.style.padding = '20px';
                tempDiv.style.backgroundColor = 'white';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.textAlign = 'right';
                tempDiv.style.fontFamily = 'Calibri, "Noto Nastaliq Urdu", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
                tempDiv.innerHTML = `
                    <h2 style="text-align: center; color: black; border-bottom: 1px solid #ccc; padding-bottom: 10px;">${moduleSection.querySelector('h2').textContent}</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background-color: #f2f2f2; font-weight: bold; color: black;">
                                ${headers.map(h => `<th style="border: 1px solid #ccc; padding: 8px; text-align: right; background-color: #f2f2f2;">${h}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(row => `
                                <tr>
                                    ${row.map(cell => `<td style="border: 1px solid #ccc; padding: 8px; text-align: right;">${cell}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                document.body.appendChild(tempDiv);
                html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: null
                }).then(canvas => {
                    const image = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = image;
                    link.download = `${tableId}.png`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    document.body.removeChild(tempDiv);
                    showNotification('ØªØµÙˆÛŒØ± Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø± Ø¯ÛŒ Ú¯Ø¦ÛŒ!', 'success');
                }).catch(error => {
                    console.error('Error exporting image:', error);
                    showNotification('ØªØµÙˆÛŒØ± Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ', 'error');
                    document.body.removeChild(tempDiv);
                });
            }
        };
        window.printTable = (tableId) => {
            const printContent = document.getElementById(tableId).closest('.module-section').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
            <!DOCTYPE html>
            <html dir="rtl" lang="ur">
            <head>
                <meta charset="utf-8">
                <title>Ù¾Ø±Ù†Ù¹ ${document.getElementById(tableId).closest('.module-section').querySelector('h2').textContent}</title>
                <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&display=swap">
                <style>
                    body {
                        font-family: Calibri, 'Noto Nastaliq Urdu', Arial, sans-serif;
                        direction: rtl;
                        text-align: right;
                        margin: 20px;
                        font-size: 11pt;
                        line-height: 1.6;
                        color: #333;
                    }
                    h2 {
                        text-align: center;
                        font-size: 20pt;
                        margin-bottom: 20px;
                        color: #007bff;
                        border-bottom: 2px solid #eee;
                        padding-bottom: 10px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 20px;
                    }
                    th, td {
                        border: 1px solid #ccc;
                        padding: 8px;
                        text-align: right;
                        vertical-align: top;
                    }
                    th {
                        background-color: #f2f2f2;
                        font-weight: bold;
                        color: #007bff;
                    }
                    a {
                        color: #007bff;
                        text-decoration: none;
                    }
                    .status-badge {
                        display: inline-block;
                        padding: 3px 8px;
                        border-radius: 10px;
                        font-size: 0.85em;
                        font-weight: bold;
                        color: white;
                        text-align: center;
                        white-space: nowrap;
                    }
                    .status-badge.complete, .status-badge.Ù…Ù†Ø¸ÙˆØ± Ø´Ø¯Û { background-color: #28a745; }
                    .status-badge.pending, .status-badge.Ø²ÛŒØ± Ø§Ù„ØªÙˆØ§ { background-color: #ffc107; color: #333; }
                    .status-badge.urgent { background-color: #dc3545; }
                    .status-badge.info { background-color: #17a2b8; }
                    .status-badge.rejected, .status-badge.Ù…Ø³ØªØ±Ø¯ Ø´Ø¯Û { background-color: #dc3545; }
                    @page {
                        size: A4 landscape;
                        margin: 1.5cm;
                    }
                </style>
            </head>
            <body>
                ${printContent}
                <script>
                    window.onload = function() {
                        window.print();
                        window.onafterprint = function() {
                            window.close();
                        };
                    };
                <\/script>
            </body>
            </html>
        `);
            printWindow.document.close();
        };
        document.getElementById('requestNotificationPermission').addEventListener('click', () => {
            if (!('Notification' in window)) {
                showNotification('ÛŒÛ Ø¨Ø±Ø§Ø¤Ø²Ø± Ù†ÙˆÙ¹ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©Ùˆ Ø³Ù¾ÙˆØ±Ù¹ Ù†ÛÛŒÚº Ú©Ø±ØªØ§Û”', 'error');
                return;
            }
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    showNotification('Ù†ÙˆÙ¹ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©ÛŒ Ø§Ø¬Ø§Ø²Øª Ø¯Û’ Ø¯ÛŒ Ú¯Ø¦ÛŒ!', 'success');
                    new Notification('Ø¯ÙØªØ± Ù…Ù†Ø¸Ù…', {
                        body: 'Ù†ÙˆÙ¹ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ú©Ø§Ù… Ú©Ø± Ø±ÛØ§ ÛÛ’!',
                        icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¢</text></svg>'
                    });
                } else {
                    showNotification('Ù†ÙˆÙ¹ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©ÛŒ Ø§Ø¬Ø§Ø²Øª Ù†ÛÛŒÚº Ø¯ÛŒ Ú¯Ø¦ÛŒ!', 'error');
                }
            });
        });
        async function checkRemindersAndNotify() {
            if (!('Notification' in window) || Notification.permission !== 'granted') return;
            const reminders = await getAllData('reminders');
            const now = new Date();
            const todayDate = now.toISOString().split('T')[0];
            const currentTime = now.toTimeString().split(' ')[0].substring(0, 5);
            reminders.forEach(reminder => {
                if (reminder.reminderDate === todayDate) {
                    if (reminder.reminderType === 'Ø§Ù„Ø§Ø±Ù…' && reminder.reminderTime && reminder.reminderTime === currentTime) {
                        new Notification(`ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒ: ${reminder.reminderTitle}`, {
                            body: reminder.reminderDetails,
                            icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â°</text></svg>'
                        });
                        showNotification(`ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒ: ${reminder.reminderTitle}`, 'urgent');
                    } else if (reminder.reminderType === 'ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±' && !reminder.reminderTime) {
                        new Notification(`ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒ (ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±): ${reminder.reminderTitle}`, {
                            body: reminder.reminderDetails,
                            icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“…</text></svg>'
                        });
                        showNotification(`ÛŒØ§Ø¯ Ø¯ÛØ§Ù†ÛŒ (ØªØ§Ø±ÛŒØ® ÙˆØ§Ø±): ${reminder.reminderTitle}`, 'info');
                    }
                }
            });
        }
        setInterval(checkRemindersAndNotify, 60000);
        openDB().then(async () => {
            const tasks = await getAllData('tasks');
            if (tasks.length === 0) {
                await addSampleData();
            } else {
                loadAllTables();
            }
        });
        window.editEntry = editEntry;
        window.deleteEntry = deleteEntry;
        window.filterAndSort = filterAndSort;
        window.backupData = backupData;
        window.restoreData = restoreData;
        window.displayFilePreviews = displayFilePreviews;
        window.removeFileFromFormPreview = removeFileFromFormPreview;
        window.showNotification = showNotification;
    </script>

    <script>
        document.querySelectorAll('*').forEach(element => {
            const currentSize = window.getComputedStyle(element).fontSize;
            const currentSizeNum = parseFloat(currentSize);
            element.style.fontSize = `${currentSizeNum + 1}px`;
        });
    </script>
    <script type="module">
        import { Workbox } from 'https://storage.googleapis.com/workbox-cdn/releases/7.0.0/workbox-window.prod.mjs';

        const swUrl = './sw.js';
        const wb = new Workbox(swUrl);

        // This event fires when a new service worker has installed but is waiting to activate.
        wb.addEventListener('waiting', (event) => {
            console.log('A new service worker is waiting to activate.');
            // This sends a message to the waiting service worker, telling it to activate.
            wb.messageSW({ type: 'SKIP_WAITING' });
        });

        // This event fires when the new service worker has taken control.
        wb.addEventListener('controlling', (event) => {
            console.log('The new service worker is now in control. Reloading page for updates...');
            window.location.reload();
        });

        // Register the service worker.
        wb.register();
    </script>
</body>

</html>