<!DOCTYPE html>

<html dir="rtl" lang="ur">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="ÿØŸÅÿ™ÿ± ŸÖŸÜÿ∏ŸÖ - ÿ¢Ÿæ ⁄©ÿß ŸÖ⁄©ŸÖŸÑ ÿØŸÅÿ™ÿ±€å ŸÖÿπÿßŸàŸÜ" name="title" />
    <meta
        content="ÿØŸÅÿ™ÿ± ŸÖŸÜÿ∏ŸÖ ÿß€å⁄© ÿ¨ÿßŸÖÿπ Ÿà€åÿ® ÿß€åŸæŸÑ€å⁄©€åÿ¥ŸÜ €Å€í ÿ¨Ÿà ÿ±Ÿàÿ≤ŸÖÿ±€Å ⁄©€í ÿØŸÅÿ™ÿ±€å ÿßŸÖŸàÿ± ÿ¨€åÿ≥€í ⁄©ÿßŸÖÿå €åÿßÿØÿØ€ÅÿßŸÜ€åÿå ŸÖŸÑÿßŸÇÿßÿ™€å⁄∫ÿå Ÿæ€åÿ∫ÿßŸÖÿßÿ™ÿå ÿßŸàÿ± ÿ±ÿßÿ®ÿ∑Ÿà⁄∫ ⁄©ÿß ÿßŸÜÿ™ÿ∏ÿßŸÖ ⁄©ÿ±ÿ™€å €Å€í€î Ÿæÿß⁄©ÿ≥ÿ™ÿßŸÜ ŸÖ€å⁄∫ ÿØŸÅÿ™ÿ±€å ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ⁄©€í ŸÑ€å€í ⁄à€åÿ≤ÿßÿ¶ŸÜ ⁄©€åÿß ⁄Ø€åÿß €Å€í€î"
        name="description" />
    <meta
        content="ÿØŸÅÿ™ÿ± ŸÖŸÜÿ∏ŸÖ, ÿØŸÅÿ™ÿ±€å ÿßŸÜÿ™ÿ∏ÿßŸÖ, Ÿπÿßÿ≥⁄© ŸÖ€åŸÜ€åÿ¨ÿ±, ÿ±€åŸÖÿßÿ¶ŸÜ⁄àÿ± ÿß€åŸæ, ŸÖŸÑÿßŸÇÿßÿ™€å⁄∫, ÿßÿ∑ŸÑÿßÿπÿßÿ™, ÿ±ÿßÿ®ÿ∑€í, ⁄©ÿßÿ±⁄©ÿ±ÿØ⁄Ø€å, ÿ¥€å⁄àŸàŸÑ, Ÿæ€åÿ∫ÿßŸÖÿßÿ™, ÿÆÿ∑Ÿàÿ∑, ŸÖÿ∑ÿßŸÑÿ®ÿßÿ™, Ÿæÿß⁄©ÿ≥ÿ™ÿßŸÜ, €åÿ≥€åŸÜ ÿßŸÑŸÑ€Å"
        name="keywords" />
    <meta content="Yasin Ullah, Pakistan" name="author" />
    <title>ÿØŸÅÿ™ÿ± ŸÖŸÜÿ∏ŸÖ</title>
    <link
        href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;üè¢&lt;/text&gt;&lt;/svg&gt;"
        rel="icon" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400..700&display=swap');

        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --accent-color: #28a745;
            --delete-color: #dc3545;
            --edit-color: #ffc107;
            --card-bg: #ffffff;
            --border-color: #e9ecef;
            --input-bg: #ffffff;
            --table-even-bg: #f8f9fa;
            --table-header-bg: var(--primary-color);
            --table-header-text: white;
            --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            --notification-success-bg: #28a745;
            --notification-info-bg: #17a2b8;
            --notification-error-bg: #dc3545;
            --notification-text: white;
            --button-hover-darken: 10%;
            --border-radius: 0.375rem;
            --font-size-base: 0.9rem;
            --font-size-lg: 1.1rem;
            --font-size-sm: 0.75rem;
        }

        body.dark-theme {
            --bg-color: #212529;
            --text-color: #f8f9fa;
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --accent-color: #198754;
            --delete-color: #dc3545;
            --edit-color: #ffc107;
            --card-bg: #343a40;
            --border-color: #495057;
            --input-bg: #495057;
            --table-even-bg: #343a40;
            --table-header-bg: var(--primary-color);
            --table-header-text: white;
            --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.2);
            --notification-success-bg: #198754;
            --notification-info-bg: #0dcaf0;
            --notification-error-bg: #dc3545;
        }

        body {
            font-family: Calibri, 'Noto Nastaliq Urdu', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.5;
            direction: rtl;
            text-align: right;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            font-size: var(--font-size-base);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        .container {
            display: flex;
            flex: 1;
            padding: 0.8rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            gap: 0.8rem;
        }

        .sidebar {
            width: 200px;
            background-color: var(--card-bg);
            padding: 0.8rem;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            flex-shrink: 0;
            position: sticky;
            top: 0.8rem;
            height: calc(100vh - 1.6rem);
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar::-webkit-scrollbar {
            width: 5px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar h2 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            line-height: 1.2;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.6rem;
            font-weight: 600;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 0.4rem;
        }

        .sidebar ul li button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 0.5rem 0.7rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            text-align: right;
            font-family: inherit;
            gap: 0.4rem;
        }

        .sidebar ul li button:hover {
            background-color: color-mix(in srgb, var(--primary-color) var(--button-hover-darken), black);
            transform: translateY(-1px);
            box-shadow: 0 0.15rem 0.3rem rgba(0, 0, 0, 0.1);
        }

        .sidebar ul li button.active {
            background-color: var(--accent-color);
            font-weight: bold;
            box-shadow: 0 0.075rem 0.15rem rgba(0, 0, 0, 0.15);
        }

        .main-content {
            flex-grow: 1;
            background-color: var(--card-bg);
            padding: 1.2rem;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            overflow-x: hidden;
        }

        .module-section {
            display: none;
        }

        .module-section.active {
            display: block;
        }

        h1,
        h2,
        h3 {
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.6rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        h2 {
            font-size: 1.5rem;
        }

        h3 {
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 0.8rem;
        }

        label {
            display: block;
            margin-bottom: 0.2rem;
            font-weight: 500;
            font-size: var(--font-size-base);
        }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="email"],
        input[type="tel"],
        textarea,
        select {
            width: calc(100% - 1.2rem);
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--text-color);
            font-family: inherit;
            font-size: var(--font-size-base);
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.15rem rgba(0, 123, 255, 0.25);
            outline: none;
        }

        textarea {
            resize: vertical;
            min-height: 50px;
        }

        button {
            padding: 0.5rem 0.8rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: var(--font-size-base);
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            font-family: inherit;
            margin-left: 0.4rem;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        button i {
            font-size: 0.8em;
        }

        button:hover {
            filter: brightness(90%);
            transform: translateY(-1px);
            box-shadow: 0 0.1rem 0.2rem rgba(0, 0, 0, 0.1);
        }

        button:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .delete-btn {
            background-color: var(--delete-color);
        }

        .edit-btn {
            background-color: var(--edit-color);
            color: var(--text-color);
        }

        .whatsapp-btn {
            background-color: #25D366;
        }

        .whatsapp-btn:hover {
            background-color: #1DA851;
        }

        .sms-btn {
            background-color: #4CAF50;
        }

        .sms-btn:hover {
            background-color: #45a049;
        }

        .action-buttons {
            margin-top: 1.2rem;
            text-align: left;
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            justify-content: flex-end;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.2rem;
            font-size: var(--font-size-base);
            table-layout: auto;
        }

        table th,
        table td {
            border: 1px solid var(--border-color);
            padding: 0.5rem;
            text-align: right;
            vertical-align: top;
        }

        table th {
            background-color: var(--table-header-bg);
            color: var(--table-header-text);
            white-space: nowrap;
            font-weight: 600;
        }

        table tbody tr:nth-child(even) {
            background-color: var(--table-even-bg);
        }

        table tbody tr:hover {
            background-color: color-mix(in srgb, var(--table-even-bg) 10%, var(--border-color));
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .controls input[type="text"],
        .controls input[type="date"],
        .controls select {
            width: auto;
            min-width: 100px;
            flex-grow: 1;
            margin-left: 0;
            padding: 0.4rem;
            font-size: var(--font-size-sm);
        }

        .controls button {
            padding: 0.4rem 0.7rem;
            font-size: var(--font-size-sm);
        }

        .export-options {
            margin-bottom: 0.8rem;
            text-align: left;
            display: flex;
            gap: 0.4rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .export-options button {
            margin-left: 0;
            padding: 0.4rem 0.7rem;
            font-size: var(--font-size-sm);
        }

        .theme-switcher {
            position: fixed;
            top: 0.8rem;
            left: 0.8rem;
            z-index: 1000;
            display: flex;
            gap: 0.4rem;
        }

        .theme-switcher button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.4rem 0.7rem;
            border-radius: var(--border-radius);
            font-size: var(--font-size-sm);
            margin-left: 0;
        }

        .theme-switcher button:hover {
            background-color: color-mix(in srgb, var(--secondary-color) 10%, black);
        }

        .file-upload-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-top: 0.4rem;
            align-items: center;
        }

        .file-upload-preview div {
            border: 1px solid var(--border-color);
            padding: 0.2rem;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 0.2rem;
            background-color: var(--input-bg);
            font-size: var(--font-size-sm);
        }

        .file-upload-preview img {
            max-width: 25px;
            max-height: 25px;
            object-fit: contain;
            border-radius: 3px;
        }

        .file-upload-preview button {
            background-color: var(--delete-color);
            color: white;
            border: none;
            padding: 0.1rem 0.3rem;
            font-size: 0.6em;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 0;
            min-width: unset;
        }

        .hidden {
            display: none;
        }

        .notification {
            position: fixed;
            top: 0.8rem;
            right: 0.8rem;
            background-color: var(--notification-info-bg);
            color: var(--notification-text);
            padding: 0.7rem 0.9rem;
            border-radius: var(--border-radius);
            box-shadow: 0 0.15rem 0.4rem rgba(0, 0, 0, 0.2);
            z-index: 1001;
            display: none;
            font-size: var(--font-size-base);
            font-family: inherit;
            animation: fadeIn 0.5s;
            max-width: 250px;
            text-align: center;
        }

        .notification.show {
            display: block;
        }

        .notification.hide {
            animation: fadeOut 0.5s forwards;
        }

        .notification.success {
            background-color: var(--notification-success-bg);
        }

        .notification.error {
            background-color: var(--notification-error-bg);
        }

        .notification.info {
            background-color: var(--notification-info-bg);
        }

        .notification.urgent {
            background-color: var(--delete-color);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-8px);
            }
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.8rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            text-align: center;
            white-space: nowrap;
        }

        .status-badge.complete,
        .status-badge.ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å {
            background-color: #28a745;
        }

        .status-badge.pending,
        .status-badge.ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß {
            background-color: #ffc107;
            color: #333;
        }

        .status-badge.urgent {
            background-color: #dc3545;
        }

        .status-badge.info {
            background-color: #17a2b8;
        }

        .status-badge.rejected,
        .status-badge.ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å {
            background-color: #dc3545;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                padding: 0.4rem;
                gap: 0.4rem;
            }

            .sidebar {
                width: 100%;
                margin-left: 0;
                margin-bottom: 0.8rem;
                padding: 0.6rem;
                position: static;
                height: auto;
                border-radius: 0;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }

            .sidebar h2 {
                display: none;
            }

            .sidebar ul {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                gap: 0.3rem;
            }

            .sidebar ul li {
                margin-bottom: 0;
            }

            .sidebar ul li button {
                padding: 0.5rem 0.4rem;
                font-size: 0.8rem;
                text-align: center;
                flex-direction: column;
                gap: 0.15rem;
            }

            .sidebar ul li button i {
                font-size: 0.9rem;
            }

            .main-content {
                padding: 0.8rem;
                border-radius: var(--border-radius);
            }

            h1,
            h2,
            h3 {
                font-size: 1.2rem;
                margin-bottom: 0.8rem;
            }

            input[type="text"],
            input[type="date"],
            input[type="time"],
            input[type="email"],
            input[type="tel"],
            textarea,
            select {
                width: 100%;
                padding: 0.5rem;
                font-size: 0.85rem;
            }

            .action-buttons,
            .controls,
            .export-options {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }

            .action-buttons button,
            .controls button,
            .export-options button {
                width: 100%;
                margin-left: 0;
                padding: 0.6rem 0.8rem;
                font-size: var(--font-size-base);
            }

            .controls input,
            .controls select {
                min-width: unset;
                width: 100%;
            }

            table,
            table tbody,
            table tr,
            table td,
            table th {
                display: block;
                width: 100%;
            }

            table thead {
                display: none;
            }

            table tr {
                margin-bottom: 0.6rem;
                border: 1px solid var(--border-color);
                border-radius: var(--border-radius);
                overflow: hidden;
            }

            table td {
                border: none;
                border-bottom: 1px solid var(--border-color);
                position: relative;
                padding-left: 40%;
                text-align: right;
                word-break: break-word;
                font-size: 0.85rem;
                display: ruby-text;
            }

            table td:last-child {
                border-bottom: 0;
            }

            table td::before {
                content: attr(data-label);
                position: absolute;
                right: 0.5rem;
                width: 35%;
                padding-left: 0.4rem;
                font-weight: 600;
                text-align: right;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                color: var(--primary-color);
            }

            #tasksTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #tasksTable td:nth-of-type(2)::before {
                content: "⁄©ÿßŸÖ ⁄©ÿß ÿπŸÜŸàÿßŸÜ:";
            }

            #tasksTable td:nth-of-type(3)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #tasksTable td:nth-of-type(4)::before {
                content: "ÿß€ÅŸÖ€åÿ™:";
            }

            #tasksTable td:nth-of-type(5)::before {
                content: "ÿ≠ÿßŸÑÿ™:";
            }

            #tasksTable td:nth-of-type(6)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #tasksTable td:nth-of-type(7)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #remindersTable td:nth-of-type(1)::before {
                content: "ÿπŸÜŸàÿßŸÜ:";
            }

            #remindersTable td:nth-of-type(2)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #remindersTable td:nth-of-type(3)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #remindersTable td:nth-of-type(4)::before {
                content: "ŸàŸÇÿ™:";
            }

            #remindersTable td:nth-of-type(5)::before {
                content: "ŸÜŸàÿπ€åÿ™:";
            }

            #remindersTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #urgentTasksTable td:nth-of-type(1)::before {
                content: "ÿπŸÜŸàÿßŸÜ:";
            }

            #urgentTasksTable td:nth-of-type(2)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #urgentTasksTable td:nth-of-type(3)::before {
                content: "ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ:";
            }

            #urgentTasksTable td:nth-of-type(4)::before {
                content: "ÿ¢ÿÆÿ±€å ŸàŸÇÿ™:";
            }

            #urgentTasksTable td:nth-of-type(5)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #meetingsTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #meetingsTable td:nth-of-type(2)::before {
                content: "ŸàŸÇÿ™:";
            }

            #meetingsTable td:nth-of-type(3)::before {
                content: "ÿ¥ÿÆÿµ€åÿßÿ™:";
            }

            #meetingsTable td:nth-of-type(4)::before {
                content: "ÿ¨⁄Ø€Å:";
            }

            #meetingsTable td:nth-of-type(5)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #meetingsTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #notificationsTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #notificationsTable td:nth-of-type(2)::before {
                content: "ÿπŸÜŸàÿßŸÜ:";
            }

            #notificationsTable td:nth-of-type(3)::before {
                content: "ŸÜŸàÿπ€åÿ™:";
            }

            #notificationsTable td:nth-of-type(4)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #notificationsTable td:nth-of-type(5)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #notificationsTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #contactsTable td:nth-of-type(1)::before {
                content: "ŸÜÿßŸÖ/ÿ™ŸÜÿ∏€åŸÖ:";
            }

            #contactsTable td:nth-of-type(2)::before {
                content: "ŸÅŸàŸÜ:";
            }

            #contactsTable td:nth-of-type(3)::before {
                content: "ÿß€å ŸÖ€åŸÑ:";
            }

            #contactsTable td:nth-of-type(4)::before {
                content: "ÿ±ÿ¥ÿ™€Å/ŸÖÿπŸÖŸàŸÑ:";
            }

            #contactsTable td:nth-of-type(5)::before {
                content: "Ÿæÿ™€Å:";
            }

            #contactsTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #performanceTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #performanceTable td:nth-of-type(2)::before {
                content: "ÿπŸÜŸàÿßŸÜ:";
            }

            #performanceTable td:nth-of-type(3)::before {
                content: "ŸÖÿØÿ™:";
            }

            #performanceTable td:nth-of-type(4)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #performanceTable td:nth-of-type(5)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #performanceTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #schedulesTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #schedulesTable td:nth-of-type(2)::before {
                content: "ŸàŸÇÿ™:";
            }

            #schedulesTable td:nth-of-type(3)::before {
                content: "Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖ ⁄©ÿß ŸÜÿßŸÖ:";
            }

            #schedulesTable td:nth-of-type(4)::before {
                content: "ŸÜŸàÿπ€åÿ™:";
            }

            #schedulesTable td:nth-of-type(5)::before {
                content: "ÿ¨⁄Ø€Å:";
            }

            #schedulesTable td:nth-of-type(6)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #schedulesTable td:nth-of-type(7)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #messagesTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #messagesTable td:nth-of-type(2)::before {
                content: "ŸÜŸàÿπ€åÿ™:";
            }

            #messagesTable td:nth-of-type(3)::before {
                content: "ÿ®⁄æ€åÿ¨ŸÜ€í ŸàÿßŸÑÿß/ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å:";
            }

            #messagesTable td:nth-of-type(4)::before {
                content: "ŸÖÿ∂ŸÖŸàŸÜ:";
            }

            #messagesTable td:nth-of-type(5)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #messagesTable td:nth-of-type(6)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #messagesTable td:nth-of-type(7)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #lettersTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß:";
            }

            #lettersTable td:nth-of-type(2)::before {
                content: "ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å:";
            }

            #lettersTable td:nth-of-type(3)::before {
                content: "ŸÖÿ∂ŸÖŸàŸÜ:";
            }

            #lettersTable td:nth-of-type(4)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #lettersTable td:nth-of-type(5)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #lettersTable td:nth-of-type(6)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            #demandsTable td:nth-of-type(1)::before {
                content: "ÿ™ÿßÿ±€åÿÆ:";
            }

            #demandsTable td:nth-of-type(2)::before {
                content: "ÿπŸÜŸàÿßŸÜ:";
            }

            #demandsTable td:nth-of-type(3)::before {
                content: "ŸÖÿ∑ÿßŸÑÿ®€Å ⁄©ÿ±ŸÜ€í ŸàÿßŸÑÿß:";
            }

            #demandsTable td:nth-of-type(4)::before {
                content: "ÿ™ŸÅÿµ€åŸÑ:";
            }

            #demandsTable td:nth-of-type(5)::before {
                content: "ÿ≠ÿßŸÑÿ™:";
            }

            #demandsTable td:nth-of-type(6)::before {
                content: "ŸÅÿßÿ¶ŸÑ€å⁄∫:";
            }

            #demandsTable td:nth-of-type(7)::before {
                content: "ÿ¢Ÿæÿ¥ŸÜÿ≤:";
            }

            .theme-switcher {
                position: static;
                text-align: left;
                margin-bottom: 0.5rem;
                padding: 0 0.4rem;
                justify-content: flex-start;
                flex-wrap: wrap;
            }
        }

        @media print {
            body {
                background-color: white;
                font-family: Calibri, 'Noto Nastaliq Urdu', Arial, sans-serif;
                color: black;
                font-size: 9pt;
                line-height: 1.3;
            }

            .container {
                display: block;
                padding: 0;
                max-width: 100%;
                margin: 0;
            }

            .sidebar,
            .controls,
            .action-buttons,
            .theme-switcher,
            .export-options button:not(.print-btn),
            input[type="file"],
            .notification {
                display: none !important;
            }

            .main-content {
                box-shadow: none;
                padding: 0;
                margin: 0;
                width: 100%;
            }

            table {
                border: 1px solid black;
                page-break-inside: auto;
            }

            table tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }

            table th,
            table td {
                border: 1px solid black;
                padding: 5px;
                font-size: 8pt;
                color: black;
            }

            table th {
                background-color: #e0e0e0 !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }

            h1,
            h2,
            h3 {
                color: black;
                border-bottom: 1px solid #ccc;
                text-align: center;
                font-size: 14pt;
                margin-bottom: 8px;
            }

            input,
            textarea,
            select {
                border: none !important;
                padding: 0 !important;
                background-color: transparent !important;
                box-shadow: none !important;
                width: auto !important;
                display: inline-block;
                min-width: 70px;
                color: black !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }

            .form-group label {
                display: inline-block;
                margin-left: 6px;
                font-weight: bold;
            }

            .form-group {
                margin-bottom: 2px;
            }

            .file-upload-preview {
                display: none !important;
            }

            td a {
                text-decoration: none;
                color: black;
            }
        }
    </style>
    <link href="manifest.json" rel="manifest" />
</head>

<body>
    <div class="theme-switcher">
        <button id="themeToggle"><i class="fas fa-adjust"></i> ÿ™⁄æ€åŸÖ ÿ®ÿØŸÑ€å⁄∫</button>
        <button id="requestNotificationPermission"><i class="fas fa-bell"></i> ŸÜŸàŸπ€åŸÅ€å⁄©€åÿ¥ŸÜ ⁄©€å ÿßÿ¨ÿßÿ≤ÿ™ ÿØ€å⁄∫</button>
    </div>
    <div class="notification" id="notification"></div>
    <div class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><button data-module="tasks"><i class="fas fa-tasks"></i> ⁄©ÿßŸÖ</button></li>
                    <li><button data-module="reminders"><i class="fas fa-bell"></i> ŸÖÿÆÿ™ŸÑŸÅ ÿßŸÖŸàÿ± ⁄©€å €åÿßÿØ ÿØ€ÅÿßŸÜ€åÿß⁄∫</button>
                    </li>
                    <li><button data-module="urgentTasks"><i class="fas fa-exclamation-triangle"></i> ŸÅŸàÿ±€å ⁄©ÿ±ŸÜ€í ⁄©€í
                            ⁄©ÿßŸÖ</button></li>
                    <li><button data-module="meetings"><i class="fas fa-handshake"></i> ŸÖŸÑÿßŸÇÿßÿ™€å⁄∫</button></li>
                    <li><button data-module="notifications"><i class="fas fa-info-circle"></i> ÿßÿ∑ŸÑÿßÿπÿßÿ™</button></li>
                    <li><button data-module="contacts"><i class="fas fa-address-book"></i> ÿ±ÿßÿ®ÿ∑€í</button></li>
                    <li><button data-module="performance"><i class="fas fa-chart-line"></i> ⁄©ÿßÿ±⁄Øÿ≤ÿßÿ±€åÿß⁄∫</button></li>
                    <li><button data-module="schedules"><i class="fas fa-calendar-alt"></i> Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖŸà⁄∫ ⁄©ÿß ÿ¥€å⁄àŸàŸÑ</button>
                    </li>
                    <li><button data-module="messages"><i class="fas fa-envelope"></i> Ÿæ€åÿ∫ÿßŸÖÿßÿ™</button></li>
                    <li><button data-module="letters"><i class="fas fa-file-alt"></i> ÿÆÿ∑Ÿàÿ∑</button></li>
                    <li><button data-module="demands"><i class="fas fa-money-bill-wave"></i> ŸÖÿ∑ÿßŸÑÿ®ÿßÿ™</button></li>
                    <li><button data-module="backupRestore"><i class="fas fa-cloud-download-alt"></i> ÿ®€å⁄© ÿßŸæ / ÿ±€å
                            ÿ≥ŸπŸàÿ±</button></li>
                </ul>
            </nav>
        </aside>
        <main class="main-content">
            <section class="module-section active" id="tasks">
                <h2><i class="fas fa-tasks"></i> ⁄©ÿßŸÖ ‚Äì ÿ±Ÿàÿ≤ŸÖÿ±€Å €åÿß ÿÆÿßÿµ ŸÜŸàÿπ€åÿ™ ⁄©€í ⁄©ÿßŸÖ</h2>
                <form id="taskForm">
                    <input id="taskId" type="hidden" />
                    <div class="form-group">
                        <label for="taskName">⁄©ÿßŸÖ ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="taskName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="taskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="taskDueDate">ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="taskDueDate" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">ÿß€ÅŸÖ€åÿ™:</label>
                        <select id="taskPriority">
                            <option value="ŸÖÿπŸÖŸàŸÑ€å">ŸÖÿπŸÖŸàŸÑ€å</option>
                            <option value="ÿßŸàÿ≥ÿ∑">ÿßŸàÿ≥ÿ∑</option>
                            <option value="ÿß€ÅŸÖ">ÿß€ÅŸÖ</option>
                            <option value="ÿßŸÜÿ™€Åÿßÿ¶€å ÿß€ÅŸÖ">ÿßŸÜÿ™€Åÿßÿ¶€å ÿß€ÅŸÖ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskStatus">ÿ≠ÿßŸÑÿ™:</label>
                        <select id="taskStatus">
                            <option value="ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß">ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß</option>
                            <option value="ŸÖ⁄©ŸÖŸÑ">ŸÖ⁄©ŸÖŸÑ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="taskFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="taskFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearTaskForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-list"></i> ⁄©ÿßŸÖŸà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="taskSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="taskFilterDate" type="date" />
                    <select id="taskSortBy">
                        <option value="dueDate">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dueDateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="priority">ÿß€ÅŸÖ€åÿ™</option>
                        <option value="status">ÿ≠ÿßŸÑÿ™</option>
                    </select>
                    <button onclick="filterAndSort('tasks')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('tasksTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('tasksTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('tasksTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="tasksTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>⁄©ÿßŸÖ ⁄©ÿß ÿπŸÜŸàÿßŸÜ</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿß€ÅŸÖ€åÿ™</th>
                                <th>ÿ≠ÿßŸÑÿ™</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="reminders">
                <h2><i class="fas fa-bell"></i> ŸÖÿÆÿ™ŸÑŸÅ ÿßŸÖŸàÿ± ⁄©€å €åÿßÿØ ÿØ€ÅÿßŸÜ€åÿß⁄∫ ‚Äì ŸÜŸàŸπÿ≥ÿå ÿßŸÑÿßÿ±ŸÖÿå €åÿß ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± €åÿßÿØÿØ€ÅÿßŸÜ€å</h2>
                <form id="reminderForm">
                    <input id="reminderId" type="hidden" />
                    <div class="form-group">
                        <label for="reminderTitle">€åÿßÿØ ÿØ€ÅÿßŸÜ€å ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="reminderTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="reminderDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="reminderDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reminderDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="reminderDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="reminderTime">ŸàŸÇÿ™:</label>
                        <input id="reminderTime" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="reminderType">ŸÜŸàÿπ€åÿ™:</label>
                        <select id="reminderType">
                            <option value="ŸÜŸàŸπÿ≥">ŸÜŸàŸπÿ≥</option>
                            <option value="ÿßŸÑÿßÿ±ŸÖ">ÿßŸÑÿßÿ±ŸÖ</option>
                            <option value="ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±</option>
                        </select>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearReminderForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-alt"></i> €åÿßÿØ ÿØ€ÅÿßŸÜ€åŸà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="reminderSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="reminderFilterDate" type="date" />
                    <select id="reminderSortBy">
                        <option value="dateTime">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateTimeDesc">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="type">ŸÜŸàÿπ€åÿ™</option>
                    </select>
                    <button onclick="filterAndSort('reminders')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('remindersTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('remindersTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('remindersTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="remindersTable">
                        <thead>
                            <tr>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ŸàŸÇÿ™</th>
                                <th>ŸÜŸàÿπ€åÿ™</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="urgentTasks">
                <h2><i class="fas fa-exclamation-triangle"></i> ŸÅŸàÿ±€å ⁄©ÿ±ŸÜ€í ⁄©€í ⁄©ÿßŸÖ ‚Äì ÿß€ÅŸÖÿå ŸÅŸàÿ±€å ŸÜŸàÿπ€åÿ™ ⁄©€í ÿßŸÖŸàÿ±</h2>
                <form id="urgentTaskForm">
                    <input id="urgentTaskId" type="hidden" />
                    <div class="form-group">
                        <label for="urgentTaskName">ŸÅŸàÿ±€å ⁄©ÿßŸÖ ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="urgentTaskName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDescription">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="urgentTaskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDueDate">ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="urgentTaskDueDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="urgentTaskDueTime">ÿ¢ÿÆÿ±€å ŸàŸÇÿ™:</label>
                        <input id="urgentTaskDueTime" type="time" />
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearUrgentTaskForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-clipboard-list"></i> ŸÅŸàÿ±€å ⁄©ÿßŸÖŸà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="urgentTaskSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="urgentTaskFilterDate" type="date" />
                    <select id="urgentTaskSortBy">
                        <option value="dueDate">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dueDateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                    </select>
                    <button onclick="filterAndSort('urgentTasks')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ®
                        ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('urgentTasksTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('urgentTasksTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('urgentTasksTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ±
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="urgentTasksTable">
                        <thead>
                            <tr>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ÿ¢ÿÆÿ±€å ŸàŸÇÿ™</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="meetings">
                <h2><i class="fas fa-handshake"></i> ŸÖŸÑÿßŸÇÿßÿ™€å⁄∫ ‚Äì ÿ¥ÿÆÿµ€åÿßÿ™ÿå ŸàŸÇÿ™ÿå ÿ¨⁄Ø€Åÿå ÿ™ŸÅÿµ€åŸÑ</h2>
                <form id="meetingForm">
                    <input id="meetingId" type="hidden" />
                    <div class="form-group">
                        <label for="meetingPerson">ÿ¥ÿÆÿµ€åÿßÿ™:</label>
                        <input id="meetingPerson" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="meetingDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="meetingDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="meetingTime">ŸàŸÇÿ™:</label>
                        <input id="meetingTime" required="" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="meetingLocation">ÿ¨⁄Ø€Å:</label>
                        <input id="meetingLocation" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="meetingDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="meetingDetails" rows="3"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearMeetingForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-calendar-check"></i> ŸÖŸÑÿßŸÇÿßÿ™Ÿà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="meetingSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="meetingFilterDate" type="date" />
                    <select id="meetingSortBy">
                        <option value="dateTime">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateTimeDesc">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                    </select>
                    <button onclick="filterAndSort('meetings')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('meetingsTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('meetingsTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('meetingsTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="meetingsTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ŸàŸÇÿ™</th>
                                <th>ÿ¥ÿÆÿµ€åÿßÿ™</th>
                                <th>ÿ¨⁄Ø€Å</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="notifications">
                <h2><i class="fas fa-info-circle"></i> ÿßÿ∑ŸÑÿßÿπÿßÿ™ ‚Äì ÿØÿßÿÆŸÑ€å Ÿà ÿÆÿßÿ±ÿ¨€å ÿßÿ∑ŸÑÿßÿπ ŸÜÿßŸÖ€í</h2>
                <form id="notificationForm">
                    <input id="notificationId" type="hidden" />
                    <div class="form-group">
                        <label for="notificationTitle">ÿßÿ∑ŸÑÿßÿπ ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="notificationTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="notificationType">ŸÜŸàÿπ€åÿ™:</label>
                        <select id="notificationType">
                            <option value="ÿØÿßÿÆŸÑ€å">ÿØÿßÿÆŸÑ€å</option>
                            <option value="ÿÆÿßÿ±ÿ¨€å">ÿÆÿßÿ±ÿ¨€å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notificationDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="notificationDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="notificationDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="notificationDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="notificationFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="notificationFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="notificationFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearNotificationForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-bullhorn"></i> ÿßÿ∑ŸÑÿßÿπÿßÿ™ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="notificationSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="notificationFilterDate" type="date" />
                    <select id="notificationSortBy">
                        <option value="date">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="type">ŸÜŸàÿπ€åÿ™</option>
                    </select>
                    <button onclick="filterAndSort('notifications')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ®
                        ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('notificationsTable')"><i class="fas fa-print"></i>
                        Ÿæÿ±ŸÜŸπ ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('notificationsTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('notificationsTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ±
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="notificationsTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>ŸÜŸàÿπ€åÿ™</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="contacts">
                <h2><i class="fas fa-address-book"></i> ÿ±ÿßÿ®ÿ∑€í ‚Äì ÿßŸÅÿ±ÿßÿØÿå ÿ™ŸÜÿ∏€åŸÖ€å⁄∫ÿå ŸÅŸàŸÜÿå ÿß€å ŸÖ€åŸÑÿå ÿ±ÿ¥ÿ™€Å</h2>
                <form id="contactForm">
                    <input id="contactId" type="hidden" />
                    <div class="form-group">
                        <label for="contactName">ŸÜÿßŸÖ/ÿ™ŸÜÿ∏€åŸÖ:</label>
                        <input id="contactName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="contactPhone">ŸÅŸàŸÜ:</label>
                        <input id="contactPhone" type="tel" />
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">ÿß€å ŸÖ€åŸÑ:</label>
                        <input id="contactEmail" type="email" />
                    </div>
                    <div class="form-group">
                        <label for="contactRelationship">ÿ±ÿ¥ÿ™€Å/ŸÖÿπŸÖŸàŸÑ:</label>
                        <input id="contactRelationship" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="contactAddress">Ÿæÿ™€Å:</label>
                        <textarea id="contactAddress" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="contactMessage">Ÿæ€åÿ∫ÿßŸÖ:</label>
                        <textarea id="contactMessage" rows="2"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearContactForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-users"></i> ÿ±ÿßÿ®ÿ∑Ÿà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="contactSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <select id="contactSortBy">
                        <option value="name">ŸÜÿßŸÖ (ÿßŸÑŸÅ ÿ™ÿß €å)</option>
                        <option value="nameDesc">ŸÜÿßŸÖ (€å ÿ™ÿß ÿßŸÑŸÅ)</option>
                    </select>
                    <button onclick="filterAndSort('contacts')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('contactsTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('contactsTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('contactsTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="contactsTable">
                        <thead>
                            <tr>
                                <th>ŸÜÿßŸÖ/ÿ™ŸÜÿ∏€åŸÖ</th>
                                <th>ŸÅŸàŸÜ</th>
                                <th>ÿß€å ŸÖ€åŸÑ</th>
                                <th>ÿ±ÿ¥ÿ™€Å/ŸÖÿπŸÖŸàŸÑ</th>
                                <th>Ÿæ€åÿ∫ÿßŸÖ</th>
                                <th>Ÿæÿ™€Å</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="performance">
                <h2><i class="fas fa-chart-line"></i> ⁄©ÿßÿ±⁄Øÿ≤ÿßÿ±€åÿß⁄∫ ‚Äì ŸÖÿß€ÅÿßŸÜ€Åÿå ÿ≥€Å ŸÖÿß€Å€åÿå ÿ≥ÿßŸÑÿßŸÜ€Å ⁄©ÿßÿ±⁄©ÿ±ÿØ⁄Ø€å</h2>
                <form id="performanceForm">
                    <input id="performanceId" type="hidden" />
                    <div class="form-group">
                        <label for="performanceTitle">⁄©ÿßÿ±⁄Øÿ≤ÿßÿ±€å ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="performanceTitle" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="performancePeriod">ŸÖÿØÿ™:</label>
                        <select id="performancePeriod">
                            <option value="ŸÖÿß€ÅÿßŸÜ€Å">ŸÖÿß€ÅÿßŸÜ€Å</option>
                            <option value="ÿ≥€Å ŸÖÿß€Å€å">ÿ≥€Å ŸÖÿß€Å€å</option>
                            <option value="ÿ≥ÿßŸÑÿßŸÜ€Å">ÿ≥ÿßŸÑÿßŸÜ€Å</option>
                            <option value="ÿØ€å⁄Øÿ±">ÿØ€å⁄Øÿ±</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="performanceDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="performanceDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="performanceDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="performanceDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="performanceFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="performanceFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="performanceFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearPerformanceForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-file-invoice"></i> ⁄©ÿßÿ±⁄Øÿ≤ÿßÿ±€åŸà⁄∫ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="performanceSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="performanceFilterDate" type="date" />
                    <select id="performanceSortBy">
                        <option value="date">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="period">ŸÖÿØÿ™</option>
                    </select>
                    <button onclick="filterAndSort('performance')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ®
                        ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('performanceTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('performanceTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('performanceTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ±
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="performanceTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>ŸÖÿØÿ™</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="schedules">
                <h2><i class="fas fa-calendar-alt"></i> Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖŸà⁄∫ ⁄©ÿß ÿ¥€å⁄àŸàŸÑ ‚Äì ÿßÿ¨ÿ™ŸÖÿßÿπÿßÿ™ÿå ŸÖÿ¨ŸÑÿ≥ÿå ÿÆÿ™ŸÖ ÿ®ÿÆÿßÿ±€åÿå ÿØ€å⁄Øÿ±</h2>
                <form id="scheduleForm">
                    <input id="scheduleId" type="hidden" />
                    <div class="form-group">
                        <label for="scheduleName">Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖ ⁄©ÿß ŸÜÿßŸÖ:</label>
                        <input id="scheduleName" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleType">ŸÜŸàÿπ€åÿ™:</label>
                        <input id="scheduleType" placeholder="ÿßÿ¨ÿ™ŸÖÿßÿπÿßÿ™ÿå ŸÖÿ¨ŸÑÿ≥ÿå ÿÆÿ™ŸÖ ÿ®ÿÆÿßÿ±€åÿå ÿØ€å⁄Øÿ±" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="scheduleDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleTime">ŸàŸÇÿ™:</label>
                        <input id="scheduleTime" required="" type="time" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleLocation">ÿ¨⁄Ø€Å:</label>
                        <input id="scheduleLocation" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="scheduleDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="scheduleDetails" rows="3"></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearScheduleForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-ul"></i> Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖŸà⁄∫ ⁄©€í ÿ¥€å⁄àŸàŸÑ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="scheduleSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="scheduleFilterDate" type="date" />
                    <select id="scheduleSortBy">
                        <option value="dateTime">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateTimeDesc">ÿ™ÿßÿ±€åÿÆ Ÿà ŸàŸÇÿ™ (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="type">ŸÜŸàÿπ€åÿ™</option>
                    </select>
                    <button onclick="filterAndSort('schedules')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('schedulesTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('schedulesTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('schedulesTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="schedulesTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ŸàŸÇÿ™</th>
                                <th>Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖ ⁄©ÿß ŸÜÿßŸÖ</th>
                                <th>ŸÜŸàÿπ€åÿ™</th>
                                <th>ÿ¨⁄Ø€Å</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="messages">
                <h2><i class="fas fa-envelope"></i> Ÿæ€åÿ∫ÿßŸÖÿßÿ™ ‚Äì ÿØŸÅÿ™ÿ± ⁄©Ÿà ŸÖŸàÿµŸàŸÑ €åÿß ÿØŸÅÿ™ÿ± ⁄©€å ÿ¨ÿßŸÜÿ® ÿ≥€í ÿßÿ±ÿ≥ÿßŸÑ</h2>
                <form id="messageForm">
                    <input id="messageId" type="hidden" />
                    <div class="form-group">
                        <label for="messageType">ŸÜŸàÿπ€åÿ™:</label>
                        <select id="messageType">
                            <option value="ŸÖŸàÿµŸàŸÑ ÿ¥ÿØ€Å">ŸÖŸàÿµŸàŸÑ ÿ¥ÿØ€Å</option>
                            <option value="ÿßÿ±ÿ≥ÿßŸÑ ⁄©ÿ±ÿØ€Å">ÿßÿ±ÿ≥ÿßŸÑ ⁄©ÿ±ÿØ€Å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="messageSenderReceiver">ÿ®⁄æ€åÿ¨ŸÜ€í ŸàÿßŸÑÿß/ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å:</label>
                        <input id="messageSenderReceiver" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="messageSubject">ŸÖÿ∂ŸÖŸàŸÜ:</label>
                        <input id="messageSubject" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="messageDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="messageDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="messageDate">ÿ™ÿßÿ±€åÿÆ:</label>
                        <input id="messageDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="messageFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="messageFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="messageFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearMessageForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-inbox"></i> Ÿæ€åÿ∫ÿßŸÖÿßÿ™ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="messageSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="messageFilterDate" type="date" />
                    <select id="messageSortBy">
                        <option value="date">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="type">ŸÜŸàÿπ€åÿ™</option>
                    </select>
                    <button onclick="filterAndSort('messages')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('messagesTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('messagesTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('messagesTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="messagesTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ŸÜŸàÿπ€åÿ™</th>
                                <th>ÿ®⁄æ€åÿ¨ŸÜ€í ŸàÿßŸÑÿß/ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å</th>
                                <th>ŸÖÿ∂ŸÖŸàŸÜ</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="letters">
                <h2><i class="fas fa-file-alt"></i> ÿÆÿ∑Ÿàÿ∑ ‚Äì ŸÖÿÆÿ™ŸÑŸÅ ÿßŸÅÿ±ÿßÿØ/ÿ¥ÿπÿ®€Å ÿ¨ÿßÿ™ ⁄©Ÿà ÿ¨ÿßÿ±€å ⁄©ÿ±ÿØ€Å ÿÆÿ∑Ÿàÿ∑</h2>
                <form id="letterForm">
                    <input id="letterId" type="hidden" />
                    <div class="form-group">
                        <label for="letterRecipient">ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å (ŸÅÿ±ÿØ/ÿ¥ÿπÿ®€Å):</label>
                        <input id="letterRecipient" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="letterSubject">ŸÖÿ∂ŸÖŸàŸÜ:</label>
                        <input id="letterSubject" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="letterDate">ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß:</label>
                        <input id="letterDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="letterDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="letterDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="letterFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="letterFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="letterFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearLetterForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-folder-open"></i> ÿÆÿ∑Ÿàÿ∑ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="letterSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="letterFilterDate" type="date" />
                    <select id="letterSortBy">
                        <option value="date">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                    </select>
                    <button onclick="filterAndSort('letters')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('lettersTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('lettersTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('lettersTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="lettersTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß</th>
                                <th>ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å</th>
                                <th>ŸÖÿ∂ŸÖŸàŸÜ</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="demands">
                <h2><i class="fas fa-money-bill-wave"></i> ŸÖÿ∑ÿßŸÑÿ®ÿßÿ™ ‚Äì Ÿàÿ≥ÿßÿ¶ŸÑ €åÿß ÿØ€å⁄Øÿ± ÿßŸÖŸàÿ± ⁄©€í ŸÖÿ∑ÿßŸÑÿ®ÿßÿ™</h2>
                <form id="demandForm">
                    <input id="demandId" type="hidden" />
                    <div class="form-group">
                        <label for="demandSubject">ŸÖÿ∑ÿßŸÑÿ®€í ⁄©ÿß ÿπŸÜŸàÿßŸÜ:</label>
                        <input id="demandSubject" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="demandRequester">ŸÖÿ∑ÿßŸÑÿ®€Å ⁄©ÿ±ŸÜ€í ŸàÿßŸÑÿß:</label>
                        <input id="demandRequester" required="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="demandDate">ÿ™ÿßÿ±€åÿÆ ŸÖÿ∑ÿßŸÑÿ®€Å:</label>
                        <input id="demandDate" required="" type="date" />
                    </div>
                    <div class="form-group">
                        <label for="demandDetails">ÿ™ŸÅÿµ€åŸÑ:</label>
                        <textarea id="demandDetails" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="demandStatus">ÿ≠ÿßŸÑÿ™:</label>
                        <select id="demandStatus">
                            <option value="ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß">ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß</option>
                            <option value="ŸÖ⁄©ŸÖŸÑ">ŸÖ⁄©ŸÖŸÑ</option>
                            <option value="ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å">ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å</option>
                            <option value="ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å">ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="demandFiles">ŸÅÿßÿ¶ŸÑ€å⁄∫ (Ÿæ€å ⁄à€å ÿß€åŸÅÿå ÿ™ÿµÿßŸà€åÿ±):</label>
                        <input accept=".pdf,image/*" id="demandFiles" multiple="" type="file" />
                        <div class="file-upload-preview" id="demandFilesPreview"></div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit"><i class="fas fa-save"></i> ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫</button>
                        <button id="clearDemandForm" type="button"><i class="fas fa-eraser"></i> ÿµÿßŸÅ ⁄©ÿ±€å⁄∫</button>
                    </div>
                </form>
                <h3><i class="fas fa-list-alt"></i> ŸÖÿ∑ÿßŸÑÿ®ÿßÿ™ ⁄©€å ŸÅ€Åÿ±ÿ≥ÿ™</h3>
                <div class="controls">
                    <input id="demandSearch" placeholder="ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫..." type="text" />
                    <input id="demandFilterDate" type="date" />
                    <select id="demandSortBy">
                        <option value="date">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ŸÇÿØ€åŸÖ ÿ™ÿ±€åŸÜ)</option>
                        <option value="dateDesc">ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ± (ÿ¨ÿØ€åÿØ ÿ™ÿ±€åŸÜ)</option>
                        <option value="status">ÿ≠ÿßŸÑÿ™</option>
                    </select>
                    <button onclick="filterAndSort('demands')"><i class="fas fa-filter"></i> ŸÅŸÑŸπÿ± / ÿ™ÿ±ÿ™€åÿ® ÿØ€å⁄∫</button>
                </div>
                <div class="export-options">
                    <button class="print-btn" onclick="printTable('demandsTable')"><i class="fas fa-print"></i> Ÿæÿ±ŸÜŸπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('demandsTable', 'excel')"><i class="fas fa-file-excel"></i> ÿß€å⁄©ÿ≥ŸÑ
                        ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                    <button onclick="exportTable('demandsTable', 'image')"><i class="fas fa-image"></i> ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ
                        ⁄©ÿ±€å⁄∫</button>
                </div>
                <div style="overflow-x: auto;">
                    <table id="demandsTable">
                        <thead>
                            <tr>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>ŸÖÿ∑ÿßŸÑÿ®€Å ⁄©ÿ±ŸÜ€í ŸàÿßŸÑÿß</th>
                                <th>ÿ™ŸÅÿµ€åŸÑ</th>
                                <th>ÿ≠ÿßŸÑÿ™</th>
                                <th>ŸÅÿßÿ¶ŸÑ€å⁄∫</th>
                                <th>ÿ¢Ÿæÿ¥ŸÜÿ≤</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </section>
            <section class="module-section" id="backupRestore">
                <h2><i class="fas fa-cloud-download-alt"></i> ⁄à€åŸπÿß ÿ®€å⁄© ÿßŸæ Ÿà ÿ±€å ÿ≥ŸπŸàÿ± (JSON)</h2>
                <h3><i class="fas fa-download"></i> ⁄à€åŸπÿß ÿ®€å⁄© ÿßŸæ</h3>
                <p>ÿßŸæŸÜ€å ÿ™ŸÖÿßŸÖ ⁄à€åŸπÿß ⁄©Ÿà JSON ŸÅÿßÿ¶ŸÑ ŸÖ€å⁄∫ ⁄àÿßÿ§ŸÜ ŸÑŸà⁄à ⁄©ÿ±€å⁄∫€î</p>
                <div class="action-buttons">
                    <button onclick="backupData()"><i class="fas fa-download"></i> ÿ®€å⁄© ÿßŸæ ⁄àÿßÿ§ŸÜ ŸÑŸà⁄à ⁄©ÿ±€å⁄∫</button>
                </div>
                <h3><i class="fas fa-upload"></i> ⁄à€åŸπÿß ÿ±€å ÿ≥ŸπŸàÿ±</h3>
                <p>JSON ŸÅÿßÿ¶ŸÑ ÿ≥€í ⁄à€åŸπÿß ÿßŸæ ŸÑŸà⁄à ⁄©ÿ± ⁄©€í ÿßŸæŸÜ€í ⁄à€åŸπÿß ⁄©Ÿà ÿ®ÿ≠ÿßŸÑ ⁄©ÿ±€å⁄∫€î</p>
                <div class="form-group">
                    <label for="restoreFile">JSON ŸÅÿßÿ¶ŸÑ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫:</label>
                    <input accept=".json" id="restoreFile" type="file" />
                </div>
                <div class="action-buttons">
                    <button onclick="restoreData()"><i class="fas fa-upload"></i> ⁄à€åŸπÿß ÿ®ÿ≠ÿßŸÑ ⁄©ÿ±€å⁄∫</button>
                </div>
                <p style="color: var(--delete-color); font-size: var(--font-size-sm);"><strong>Ÿàÿßÿ±ŸÜŸÜ⁄Ø:</strong> ⁄à€åŸπÿß
                    ÿ®ÿ≠ÿßŸÑ ⁄©ÿ±ŸÜ€í ÿ≥€í ŸÖŸàÿ¨ŸàÿØ€Å ⁄à€åŸπÿß ÿ™ÿ®ÿØ€åŸÑ €ÅŸà ÿ≥⁄©ÿ™ÿß €Å€í€î</p>
            </section>
        </main>
    </div>
    <script>
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type}`;
            setTimeout(() => {
                notification.classList.remove('show');
                notification.classList.add('hide');
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.classList.remove('hide');
                }, 500);
            }, 3000);
        }
        document.getElementById('themeToggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        });
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
        }
        const DB_NAME = 'OfficeManagerDB';
        const DB_VERSION = 1;
        let db;
        const openDB = () => {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                request.onupgradeneeded = (event) => {
                    db = event.target.result;
                    const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
                    storeNames.forEach(storeName => {
                        if (!db.objectStoreNames.contains(storeName)) {
                            db.createObjectStore(storeName, { keyPath: 'id', autoIncrement: true });
                        }
                    });
                    showNotification('⁄à€åŸπÿß ÿ®€åÿ≥ ÿßŸæ ⁄Øÿ±€å⁄à €ÅŸà ⁄Øÿ¶€å €åÿß ÿ®ŸÜ ⁄Øÿ¶€å!', 'info');
                };
                request.onsuccess = (event) => {
                    db = event.target.result;
                    resolve(db);
                };
                request.onerror = (event) => {
                    console.error('IndexedDB error:', event.target.error);
                    showNotification('⁄à€åŸπÿß ÿ®€åÿ≥ ŸÑŸà⁄à ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    reject(event.target.error);
                };
            });
        };
        const addData = async (storeName, data) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.add(data);
                request.onsuccess = () => {
                    showNotification('⁄à€åŸπÿß ÿ¥ÿßŸÖŸÑ ⁄©ÿ± ÿØ€åÿß ⁄Ø€åÿß!', 'success');
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error adding data to ${storeName}:`, event.target.error);
                    showNotification('⁄à€åŸπÿß ÿ¥ÿßŸÖŸÑ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    reject(event.target.error);
                };
            });
        };
        const getAllData = async (storeName) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readonly');
                const store = transaction.objectStore(storeName);
                const request = store.getAll();
                request.onsuccess = () => {
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error getting all data from ${storeName}:`, event.target.error);
                    showNotification('⁄à€åŸπÿß ÿ≠ÿßÿµŸÑ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    reject(event.target.error);
                };
            });
        };
        const updateData = async (storeName, data) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.put(data);
                request.onsuccess = () => {
                    showNotification('⁄à€åŸπÿß ÿßŸæ ⁄à€åŸπ ⁄©ÿ± ÿØ€åÿß ⁄Ø€åÿß!', 'success');
                    resolve(request.result);
                };
                request.onerror = (event) => {
                    console.error(`Error updating data in ${storeName}:`, event.target.error);
                    showNotification('⁄à€åŸπÿß ÿßŸæ ⁄à€åŸπ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    reject(event.target.error);
                };
            });
        };
        const deleteData = async (storeName, id) => {
            await openDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.delete(id);
                request.onsuccess = () => {
                    showNotification('⁄à€åŸπÿß ÿ≠ÿ∞ŸÅ ⁄©ÿ± ÿØ€åÿß ⁄Ø€åÿß!', 'success');
                    resolve();
                };
                request.onerror = (event) => {
                    console.error(`Error deleting data from ${storeName}:`, event.target.error);
                    showNotification('⁄à€åŸπÿß ÿ≠ÿ∞ŸÅ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    reject(event.target.error);
                };
            });
        };
        async function filesToBase64(files) {
            const filePromises = Array.from(files).map(file => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve({
                        name: file.name,
                        type: file.type,
                        data: reader.result
                    });
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            });
            return Promise.all(filePromises);
        }
        function displayFilePreviews(fileArray, previewElementId) {
            const previewDiv = document.getElementById(previewElementId);
            previewDiv.innerHTML = '';
            if (!fileArray || fileArray.length === 0) return;
            fileArray.forEach((file, index) => {
                const fileDiv = document.createElement('div');
                fileDiv.innerHTML = `
                ${file.type.startsWith('image/') ? `<img src="${file.data}" alt="${file.name}"/>` : '<i class="fas fa-file"></i>'}
                <span>${file.name}</span>
                <button type="button" data-index="${index}"><i class="fas fa-times"></i></button>
            `;
                fileDiv.querySelector('button').onclick = () => {
                    removeFileFromFormPreview(index, previewElementId);
                };
                previewDiv.appendChild(fileDiv);
            });
        }
        function removeFileFromFormPreview(indexToRemove, previewElementId) {
            const moduleName = document.querySelector('.module-section.active').id;
            const formId = `${moduleName}Form`;
            let currentFiles = window.currentEditFiles[formId];
            if (currentFiles && currentFiles.length > indexToRemove) {
                currentFiles.splice(indexToRemove, 1);
                displayFilePreviews(currentFiles, previewElementId);
            }
        }
        function downloadJSON(data, filename) {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        async function backupData() {
            showNotification('ÿ®€å⁄© ÿßŸæ ÿ™€åÿßÿ± ⁄©€åÿß ÿ¨ÿß ÿ±€Åÿß €Å€í...', 'info');
            const allData = {};
            const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
            try {
                for (const storeName of storeNames) {
                    allData[storeName] = await getAllData(storeName);
                }
                const timestamp = new Date().toISOString().replace(/[:.-]/g, '');
                downloadJSON(allData, `ÿØŸÅÿ™ÿ±_ŸÖŸÜÿ∏ŸÖ_ÿ®€å⁄©_ÿßŸæ_${timestamp}.json`);
                showNotification('ÿ®€å⁄© ÿßŸæ ⁄©ÿßŸÖ€åÿßÿ®€å ÿ≥€í ⁄àÿßÿ§ŸÜ ŸÑŸà⁄à ⁄©ÿ± ÿØ€åÿß ⁄Ø€åÿß!', 'success');
            } catch (error) {
                console.error('Backup failed:', error);
                showNotification('ÿ®€å⁄© ÿßŸæ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
            }
        }
        async function restoreData() {
            const fileInput = document.getElementById('restoreFile');
            const file = fileInput.files[0];
            if (!file) {
                showNotification('ÿ®ÿ±ÿß€Å ⁄©ÿ±ŸÖ JSON ŸÅÿßÿ¶ŸÑ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫!', 'error');
                return;
            }
            showNotification('⁄à€åŸπÿß ÿ®ÿ≠ÿßŸÑ ⁄©€åÿß ÿ¨ÿß ÿ±€Åÿß €Å€í...', 'info');
            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    const importedData = JSON.parse(event.target.result);
                    const storeNames = ['tasks', 'reminders', 'urgentTasks', 'meetings', 'notifications', 'contacts', 'performance', 'schedules', 'messages', 'letters', 'demands'];
                    await openDB();
                    for (const storeName of storeNames) {
                        const transaction = db.transaction([storeName], 'readwrite');
                        const store = transaction.objectStore(storeName);
                        await new Promise((resolve, reject) => {
                            const clearRequest = store.clear();
                            clearRequest.onsuccess = resolve;
                            clearRequest.onerror = reject;
                        });
                    }
                    for (const storeName of storeNames) {
                        if (importedData[storeName]) {
                            for (const item of importedData[storeName]) {
                                const newItem = { ...item };
                                delete newItem.id;
                                const transaction = db.transaction([storeName], 'readwrite');
                                const store = transaction.objectStore(storeName);
                                await new Promise((resolve, reject) => {
                                    const addRequest = store.add(newItem);
                                    addRequest.onsuccess = resolve;
                                    addRequest.onerror = reject;
                                });
                            }
                        }
                    }
                    showNotification('⁄à€åŸπÿß ⁄©ÿßŸÖ€åÿßÿ®€å ÿ≥€í ÿ®ÿ≠ÿßŸÑ ⁄©ÿ± ÿØ€åÿß ⁄Ø€åÿß!', 'success');
                    loadAllTables();
                } catch (error) {
                    console.error('Restore failed:', error);
                    showNotification('⁄à€åŸπÿß ÿ®ÿ≠ÿßŸÑ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å: ' + error.message, 'error');
                }
            };
            reader.onerror = (error) => {
                console.error('File reading error:', error);
                showNotification('ŸÅÿßÿ¶ŸÑ Ÿæ⁄ë⁄æŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
            };
            reader.readAsText(file);
        }
        const moduleButtons = document.querySelectorAll('.sidebar ul li button');
        const moduleSections = document.querySelectorAll('.module-section');
        let activeModule = 'tasks';
        const activateModule = (moduleName) => {
            moduleSections.forEach(section => section.classList.remove('active'));
            document.getElementById(moduleName).classList.add('active');
            moduleButtons.forEach(button => button.classList.remove('active'));
            document.querySelector(`.sidebar ul li button[data-module="${moduleName}"]`).classList.add('active');
            activeModule = moduleName;
            loadModuleData(moduleName);
            clearForms();
        };
        moduleButtons.forEach(button => {
            button.addEventListener('click', () => {
                activateModule(button.dataset.module);
            });
        });
        document.addEventListener('DOMContentLoaded', () => {
            activateModule(activeModule);
        });
        const clearForms = () => {
            const forms = ['taskForm', 'reminderForm', 'urgentTaskForm', 'meetingForm', 'notificationForm', 'contactForm', 'performanceForm', 'scheduleForm', 'messageForm', 'letterForm', 'demandForm'];
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) {
                    form.reset();
                    const idInput = form.querySelector('input[type="hidden"]');
                    if (idInput) idInput.value = '';
                    const filePreview = form.querySelector('.file-upload-preview');
                    if (filePreview) filePreview.innerHTML = '';
                    window.currentEditFiles[formId] = [];
                }
            });
            document.querySelectorAll('.controls input[type="text"]').forEach(input => input.value = '');
            document.querySelectorAll('.controls input[type="date"]').forEach(input => input.value = '');
            document.querySelectorAll('.controls select').forEach(select => select.selectedIndex = 0);
        };
        window.currentEditFiles = {
            taskForm: [],
            notificationForm: [],
            performanceForm: [],
            messageForm: [],
            letterForm: [],
            demandForm: []
        };
        const handleFormSubmit = async (event, storeName, formId, clearFunc, fileInputId, filePreviewId) => {
            event.preventDefault();
            const form = document.getElementById(formId);
            const idInput = document.getElementById(`${storeName.slice(0, -1)}Id`);
            let data = {};
            Array.from(form.elements).forEach(element => {
                if (element.id && element.id !== idInput.id && element.type !== 'file' && element.tagName !== 'BUTTON') {
                    data[element.id] = element.value.trim();
                }
            });
            if (fileInputId) {
                const fileInput = document.getElementById(fileInputId);
                let combinedFiles = window.currentEditFiles[formId] || [];
                if (fileInput.files.length > 0) {
                    const newFilesBase64 = await filesToBase64(fileInput.files);
                    combinedFiles = [...combinedFiles, ...newFilesBase64];
                }
                data.files = combinedFiles;
            }
            if (idInput.value) {
                data.id = parseInt(idInput.value);
                await updateData(storeName, data);
            } else {
                await addData(storeName, data);
            }
            clearFunc();
            loadModuleData(storeName);
        };
        const editEntry = async (storeName, id, formId, fileInputId, filePreviewId) => {
            showNotification('⁄à€åŸπÿß ŸÑŸà⁄à ⁄©€åÿß ÿ¨ÿß ÿ±€Åÿß €Å€í...', 'info');
            await openDB();
            const transaction = db.transaction([storeName], 'readonly');
            const store = transaction.objectStore(storeName);
            const request = store.get(id);
            request.onsuccess = (event) => {
                const item = event.target.result;
                if (item) {
                    const form = document.getElementById(formId);
                    const idInput = document.getElementById(`${storeName.slice(0, -1)}Id`);
                    idInput.value = item.id;
                    Array.from(form.elements).forEach(element => {
                        if (element.id && element.id !== idInput.id && element.type !== 'file' && element.tagName !== 'BUTTON') {
                            element.value = item[element.id] || '';
                        }
                    });
                    if (fileInputId && filePreviewId) {
                        window.currentEditFiles[formId] = item.files || [];
                        displayFilePreviews(item.files || [], filePreviewId);
                    }
                    showNotification('⁄à€åŸπÿß ŸÅÿßÿ±ŸÖ ŸÖ€å⁄∫ ŸÑŸà⁄à €ÅŸà ⁄Ø€åÿß!', 'info');
                    form.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else {
                    showNotification('ÿ±€å⁄©ÿßÿ±⁄à ŸÜ€Å€å⁄∫ ŸÖŸÑÿß!', 'error');
                }
            };
            request.onerror = (event) => {
                console.error(`Error fetching ${storeName} for edit:`, event.target.error);
                showNotification('⁄à€åŸπÿß ŸÑŸà⁄à ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
            };
        };
        const deleteEntry = async (storeName, id) => {
            if (confirm('⁄©€åÿß ÿ¢Ÿæ ŸàÿßŸÇÿπ€å ÿßÿ≥ ÿ±€å⁄©ÿßÿ±⁄à ⁄©Ÿà ÿ≠ÿ∞ŸÅ ⁄©ÿ±ŸÜÿß ⁄Üÿß€Åÿ™€í €Å€å⁄∫ÿü')) {
                await deleteData(storeName, id);
                loadModuleData(storeName);
            }
        };
        const loadDataIntoTable = async (storeName, tableId, renderRowFunc, filterFunc, sortFunc) => {
            const data = await getAllData(storeName);
            let filteredData = data;
            if (filterFunc) {
                filteredData = filterFunc(data);
            }
            if (sortFunc) {
                filteredData.sort(sortFunc);
            }
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';
            if (filteredData.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="${document.querySelector(`#${tableId} thead tr`).children.length}">⁄©Ÿàÿ¶€å ÿ±€å⁄©ÿßÿ±⁄à ŸÜ€Å€å⁄∫ ŸÖŸÑÿß€î</td></tr>`;
                return;
            }
            filteredData.forEach(item => {
                tableBody.appendChild(renderRowFunc(item, storeName));
            });
        };
        const filterAndSort = (moduleName) => {
            loadModuleData(moduleName);
        };
        const addSampleData = async () => {
            showNotification('ŸÜŸÖŸàŸÜ€Å ⁄à€åŸπÿß ÿ¥ÿßŸÖŸÑ ⁄©€åÿß ÿ¨ÿß ÿ±€Åÿß €Å€í...', 'info');
            await Promise.all([
                addData('tasks', { taskId: 1, taskName: 'ŸÖ€åŸπŸÜ⁄Ø ⁄©€å ÿ™€åÿßÿ±€å', taskDescription: 'ÿ¢ÿ¶ŸÜÿØ€Å €ÅŸÅÿ™€í ⁄©€å ŸÖ€åŸπŸÜ⁄Ø ⁄©€í ÿß€åÿ¨ŸÜ⁄à€í ÿßŸàÿ± ÿ±ŸæŸàÿ±Ÿπÿ≥ ÿ™€åÿßÿ± ⁄©ÿ±€å⁄∫€î', taskDueDate: '2023-11-25', taskPriority: 'ÿßŸÜÿ™€Åÿßÿ¶€å ÿß€ÅŸÖ', taskStatus: 'ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß', files: [] }),
                addData('tasks', { taskId: 2, taskName: 'ŸÖÿß€ÅÿßŸÜ€Å ÿ±ŸæŸàÿ±Ÿπ ÿ¨ŸÖÿπ ⁄©ÿ±ÿßŸÜÿß', taskDescription: 'ÿß⁄©ÿ™Ÿàÿ®ÿ± ⁄©€å ŸÖÿß€ÅÿßŸÜ€Å ⁄©ÿßÿ±⁄©ÿ±ÿØ⁄Ø€å ÿ±ŸæŸàÿ±Ÿπ ÿ¨ŸÖÿπ ⁄©ÿ±ÿßÿ¶€å⁄∫€î', taskDueDate: '2023-11-15', taskPriority: 'ÿß€ÅŸÖ', taskStatus: 'ŸÖ⁄©ŸÖŸÑ', files: [] }),
                addData('reminders', { reminderId: 1, reminderTitle: '⁄©ÿ±ÿß€å€Å ⁄©€å ÿßÿØÿßÿ¶€å⁄Ø€å', reminderDetails: 'ÿØŸÅÿ™ÿ± ⁄©€í ⁄©ÿ±ÿß€å€Å ⁄©€å ÿßÿØÿßÿ¶€å⁄Ø€å ⁄©€å ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ€î', reminderDate: '2023-12-01', reminderTime: '10:00', reminderType: 'ÿßŸÑÿßÿ±ŸÖ' }),
                addData('reminders', { reminderId: 2, reminderTitle: 'ÿ®ŸÑ ÿ¨ŸÖÿπ ⁄©ÿ±ÿßŸÜÿß', reminderDetails: 'ÿ®ÿ¨ŸÑ€å ⁄©ÿß ÿ®ŸÑ ÿ¨ŸÖÿπ ⁄©ÿ±ÿßŸÜ€í ⁄©€å €åÿßÿØ ÿØ€ÅÿßŸÜ€å€î', reminderDate: '2023-11-20', reminderTime: '', reminderType: 'ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±' }),
                addData('urgentTasks', { urgentTaskId: 1, urgentTaskName: 'ŸÅŸàÿ±€å ⁄àÿß⁄© ⁄©€å ÿ™ÿ±ÿ≥€åŸÑ', urgentTaskDescription: 'ÿß€ÅŸÖ ÿØÿ≥ÿ™ÿßŸà€åÿ≤ÿßÿ™ ÿ¢ÿ¨ €Å€å ÿ®⁄æ€åÿ¨ŸÜÿß €Å€å⁄∫€î', urgentTaskDueDate: '2023-11-14', urgentTaskDueTime: '17:00' }),
                addData('urgentTasks', { urgentTaskId: 2, urgentTaskName: '€ÅŸÜ⁄ØÿßŸÖ€å ŸÖÿ±ŸÖÿ™', urgentTaskDescription: 'ÿ≥ÿ±Ÿàÿ± ÿ±ŸàŸÖ ŸÖ€å⁄∫ ŸÅŸàÿ±€å ŸÖÿ±ŸÖÿ™ ÿØÿ±⁄©ÿßÿ± €Å€í€î', urgentTaskDueDate: '2023-11-16', urgentTaskDueTime: '09:00' }),
                addData('meetings', { meetingId: 1, meetingPerson: 'ÿ≥€å ÿß€å ÿßŸà ÿßŸàÿ± ŸÖŸÜ€åÿ¨ÿ±ÿ≤', meetingDate: '2023-11-20', meetingTime: '11:00', meetingLocation: '⁄©ÿßŸÜŸÅÿ±ŸÜÿ≥ ÿ±ŸàŸÖ', meetingDetails: 'ÿ≥€Å ŸÖÿß€Å€å ⁄©ÿßÿ±⁄©ÿ±ÿØ⁄Ø€å ÿ¨ÿßÿ¶ÿ≤€Å ŸÖ€åŸπŸÜ⁄Ø€î' }),
                addData('meetings', { meetingId: 2, meetingPerson: '⁄©ÿ≥ŸπŸÖÿ± ÿ≥ŸæŸàÿ±Ÿπ Ÿπ€åŸÖ', meetingDate: '2023-11-22', meetingTime: '14:00', meetingLocation: 'ÿ¢ŸÜ ŸÑÿßÿ¶ŸÜ', meetingDetails: 'ŸÜÿ¶€å ŸæÿßŸÑ€åÿ≥€å Ÿæÿ± ÿ®ÿ±€åŸÅŸÜ⁄Ø€î' }),
                addData('notifications', { notificationId: 1, notificationTitle: 'ÿ®ÿ¨ŸÑ€å ÿ®ŸÜÿØÿ¥ ⁄©€å ÿßÿ∑ŸÑÿßÿπ', notificationType: 'ÿØÿßÿÆŸÑ€å', notificationDetails: '⁄©ŸÑ ÿØŸàŸæ€Åÿ± 2 ÿ≥€í 4 ÿ®ÿ¨€í ÿ™⁄© ÿ®ÿ¨ŸÑ€å ÿ®ŸÜÿØ ÿ±€Å€í ⁄Ø€å€î', notificationDate: '2023-11-14', files: [] }),
                addData('notifications', { notificationId: 2, notificationTitle: 'ÿπŸàÿßŸÖ€å ⁄Ü⁄æŸπ€å', notificationType: 'ÿÆÿßÿ±ÿ¨€å', notificationDetails: '18 ŸÜŸàŸÖÿ®ÿ± ⁄©Ÿà ÿπÿßŸÖ ÿ™ÿπÿ∑€åŸÑ €ÅŸà⁄Ø€å€î', notificationDate: '2023-11-10', files: [] }),
                addData('contacts', { contactId: 1, contactName: 'ÿßÿ≠ŸÖÿØ ÿÆÿßŸÜ (ÿ≥ŸæŸÑÿßÿ¶ÿ±)', contactPhone: '03001234567', contactEmail: 'ahmed@supplier.com', contactRelationship: 'ÿ≥ŸæŸÑÿßÿ¶ÿ±', contactAddress: '⁄©ÿ±ÿß⁄Ü€å' }),
                addData('contacts', { contactId: 2, contactName: 'ŸÅÿßÿ∑ŸÖ€Å ÿ®€å⁄ØŸÖ (⁄©ŸÑÿßÿ¶ŸÜŸπ)', contactPhone: '03339876543', contactEmail: 'fatima@client.org', contactRelationship: 'ÿß€ÅŸÖ ⁄©ŸÑÿßÿ¶ŸÜŸπ', contactAddress: 'ŸÑÿß€ÅŸàÿ±' }),
                addData('performance', { performanceId: 1, performanceTitle: 'ÿß⁄©ÿ™Ÿàÿ®ÿ± ŸÖÿß€Å ⁄©€å ⁄©ÿßÿ±⁄©ÿ±ÿØ⁄Ø€å', performancePeriod: 'ŸÖÿß€ÅÿßŸÜ€Å', performanceDate: '2023-11-05', performanceDetails: 'ÿß⁄©ÿ™Ÿàÿ®ÿ± ŸÖ€å⁄∫ ÿ≥€åŸÑÿ≤ ŸÖ€å⁄∫ 15% ÿßÿ∂ÿßŸÅ€Å €ÅŸàÿß€î', files: [] }),
                addData('performance', { performanceId: 2, performanceTitle: 'ÿ≥ÿßŸÑÿßŸÜ€Å ÿ¢⁄àŸπ ÿ±ŸæŸàÿ±Ÿπ', performancePeriod: 'ÿ≥ÿßŸÑÿßŸÜ€Å', performanceDate: '2023-10-30', performanceDetails: 'ÿ≥ÿßŸÑ 2022-23 ⁄©€í ŸÑ€å€í ÿ¢⁄àŸπ ŸÖ⁄©ŸÖŸÑ€î', files: [] }),
                addData('schedules', { scheduleId: 1, scheduleName: 'ŸÖ€åŸÑÿßÿØ ÿßŸÑŸÜÿ®€å Ô∑∫ ÿ™ŸÇÿ±€åÿ®', scheduleType: 'ÿßÿ¨ÿ™ŸÖÿßÿπÿßÿ™', scheduleDate: '2023-09-28', scheduleTime: '19:00', scheduleLocation: 'ŸÖŸÇÿßŸÖ€å ŸÖÿ≥ÿ¨ÿØ', scheduleDetails: 'ÿ¥ÿßŸÖ 7 ÿ®ÿ¨€í ÿ¥ÿ±Ÿàÿπ €ÅŸà ⁄Ø€å€î' }),
                addData('schedules', { scheduleId: 2, scheduleName: '€åŸàŸÜ€åŸàÿ±ÿ≥Ÿπ€å ŸÅ€åÿ≥ŸπŸàŸÑ', scheduleType: 'ÿØ€å⁄Øÿ±', scheduleDate: '2023-12-05', scheduleTime: '10:00', scheduleLocation: '€åŸàŸÜ€åŸàÿ±ÿ≥Ÿπ€å ÿ¢⁄à€åŸπŸàÿ±€åŸÖ', scheduleDetails: 'ÿ≥€Å ÿ±Ÿàÿ≤€Å ÿ™ŸÇÿ±€åÿ®€î' }),
                addData('messages', { messageId: 1, messageType: 'ŸÖŸàÿµŸàŸÑ ÿ¥ÿØ€Å', messageSenderReceiver: 'ŸÖÿ≠ŸÖÿØ ÿπŸÑ€å', messageSubject: 'Ÿæÿ±Ÿàÿ¨€å⁄©Ÿπ ⁄©€å ÿ™ÿßÿ≤€Å ⁄©ÿßÿ±€å', messageDetails: 'Ÿæÿ±Ÿàÿ¨€å⁄©Ÿπ ⁄©€å Ÿæ€åÿ¥ ÿ±ŸÅÿ™ ÿ≥€í ŸÖÿ™ÿπŸÑŸÇ ÿß€å ŸÖ€åŸÑ ŸÖŸàÿµŸàŸÑ €ÅŸàÿ¶€å€î', messageDate: '2023-11-12', files: [] }),
                addData('messages', { messageId: 2, messageType: 'ÿßÿ±ÿ≥ÿßŸÑ ⁄©ÿ±ÿØ€Å', messageSenderReceiver: 'ÿ≥ÿßÿ±€Å ÿßÿ≠ŸÖÿØ', messageSubject: 'Ÿπ€åŸÖ ŸÖ€åŸπŸÜ⁄Ø', messageDetails: 'ÿ¢ÿ¨ ⁄©€å Ÿπ€åŸÖ ŸÖ€åŸπŸÜ⁄Ø ⁄©ÿß ÿß€åÿ¨ŸÜ⁄àÿß€î', messageDate: '2023-11-13', files: [] }),
                addData('letters', { letterId: 1, letterRecipient: 'ÿ≥€å⁄©ÿ±Ÿπÿ±€å Ÿàÿ≤ÿßÿ±ÿ™ ÿ™ÿπŸÑ€åŸÖ', letterSubject: 'ÿ™ÿπŸÑ€åŸÖ€å ÿ≥€åŸÖ€åŸÜÿßÿ± ⁄©€å ÿØÿπŸàÿ™', letterDate: '2023-11-08', letterDetails: 'ÿ¢ÿ¶ŸÜÿØ€Å ÿ™ÿπŸÑ€åŸÖ€å ÿ≥€åŸÖ€åŸÜÿßÿ± ŸÖ€å⁄∫ ÿ¥ÿ±⁄©ÿ™ ⁄©€å ÿØÿπŸàÿ™ ⁄©ÿß ÿÆÿ∑€î', files: [] }),
                addData('letters', { letterId: 2, letterRecipient: 'ŸÖÿ≠ŸÖÿØ ÿπŸÖÿ±ÿßŸÜ (ÿß€å⁄Ü ÿ¢ÿ±)', letterSubject: '⁄Ü⁄æŸπ€å ⁄©€å ÿØÿ±ÿÆŸàÿßÿ≥ÿ™', letterDate: '2023-11-09', letterDetails: 'ÿß€å⁄© ÿØŸÜ ⁄©€å ⁄Ü⁄æŸπ€å ⁄©€í ŸÑ€å€í ÿØÿ±ÿÆŸàÿßÿ≥ÿ™€î', files: [] }),
                addData('demands', { demandId: 1, demandSubject: 'ŸÜÿ¶€í ÿ≥Ÿπ€åÿ¥ŸÜÿ±€å ⁄©ÿß ŸÖÿ∑ÿßŸÑÿ®€Å', demandRequester: 'ÿß⁄©ÿßÿ§ŸÜŸπÿ≥ ⁄à€åŸæÿßÿ±ŸπŸÖŸÜŸπ', demandDate: '2023-11-10', demandDetails: 'ÿ¢ŸÅÿ≥ ⁄©€í ŸÑ€å€í ÿ∂ÿ±Ÿàÿ±€å ÿ≥Ÿπ€åÿ¥ŸÜÿ±€å ⁄©ÿß ŸÖÿ∑ÿßŸÑÿ®€Å€î', demandStatus: 'ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß', files: [] }),
                addData('demands', { demandId: 2, demandSubject: 'ÿ≥ÿßŸÅŸπ Ÿà€åÿ¶ÿ± ŸÑÿßÿ¶ÿ≥ŸÜÿ≥', demandRequester: 'ÿ¢ÿ¶€å Ÿπ€å ⁄à€åŸæÿßÿ±ŸπŸÖŸÜŸπ', demandDate: '2023-11-07', demandDetails: 'ŸÜÿ¶€í ⁄Øÿ±ÿßŸÅ⁄© ⁄à€åÿ≤ÿßÿ¶ŸÜŸÜ⁄Ø ÿ≥ÿßŸÅŸπ Ÿà€åÿ¶ÿ± ŸÑÿßÿ¶ÿ≥ŸÜÿ≥ ⁄©€å ÿØÿ±ÿÆŸàÿßÿ≥ÿ™€î', demandStatus: 'ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å', files: [] }),
            ]).then(() => {
                showNotification('ŸÜŸÖŸàŸÜ€Å ÿßŸÜÿØÿ±ÿßÿ¨ÿßÿ™ ÿ¥ÿßŸÖŸÑ ⁄©ÿ± ÿØ€å€í ⁄Øÿ¶€í!', 'success');
                loadAllTables();
            }).catch(error => {
                console.error('Error adding sample data:', error);
                showNotification('ŸÜŸÖŸàŸÜ€Å ⁄à€åŸπÿß ÿ¥ÿßŸÖŸÑ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
            });
        };
        const loadAllTables = () => {
            loadModuleData('tasks');
            loadModuleData('reminders');
            loadModuleData('urgentTasks');
            loadModuleData('meetings');
            loadModuleData('notifications');
            loadModuleData('contacts');
            loadModuleData('performance');
            loadModuleData('schedules');
            loadModuleData('messages');
            loadModuleData('letters');
            loadModuleData('demands');
        };
        const modules = {
            tasks: {
                tableId: 'tasksTable',
                formId: 'taskForm',
                fileInputId: 'taskFiles',
                filePreviewId: 'taskFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.taskDueDate || 'N/A'}</td>
                        <td data-label="⁄©ÿßŸÖ ⁄©ÿß ÿπŸÜŸàÿßŸÜ:">${item.taskName}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.taskDescription || ''}</td>
                        <td data-label="ÿß€ÅŸÖ€åÿ™:"><span class="status-badge ${item.taskPriority === 'ÿßŸÜÿ™€Åÿßÿ¶€å ÿß€ÅŸÖ' ? 'urgent' : item.taskPriority === 'ÿß€ÅŸÖ' ? 'info' : ''}">${item.taskPriority}</span></td>
                        <td data-label="ÿ≠ÿßŸÑÿ™:"><span class="status-badge ${item.taskStatus === 'ŸÖ⁄©ŸÖŸÑ' ? 'complete' : 'pending'}">${item.taskStatus}</span></td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('tasks', ${item.id}, 'taskForm', 'taskFiles', 'taskFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('tasks', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('taskSearch').value.toLowerCase();
                    const filterDate = document.getElementById('taskFilterDate').value;
                    return data.filter(item =>
                        ((item.taskName || '').toLowerCase().includes(search) || (item.taskDescription || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.taskDueDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('taskSortBy').value;
                    if (sortBy === 'dueDate') return new Date(a.taskDueDate) - new Date(b.taskDueDate);
                    if (sortBy === 'dueDateDesc') return new Date(b.taskDueDate) - new Date(a.taskDueDate);
                    if (sortBy === 'priority') {
                        const priorityOrder = { 'ÿßŸÜÿ™€Åÿßÿ¶€å ÿß€ÅŸÖ': 4, 'ÿß€ÅŸÖ': 3, 'ÿßŸàÿ≥ÿ∑': 2, 'ŸÖÿπŸÖŸàŸÑ€å': 1 };
                        return priorityOrder[b.taskPriority] - priorityOrder[a.taskPriority];
                    }
                    if (sortBy === 'status') return a.taskStatus.localeCompare(b.taskStatus);
                    return 0;
                }
            },
            reminders: {
                tableId: 'remindersTable',
                formId: 'reminderForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ÿπŸÜŸàÿßŸÜ:">${item.reminderTitle}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.reminderDetails || ''}</td>
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.reminderDate}</td>
                        <td data-label="ŸàŸÇÿ™:">${item.reminderTime || 'N/A'}</td>
                        <td data-label="ŸÜŸàÿπ€åÿ™:"><span class="status-badge ${item.reminderType === 'ÿßŸÑÿßÿ±ŸÖ' ? 'urgent' : item.reminderType === 'ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±' ? 'info' : ''}">${item.reminderType}</span></td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('reminders', ${item.id}, 'reminderForm')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('reminders', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('reminderSearch').value.toLowerCase();
                    const filterDate = document.getElementById('reminderFilterDate').value;
                    return data.filter(item =>
                        ((item.reminderTitle || '').toLowerCase().includes(search) || (item.reminderDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.reminderDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('reminderSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.reminderDate}T${a.reminderTime || '00:00'}`) - new Date(`${b.reminderDate}T${b.reminderTime || '00:00'}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.reminderDate}T${b.reminderTime || '00:00'}`) - new Date(`${a.reminderDate}T${a.reminderTime || '00:00'}`);
                    if (sortBy === 'type') return a.reminderType.localeCompare(b.reminderType);
                    return 0;
                }
            },
            urgentTasks: {
                tableId: 'urgentTasksTable',
                formId: 'urgentTaskForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ÿπŸÜŸàÿßŸÜ:">${item.urgentTaskName}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.urgentTaskDescription || ''}</td>
                        <td data-label="ÿ¢ÿÆÿ±€å ÿ™ÿßÿ±€åÿÆ:">${item.urgentTaskDueDate}</td>
                        <td data-label="ÿ¢ÿÆÿ±€å ŸàŸÇÿ™:">${item.urgentTaskDueTime || 'N/A'}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('urgentTasks', ${item.id}, 'urgentTaskForm')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('urgentTasks', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('urgentTaskSearch').value.toLowerCase();
                    const filterDate = document.getElementById('urgentTaskFilterDate').value;
                    return data.filter(item =>
                        (item.urgentTaskName.toLowerCase().includes(search) || (item.urgentTaskDescription || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.urgentTaskDueDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('urgentTaskSortBy').value;
                    if (sortBy === 'dueDate') return new Date(a.urgentTaskDueDate) - new Date(b.urgentTaskDueDate);
                    if (sortBy === 'dueDateDesc') return new Date(b.urgentTaskDueDate) - new Date(a.urgentTaskDueDate);
                    return 0;
                }
            },
            meetings: {
                tableId: 'meetingsTable',
                formId: 'meetingForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.meetingDate}</td>
                        <td data-label="ŸàŸÇÿ™:">${item.meetingTime}</td>
                        <td data-label="ÿ¥ÿÆÿµ€åÿßÿ™:">${item.meetingPerson}</td>
                        <td data-label="ÿ¨⁄Ø€Å:">${item.meetingLocation || ''}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.meetingDetails || ''}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('meetings', ${item.id}, 'meetingForm')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('meetings', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('meetingSearch').value.toLowerCase();
                    const filterDate = document.getElementById('meetingFilterDate').value;
                    return data.filter(item =>
                        (item.meetingPerson.toLowerCase().includes(search) || (item.meetingLocation || '').toLowerCase().includes(search) || (item.meetingDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.meetingDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('meetingSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.meetingDate}T${a.meetingTime}`) - new Date(`${b.meetingDate}T${b.meetingTime}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.meetingDate}T${b.meetingTime}`) - new Date(`${a.meetingDate}T${a.meetingTime}`);
                    return 0;
                }
            },
            notifications: {
                tableId: 'notificationsTable',
                formId: 'notificationForm',
                fileInputId: 'notificationFiles',
                filePreviewId: 'notificationFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.notificationDate}</td>
                        <td data-label="ÿπŸÜŸàÿßŸÜ:">${item.notificationTitle}</td>
                        <td data-label="ŸÜŸàÿπ€åÿ™:"><span class="status-badge ${item.notificationType === 'ÿØÿßÿÆŸÑ€å' ? 'info' : 'secondary'}">${item.notificationType}</span></td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.notificationDetails || ''}</td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('notifications', ${item.id}, 'notificationForm', 'notificationFiles', 'notificationFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('notifications', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('notificationSearch').value.toLowerCase();
                    const filterDate = document.getElementById('notificationFilterDate').value;
                    return data.filter(item =>
                        (item.notificationTitle.toLowerCase().includes(search) || (item.notificationDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.notificationDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('notificationSortBy').value;
                    if (sortBy === 'date') return new Date(a.notificationDate) - new Date(b.notificationDate);
                    if (sortBy === 'dateDesc') return new Date(b.notificationDate) - new Date(a.notificationDate);
                    if (sortBy === 'type') return a.notificationType.localeCompare(b.notificationType);
                    return 0;
                }
            },
            contacts: {
                tableId: 'contactsTable',
                formId: 'contactForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const encodedMessage = encodeURIComponent(item.contactMessage || '');

                    tr.innerHTML = `
        <td data-label="ŸÜÿßŸÖ/ÿ™ŸÜÿ∏€åŸÖ:">${(item.contactName || '')}</td>
        <td data-label="ŸÅŸàŸÜ:">${item.contactPhone || 'N/A'} 
            ${item.contactPhone ? `<button class="whatsapp-btn" onclick="window.open('https://wa.me/${item.contactPhone.replace(/\D/g, '')}?text=${encodedMessage}', '_blank')"><i class="fab fa-whatsapp"></i> WhatsApp</button>` : ''}
            ${item.contactPhone ? `<button class="sms-btn" onclick="window.open('sms:${item.contactPhone.replace(/\D/g, '')}?body=${encodedMessage}', '_blank')"><i class="fas fa-sms"></i> SMS</button>` : ''}
        </td>
        <td data-label="ÿß€å ŸÖ€åŸÑ:">${item.contactEmail || 'N/A'} ${item.contactEmail ? `<a href="mailto:${item.contactEmail}"><i class="fas fa-envelope"></i> ÿß€å ŸÖ€åŸÑ ⁄©ÿ±€å⁄∫</a>` : ''}</td>
        <td data-label="ÿ±ÿ¥ÿ™€Å/ŸÖÿπŸÖŸàŸÑ:">${item.contactRelationship || ''}</td>
        <td data-label="Ÿæ€åÿ∫ÿßŸÖ:">${item.contactMessage || ''}</td>
        <td data-label="Ÿæÿ™€Å:">${item.contactAddress || ''}</td>
        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
            <button class="edit-btn" onclick="editEntry('contacts', ${item.id}, 'contactForm')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
            <button class="delete-btn" onclick="deleteEntry('contacts', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
        </td>
    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('contactSearch').value.toLowerCase();
                    return data.filter(item =>
                        (item.contactName.toLowerCase().includes(search) || (item.contactPhone || '').toLowerCase().includes(search) || (item.contactEmail || '').toLowerCase().includes(search) || (item.contactRelationship || '').toLowerCase().includes(search) || (item.contactAddress || '').toLowerCase().includes(search))
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('contactSortBy').value;
                    if (sortBy === 'name') return a.contactName.localeCompare(b.contactName);
                    if (sortBy === 'nameDesc') return b.contactName.localeCompare(a.contactName);
                    return 0;
                }
            },
            performance: {
                tableId: 'performanceTable',
                formId: 'performanceForm',
                fileInputId: 'performanceFiles',
                filePreviewId: 'performanceFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.performanceDate}</td>
                        <td data-label="ÿπŸÜŸàÿßŸÜ:">${item.performanceTitle}</td>
                        <td data-label="ŸÖÿØÿ™:">${item.performancePeriod}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.performanceDetails || ''}</td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('performance', ${item.id}, 'performanceForm', 'performanceFiles', 'performanceFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('performance', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('performanceSearch').value.toLowerCase();
                    const filterDate = document.getElementById('performanceFilterDate').value;
                    return data.filter(item =>
                        (item.performanceTitle.toLowerCase().includes(search) || (item.performanceDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.performanceDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('performanceSortBy').value;
                    if (sortBy === 'date') return new Date(a.performanceDate) - new Date(b.performanceDate);
                    if (sortBy === 'dateDesc') return new Date(b.performanceDate) - new Date(a.performanceDate);
                    if (sortBy === 'period') {
                        const periodOrder = { 'ŸÖÿß€ÅÿßŸÜ€Å': 1, 'ÿ≥€Å ŸÖÿß€Å€å': 2, 'ÿ≥ÿßŸÑÿßŸÜ€Å': 3, 'ÿØ€å⁄Øÿ±': 4 };
                        return periodOrder[a.performancePeriod] - periodOrder[b.performancePeriod];
                    }
                    return 0;
                }
            },
            schedules: {
                tableId: 'schedulesTable',
                formId: 'scheduleForm',
                render: (item) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.scheduleDate}</td>
                        <td data-label="ŸàŸÇÿ™:">${item.scheduleTime}</td>
                        <td data-label="Ÿæÿ±Ÿà⁄Øÿ±ÿßŸÖ ⁄©ÿß ŸÜÿßŸÖ:">${item.scheduleName}</td>
                        <td data-label="ŸÜŸàÿπ€åÿ™:">${item.scheduleType || ''}</td>
                        <td data-label="ÿ¨⁄Ø€Å:">${item.scheduleLocation || ''}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.scheduleDetails || ''}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('schedules', ${item.id}, 'scheduleForm')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('schedules', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('scheduleSearch').value.toLowerCase();
                    const filterDate = document.getElementById('scheduleFilterDate').value;
                    return data.filter(item =>
                        (item.scheduleName.toLowerCase().includes(search) || (item.scheduleType || '').toLowerCase().includes(search) || (item.scheduleLocation || '').toLowerCase().includes(search) || (item.scheduleDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.scheduleDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('scheduleSortBy').value;
                    if (sortBy === 'dateTime') return new Date(`${a.scheduleDate}T${a.scheduleTime}`) - new Date(`${b.scheduleDate}T${b.scheduleTime}`);
                    if (sortBy === 'dateTimeDesc') return new Date(`${b.scheduleDate}T${b.scheduleTime}`) - new Date(`${a.scheduleDate}T${a.scheduleTime}`);
                    if (sortBy === 'type') return a.scheduleType.localeCompare(b.scheduleType);
                    return 0;
                }
            },
            messages: {
                tableId: 'messagesTable',
                formId: 'messageForm',
                fileInputId: 'messageFiles',
                filePreviewId: 'messageFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.messageDate}</td>
                        <td data-label="ŸÜŸàÿπ€åÿ™:">${item.messageType}</td>
                        <td data-label="ÿ®⁄æ€åÿ¨ŸÜ€í ŸàÿßŸÑÿß/ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å:">${item.messageSenderReceiver}</td>
                        <td data-label="ŸÖÿ∂ŸÖŸàŸÜ:">${item.messageSubject || ''}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.messageDetails || ''}</td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('messages', ${item.id}, 'messageForm', 'messageFiles', 'messageFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('messages', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('messageSearch').value.toLowerCase();
                    const filterDate = document.getElementById('messageFilterDate').value;
                    return data.filter(item =>
                        (item.messageSenderReceiver.toLowerCase().includes(search) || (item.messageSubject || '').toLowerCase().includes(search) || (item.messageDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.messageDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('messageSortBy').value;
                    if (sortBy === 'date') return new Date(a.messageDate) - new Date(b.messageDate);
                    if (sortBy === 'dateDesc') return new Date(b.messageDate) - new Date(a.messageDate);
                    if (sortBy === 'type') return a.messageType.localeCompare(b.messageType);
                    return 0;
                }
            },
            letters: {
                tableId: 'lettersTable',
                formId: 'letterForm',
                fileInputId: 'letterFiles',
                filePreviewId: 'letterFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß:">${item.letterDate}</td>
                        <td data-label="ŸàÿµŸàŸÑ ⁄©ŸÜŸÜÿØ€Å:">${item.letterRecipient}</td>
                        <td data-label="ŸÖÿ∂ŸÖŸàŸÜ:">${item.letterSubject || ''}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.letterDetails || ''}</td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('letters', ${item.id}, 'letterForm', 'letterFiles', 'letterFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('letters', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('letterSearch').value.toLowerCase();
                    const filterDate = document.getElementById('letterFilterDate').value;
                    return data.filter(item =>
                        (item.letterRecipient.toLowerCase().includes(search) || (item.letterSubject || '').toLowerCase().includes(search) || (item.letterDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.letterDate === filterDate)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('letterSortBy').value;
                    if (sortBy === 'date') return new Date(a.letterDate) - new Date(b.letterDate);
                    if (sortBy === 'dateDesc') return new Date(b.letterDate) - new Date(a.letterDate);
                    return 0;
                }
            },
            demands: {
                tableId: 'demandsTable',
                formId: 'demandForm',
                fileInputId: 'demandFiles',
                filePreviewId: 'demandFilesPreview',
                render: (item) => {
                    const tr = document.createElement('tr');
                    const filesHtml = item.files && item.files.length > 0 ?
                        item.files.map((file, idx) => `<a href="${file.data}" download="${file.name}" target="_blank">${file.name}</a>`).join('<br/>') : '';
                    tr.innerHTML = `
                        <td data-label="ÿ™ÿßÿ±€åÿÆ:">${item.demandDate}</td>
                        <td data-label="ÿπŸÜŸàÿßŸÜ:">${item.demandSubject}</td>
                        <td data-label="ŸÖÿ∑ÿßŸÑÿ®€Å ⁄©ÿ±ŸÜ€í ŸàÿßŸÑÿß:">${item.demandRequester}</td>
                        <td data-label="ÿ™ŸÅÿµ€åŸÑ:">${item.demandDetails || ''}</td>
                        <td data-label="ÿ≠ÿßŸÑÿ™:"><span class="status-badge ${item.demandStatus === 'ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å' ? 'complete' : item.demandStatus === 'ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å' ? 'rejected' : 'pending'}">${item.demandStatus}</span></td>
                        <td data-label="ŸÅÿßÿ¶ŸÑ€å⁄∫:">${filesHtml}</td>
                        <td data-label="ÿ¢Ÿæÿ¥ŸÜÿ≤:">
                            <button class="edit-btn" onclick="editEntry('demands', ${item.id}, 'demandForm', 'demandFiles', 'demandFilesPreview')"><i class="fas fa-edit"></i> ÿ™ÿ±ŸÖ€åŸÖ ⁄©ÿ±€å⁄∫</button>
                            <button class="delete-btn" onclick="deleteEntry('demands', ${item.id})"><i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ ⁄©ÿ±€å⁄∫</button>
                        </td>
                    `;
                    return tr;
                },
                filter: (data) => {
                    const search = document.getElementById('demandSearch').value.toLowerCase();
                    const filterDate = document.getElementById('demandFilterDate').value;
                    const statusFilter = document.getElementById('demandSortBy').value === 'status' ? document.getElementById('demandStatus').value : null;
                    return data.filter(item =>
                        (item.demandSubject.toLowerCase().includes(search) || item.demandRequester.toLowerCase().includes(search) || (item.demandDetails || '').toLowerCase().includes(search)) &&
                        (!filterDate || item.demandDate === filterDate) &&
                        (!statusFilter || item.demandStatus === statusFilter)
                    );
                },
                sort: (a, b) => {
                    const sortBy = document.getElementById('demandSortBy').value;
                    if (sortBy === 'date') return new Date(a.demandDate) - new Date(b.demandDate);
                    if (sortBy === 'dateDesc') return new Date(b.demandDate) - new Date(a.demandDate);
                    if (sortBy === 'status') {
                        const statusOrder = { 'ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß': 1, 'ŸÖ⁄©ŸÖŸÑ': 2, 'ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å': 3, 'ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å': 4 };
                        return statusOrder[a.demandStatus] - statusOrder[b.demandStatus];
                    }
                    return 0;
                }
            }
        };
        const loadModuleData = async (moduleName) => {
            const module = modules[moduleName];
            if (module) {
                await loadDataIntoTable(moduleName, module.tableId, module.render, module.filter, module.sort);
            }
        };
        document.getElementById('taskForm').addEventListener('submit', (e) => handleFormSubmit(e, 'tasks', 'taskForm', clearForms, 'taskFiles', 'taskFilesPreview'));
        document.getElementById('clearTaskForm').addEventListener('click', clearForms);
        document.getElementById('taskFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.taskForm = base64Files;
                    displayFilePreviews(base64Files, 'taskFilesPreview');
                });
            } else {
                document.getElementById('taskFilesPreview').innerHTML = '';
                window.currentEditFiles.taskForm = [];
            }
        });
        document.getElementById('reminderForm').addEventListener('submit', (e) => handleFormSubmit(e, 'reminders', 'reminderForm', clearForms));
        document.getElementById('clearReminderForm').addEventListener('click', clearForms);
        document.getElementById('urgentTaskForm').addEventListener('submit', (e) => handleFormSubmit(e, 'urgentTasks', 'urgentTaskForm', clearForms));
        document.getElementById('clearUrgentTaskForm').addEventListener('click', clearForms);
        document.getElementById('meetingForm').addEventListener('submit', (e) => handleFormSubmit(e, 'meetings', 'meetingForm', clearForms));
        document.getElementById('clearMeetingForm').addEventListener('click', clearForms);
        document.getElementById('notificationForm').addEventListener('submit', (e) => handleFormSubmit(e, 'notifications', 'notificationForm', clearForms, 'notificationFiles', 'notificationFilesPreview'));
        document.getElementById('clearNotificationForm').addEventListener('click', clearForms);
        document.getElementById('notificationFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.notificationForm = base64Files;
                    displayFilePreviews(base64Files, 'notificationFilesPreview');
                });
            } else {
                document.getElementById('notificationFilesPreview').innerHTML = '';
                window.currentEditFiles.notificationForm = [];
            }
        });
        document.getElementById('contactForm').addEventListener('submit', (e) => handleFormSubmit(e, 'contacts', 'contactForm', clearForms));
        document.getElementById('clearContactForm').addEventListener('click', clearForms);
        document.getElementById('performanceForm').addEventListener('submit', (e) => handleFormSubmit(e, 'performance', 'performanceForm', clearForms, 'performanceFiles', 'performanceFilesPreview'));
        document.getElementById('clearPerformanceForm').addEventListener('click', clearForms);
        document.getElementById('performanceFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.performanceForm = base64Files;
                    displayFilePreviews(base64Files, 'performanceFilesPreview');
                });
            } else {
                document.getElementById('performanceFilesPreview').innerHTML = '';
                window.currentEditFiles.performanceForm = [];
            }
        });
        document.getElementById('scheduleForm').addEventListener('submit', (e) => handleFormSubmit(e, 'schedules', 'scheduleForm', clearForms));
        document.getElementById('clearScheduleForm').addEventListener('click', clearForms);
        document.getElementById('messageForm').addEventListener('submit', (e) => handleFormSubmit(e, 'messages', 'messageForm', clearForms, 'messageFiles', 'messageFilesPreview'));
        document.getElementById('clearMessageForm').addEventListener('click', clearForms);
        document.getElementById('messageFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.messageForm = base64Files;
                    displayFilePreviews(base64Files, 'messageFilesPreview');
                });
            } else {
                document.getElementById('messageFilesPreview').innerHTML = '';
                window.currentEditFiles.messageForm = [];
            }
        });
        document.getElementById('letterForm').addEventListener('submit', (e) => handleFormSubmit(e, 'letters', 'letterForm', clearForms, 'letterFiles', 'letterFilesPreview'));
        document.getElementById('clearLetterForm').addEventListener('click', clearForms);
        document.getElementById('letterFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.letterForm = base64Files;
                    displayFilePreviews(base64Files, 'letterFilesPreview');
                });
            } else {
                document.getElementById('letterFilesPreview').innerHTML = '';
                window.currentEditFiles.letterForm = [];
            }
        });
        document.getElementById('demandForm').addEventListener('submit', (e) => handleFormSubmit(e, 'demands', 'demandForm', clearForms, 'demandFiles', 'demandFilesPreview'));
        document.getElementById('clearDemandForm').addEventListener('click', clearForms);
        document.getElementById('demandFiles').addEventListener('change', function () {
            if (this.files.length > 0) {
                filesToBase64(this.files).then(base64Files => {
                    window.currentEditFiles.demandForm = base64Files;
                    displayFilePreviews(base64Files, 'demandFilesPreview');
                });
            } else {
                document.getElementById('demandFilesPreview').innerHTML = '';
                window.currentEditFiles.demandForm = [];
            }
        });
        window.exportTable = async (tableId, format) => {
            const table = document.getElementById(tableId);
            if (!table) {
                showNotification('Ÿπ€åÿ®ŸÑ ŸÜ€Å€å⁄∫ ŸÖŸÑÿß!', 'error');
                return;
            }
            const headers = Array.from(table.querySelectorAll('thead th:not(:last-child)')).map(th => th.textContent.trim());
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const data = rows.map(row => {
                const cells = Array.from(row.querySelectorAll('td:not(:last-child)'));
                return cells.map(cell => {
                    const links = cell.querySelectorAll('a');
                    if (links.length > 0) {
                        return Array.from(links).map(link => link.textContent.trim()).join(', ');
                    }
                    const badge = cell.querySelector('.status-badge');
                    if (badge) {
                        return badge.textContent.trim();
                    }
                    return cell.textContent.trim();
                });
            }).filter(row => row.length > 0);
            if (data.length === 0) {
                showNotification('ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ ⁄©ÿ±ŸÜ€í ⁄©€í ŸÑ€å€í ⁄©Ÿàÿ¶€å ⁄à€åŸπÿß ŸÜ€Å€å⁄∫!', 'info');
                return;
            }
            if (format === 'excel') {
                const ws_data = [headers, ...data];
                const ws = XLSX.utils.aoa_to_sheet(ws_data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                XLSX.writeFile(wb, `${tableId}.xlsx`);
                showNotification('ÿß€å⁄©ÿ≥ŸÑ ŸÅÿßÿ¶ŸÑ ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ ⁄©ÿ± ÿØ€å ⁄Øÿ¶€å!', 'success');
            } else if (format === 'image') {
                showNotification('ÿ™ÿµŸà€åÿ± ÿ™€åÿßÿ± ⁄©€å ÿ¨ÿß ÿ±€Å€å €Å€í...', 'info');
                const moduleSection = table.closest('.module-section');
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = moduleSection.offsetWidth + 'px';
                tempDiv.style.padding = '20px';
                tempDiv.style.backgroundColor = 'white';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.textAlign = 'right';
                tempDiv.style.fontFamily = 'Calibri, "Noto Nastaliq Urdu", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
                tempDiv.innerHTML = `
                    <h2 style="text-align: center; color: black; border-bottom: 1px solid #ccc; padding-bottom: 10px;">${moduleSection.querySelector('h2').textContent}</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background-color: #f2f2f2; font-weight: bold; color: black;">
                                ${headers.map(h => `<th style="border: 1px solid #ccc; padding: 8px; text-align: right; background-color: #f2f2f2;">${h}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(row => `
                                <tr>
                                    ${row.map(cell => `<td style="border: 1px solid #ccc; padding: 8px; text-align: right;">${cell}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                document.body.appendChild(tempDiv);
                html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: null
                }).then(canvas => {
                    const image = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = image;
                    link.download = `${tableId}.png`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    document.body.removeChild(tempDiv);
                    showNotification('ÿ™ÿµŸà€åÿ± ⁄©ÿßŸÖ€åÿßÿ®€å ÿ≥€í ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ ⁄©ÿ± ÿØ€å ⁄Øÿ¶€å!', 'success');
                }).catch(error => {
                    console.error('Error exporting image:', error);
                    showNotification('ÿ™ÿµŸà€åÿ± ÿß€å⁄©ÿ≥ŸæŸàÿ±Ÿπ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ÿÆÿ±ÿßÿ®€å', 'error');
                    document.body.removeChild(tempDiv);
                });
            }
        };
        window.printTable = (tableId) => {
            const printContent = document.getElementById(tableId).closest('.module-section').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
            <!DOCTYPE html>
            <html dir="rtl" lang="ur">
            <head>
                <meta charset="utf-8">
                <title>Ÿæÿ±ŸÜŸπ ${document.getElementById(tableId).closest('.module-section').querySelector('h2').textContent}</title>
                <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&display=swap">
                <style>
                    body {
                        font-family: Calibri, 'Noto Nastaliq Urdu', Arial, sans-serif;
                        direction: rtl;
                        text-align: right;
                        margin: 20px;
                        font-size: 11pt;
                        line-height: 1.6;
                        color: #333;
                    }
                    h2 {
                        text-align: center;
                        font-size: 20pt;
                        margin-bottom: 20px;
                        color: #007bff;
                        border-bottom: 2px solid #eee;
                        padding-bottom: 10px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 20px;
                    }
                    th, td {
                        border: 1px solid #ccc;
                        padding: 8px;
                        text-align: right;
                        vertical-align: top;
                    }
                    th {
                        background-color: #f2f2f2;
                        font-weight: bold;
                        color: #007bff;
                    }
                    a {
                        color: #007bff;
                        text-decoration: none;
                    }
                    .status-badge {
                        display: inline-block;
                        padding: 3px 8px;
                        border-radius: 10px;
                        font-size: 0.85em;
                        font-weight: bold;
                        color: white;
                        text-align: center;
                        white-space: nowrap;
                    }
                    .status-badge.complete, .status-badge.ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿØ€Å { background-color: #28a745; }
                    .status-badge.pending, .status-badge.ÿ≤€åÿ± ÿßŸÑÿ™Ÿàÿß { background-color: #ffc107; color: #333; }
                    .status-badge.urgent { background-color: #dc3545; }
                    .status-badge.info { background-color: #17a2b8; }
                    .status-badge.rejected, .status-badge.ŸÖÿ≥ÿ™ÿ±ÿØ ÿ¥ÿØ€Å { background-color: #dc3545; }
                    @page {
                        size: A4 landscape;
                        margin: 1.5cm;
                    }
                </style>
            </head>
            <body>
                ${printContent}
                <script>
                    window.onload = function() {
                        window.print();
                        window.onafterprint = function() {
                            window.close();
                        };
                    };
                <\/script>
            </body>
            </html>
        `);
            printWindow.document.close();
        };
        document.getElementById('requestNotificationPermission').addEventListener('click', () => {
            if (!('Notification' in window)) {
                showNotification('€å€Å ÿ®ÿ±ÿßÿ§ÿ≤ÿ± ŸÜŸàŸπ€åŸÅ€å⁄©€åÿ¥ŸÜ ⁄©Ÿà ÿ≥ŸæŸàÿ±Ÿπ ŸÜ€Å€å⁄∫ ⁄©ÿ±ÿ™ÿß€î', 'error');
                return;
            }
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    showNotification('ŸÜŸàŸπ€åŸÅ€å⁄©€åÿ¥ŸÜ ⁄©€å ÿßÿ¨ÿßÿ≤ÿ™ ÿØ€í ÿØ€å ⁄Øÿ¶€å!', 'success');
                    new Notification('ÿØŸÅÿ™ÿ± ŸÖŸÜÿ∏ŸÖ', {
                        body: 'ŸÜŸàŸπ€åŸÅ€å⁄©€åÿ¥ŸÜ ⁄©ÿßŸÖ€åÿßÿ®€å ÿ≥€í ⁄©ÿßŸÖ ⁄©ÿ± ÿ±€Åÿß €Å€í!',
                        icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¢</text></svg>'
                    });
                } else {
                    showNotification('ŸÜŸàŸπ€åŸÅ€å⁄©€åÿ¥ŸÜ ⁄©€å ÿßÿ¨ÿßÿ≤ÿ™ ŸÜ€Å€å⁄∫ ÿØ€å ⁄Øÿ¶€å!', 'error');
                }
            });
        });
        async function checkRemindersAndNotify() {
            if (!('Notification' in window) || Notification.permission !== 'granted') return;
            const reminders = await getAllData('reminders');
            const now = new Date();
            const todayDate = now.toISOString().split('T')[0];
            const currentTime = now.toTimeString().split(' ')[0].substring(0, 5);
            reminders.forEach(reminder => {
                if (reminder.reminderDate === todayDate) {
                    if (reminder.reminderType === 'ÿßŸÑÿßÿ±ŸÖ' && reminder.reminderTime && reminder.reminderTime === currentTime) {
                        new Notification(`€åÿßÿØ ÿØ€ÅÿßŸÜ€å: ${reminder.reminderTitle}`, {
                            body: reminder.reminderDetails,
                            icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚è∞</text></svg>'
                        });
                        showNotification(`€åÿßÿØ ÿØ€ÅÿßŸÜ€å: ${reminder.reminderTitle}`, 'urgent');
                    } else if (reminder.reminderType === 'ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±' && !reminder.reminderTime) {
                        new Notification(`€åÿßÿØ ÿØ€ÅÿßŸÜ€å (ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±): ${reminder.reminderTitle}`, {
                            body: reminder.reminderDetails,
                            icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìÖ</text></svg>'
                        });
                        showNotification(`€åÿßÿØ ÿØ€ÅÿßŸÜ€å (ÿ™ÿßÿ±€åÿÆ Ÿàÿßÿ±): ${reminder.reminderTitle}`, 'info');
                    }
                }
            });
        }
        setInterval(checkRemindersAndNotify, 60000);
        openDB().then(async () => {
            const tasks = await getAllData('tasks');
            if (tasks.length === 0) {
                await addSampleData();
            } else {
                loadAllTables();
            }
        });
        window.editEntry = editEntry;
        window.deleteEntry = deleteEntry;
        window.filterAndSort = filterAndSort;
        window.backupData = backupData;
        window.restoreData = restoreData;
        window.displayFilePreviews = displayFilePreviews;
        window.removeFileFromFormPreview = removeFileFromFormPreview;
        window.showNotification = showNotification;
    </script>

    <script>
        document.querySelectorAll('*').forEach(element => {
            const currentSize = window.getComputedStyle(element).fontSize;
            const currentSizeNum = parseFloat(currentSize);
            element.style.fontSize = `${currentSizeNum + 1}px`;
        });
    </script>
    <script type="module">
        import { Workbox } from 'https://storage.googleapis.com/workbox-cdn/releases/7.0.0/workbox-window.prod.mjs';

        const swUrl = './sw.js';
        const wb = new Workbox(swUrl);

        // This event fires when a new service worker has installed but is waiting to activate.
        wb.addEventListener('waiting', (event) => {
            console.log('A new service worker is waiting to activate.');
            // This sends a message to the waiting service worker, telling it to activate.
            wb.messageSW({ type: 'SKIP_WAITING' });
        });

        // This event fires when the new service worker has taken control.
        wb.addEventListener('controlling', (event) => {
            console.log('The new service worker is now in control. Reloading page for updates...');
            window.location.reload();
        });

        // Register the service worker.
        wb.register();
    </script>
</body>

</html>